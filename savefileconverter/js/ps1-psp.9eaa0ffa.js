"use strict";(self["webpackChunksave_file_converter"]=self["webpackChunksave_file_converter"]||[]).push([[765],{1316:function(e,a,t){t.r(a),t.d(a,{default:function(){return L}});var r=function(){var e=this,a=e._self._c;return a("div",{staticClass:"home"},[a("ConvertPs1Psp")],1)},i=[],s=function(){var e=this,a=e._self._c;return a("div",[a("b-container",[a("b-row",{attrs:{"no-gutters":"","align-h":"center","align-v":"start"}},[a("b-col",{attrs:{sm:"12",md:"5","align-self":"start"}},[a("b-row",{attrs:{"no-gutters":"","align-h":"center","align-v":"start"}},[a("b-col",{attrs:{cols:"12"}},[a("b-jumbotron",{attrs:{fluid:"","header-level":e._f("mq")(e.$mq,{xs:5,sm:5,md:5,lg:5,xl:4})},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("PSP")]},proxy:!0}])})],1)],1),"convertToRaw"===this.conversionDirection?a("div",[a("input-file",{attrs:{errorMessage:this.errorMessage,placeholderText:"Choose a file to convert (*.vmp)",acceptExtension:".vmp",leaveRoomForHelpIcon:!1},on:{load:function(a){return e.readPspSaveData(a)}}}),a("file-list",{attrs:{display:null!==this.pspSaveData,files:this.getFileListNames()},on:{change:function(a){return e.changeSelectedSaveData(a)}},model:{value:e.selectedSaveData,callback:function(a){e.selectedSaveData=a},expression:"selectedSaveData"}})],1):a("div",[a("output-filename",{attrs:{leaveRoomForHelpIcon:!1},model:{value:e.outputFilename,callback:function(a){e.outputFilename=a},expression:"outputFilename"}}),a("memory-card-selector",{on:{change:function(a){return e.changeMemoryCardIndex()}},model:{value:e.memoryCardIndex,callback:function(a){e.memoryCardIndex=a},expression:"memoryCardIndex"}})],1)],1),a("b-col",{attrs:{sm:"12",md:"2",lg:"2",xl:"2","align-self":"start"}},[a("conversion-direction",{attrs:{horizontalLayout:["md","lg","xl"],verticalLayout:["xs","sm"],conversionDirection:this.conversionDirection},on:{change:function(a){return e.changeConversionDirection(a)}}})],1),a("b-col",{attrs:{sm:"12",md:"5","align-self":"start"}},[a("b-row",{attrs:{"no-gutters":"","align-h":"center","align-v":"start"}},[a("b-col",{attrs:{cols:"12"}},[a("b-jumbotron",{class:"md"===e.$mq&&"individual-saves"===this.individualSavesOrMemoryCard?"fix-jumbotron":"",attrs:{fluid:"","header-level":e._f("mq")(e.$mq,{xs:5,sm:5,md:5,lg:5,xl:4})},scopedSlots:e._u([{key:"header",fn:function(){return[e._v(e._s(e.individualSavesOrMemoryCardText))]},proxy:!0}])})],1)],1),"convertToRaw"===this.conversionDirection?a("div",["individual-saves"===this.individualSavesOrMemoryCard?a("div",[a("output-filename",{attrs:{leaveRoomForHelpIcon:!0,disabled:!0,helpText:"The filename for an individual save contains important information that the game needs to find this save data. Please do not modify it after downloading the save."},model:{value:e.outputFilename,callback:function(a){e.outputFilename=a},expression:"outputFilename"}})],1):a("div",[a("output-filename",{attrs:{leaveRoomForHelpIcon:!1},model:{value:e.outputFilename,callback:function(a){e.outputFilename=a},expression:"outputFilename"}})],1),a("individual-saves-or-memory-card-selector",{attrs:{value:this.individualSavesOrMemoryCard,individualSavesText:this.individualSavesText,memoryCardText:this.memoryCardText},on:{change:function(a){return e.changeIndividualSavesOrMemoryCard(a)}}})],1):a("div",["individual-saves"===this.individualSavesOrMemoryCard?a("div",[a("input-file",{ref:"inputFileEmulator",attrs:{errorMessage:this.errorMessage,placeholderText:"Choose files to add",leaveRoomForHelpIcon:!1,allowMultipleFiles:!0},on:{load:function(a){return e.readEmulatorSaveData(a)}}})],1):a("div",[a("input-file",{ref:"inputFileEmulatorMemcard",attrs:{errorMessage:this.errorMessage,placeholderText:"Choose a file to convert (*.mcr)",acceptExtension:".mcr",leaveRoomForHelpIcon:!1},on:{load:function(a){return e.readEmulatorMemcardSaveData(a)}}})],1),a("individual-saves-or-memory-card-selector",{attrs:{value:this.individualSavesOrMemoryCard,individualSavesText:this.individualSavesText,memoryCardText:this.memoryCardText},on:{change:function(a){return e.changeIndividualSavesOrMemoryCard(a)}}}),a("file-list",{attrs:{display:null!==this.pspSaveData,files:this.getFileListNames(),enabled:!1}})],1)],1)],1),a("b-row",{staticClass:"justify-content-md-center",attrs:{"align-h":"center"}},[a("b-col",{attrs:{cols:"auto",sm:"4",md:"3",lg:"2","align-self":"center"}},[a("b-button",{staticClass:"ps1-psp-convert-button",attrs:{variant:"success",block:"",disabled:this.convertButtonDisabled},on:{click:function(a){return e.convertFile()}}},[e._v(" Convert! ")])],1)],1),a("b-row",[a("b-col",[a("div",{staticClass:"help"},[e._v(" Help: how do IÂ "),a("b-link",{attrs:{href:"https://www.wikihow.com/Put-Game-Saves-on-Your-PSP"}},[e._v("copy PS1 saves to and from my PSP")]),e._v("? ")],1),a("div",{staticClass:"help"},[e._v(" Help: how can I "),a("router-link",{attrs:{to:"/original-hardware?sort=ps1"}},[e._v("copy save files to and from a PS1 memory card")]),e._v("? ")],1)])],1)],1)],1)},n=[],o=t(3162),l=t(3313),u=t(1044),c=t(2405),d=t(5482),v=t(1302),m=t(2074),h=function(){var e=this,a=e._self._c;return a("b-form-group",{scopedSlots:e._u([{key:"default",fn:function({ariaDescribedby:t}){return[a("b-form-radio-group",{staticClass:"radio-buttons",attrs:{options:e.options,"aria-describedby":t,buttons:"","button-variant":"outline-info"},model:{value:e.valueLocal,callback:function(a){e.valueLocal=a},expression:"valueLocal"}})]}}])})},p=[],f={name:"MemoryCardSelector",props:{value:{type:Number,default:null}},model:{prop:"value",event:"change"},computed:{valueLocal:{get(){return this.value},set(e){this.$emit("change",e)}}},data(){return{options:[{value:0,text:"Memory card 1"},{value:1,text:"Memory card 2"}]}}},S=f,y=t(1001),g=(0,y.Z)(S,h,p,!1,null,"92858c84",null),D=g.exports,F=(t(3408),t(4590),t(3462),t(3767),t(8585),t(8696),t(5847)),C=t(8804),M=t(8764)["Buffer"];const x=128,b=[0,80,77,86,x,0,0,0,0,0,0,0],w=12,T=20,I=32,_=20;class P{static createFromPspData(e){return new P(e)}static createFromMemoryCardData(e){const a=new ArrayBuffer(x),t=new Uint8Array(a),r=F.Z.createFromPs1MemcardData(e);t.set(b,0);const i=new Uint8Array(C.Z.SALT_SEED_INIT);t.set(i,w);const s=l.Z.concatArrayBuffers([a,r.getArrayBuffer()]),n=l.Z.bufferToArrayBuffer(C.Z.SALT_SEED_INIT),o=C.Z.calculateSignature(s,n,T,I,_),u=l.Z.setArrayBufferPortion(s,o,I,0,_);return P.createFromPspData(u)}static createFromSaveFiles(e){const a=F.Z.createFromSaveFiles(e);return P.createFromMemoryCardData(a.getArrayBuffer())}constructor(e){this.arrayBuffer=e;const a=e.slice(0,x);l.Z.checkMagicBytes(a,0,b);const t=a.slice(w,w+T),r=C.Z.calculateSignature(e,t,T,I,_),i=M.from(a.slice(I,I+_));if(0!==i.compare(r))throw new Error(`Save appears to be corrupted: expected signature ${i.toString("hex")} but calculated signature ${r.toString("hex")}`);const s=e.slice(x);this.memoryCard=F.Z.createFromPs1MemcardData(s),this.saveFiles=this.memoryCard.getSaveFiles()}getSaveFiles(){return this.saveFiles}getMemoryCard(){return this.memoryCard}getArrayBuffer(){return this.arrayBuffer}}var O={name:"ConvertPs1Psp",data(){return{pspSaveData:null,errorMessage:null,inputFilename:null,outputFilename:null,conversionDirection:"convertToRaw",selectedSaveData:null,memoryCardIndex:0,individualSavesOrMemoryCard:"memory-card",individualSavesText:"Individual saves",memoryCardText:"Raw/emulator"}},components:{ConversionDirection:d.Z,InputFile:u.Z,OutputFilename:c.Z,FileList:v.Z,MemoryCardSelector:D,IndividualSavesOrMemoryCardSelector:m.Z},computed:{convertButtonDisabled(){const e="convertToRaw"===this.conversionDirection||null===this.selectedSaveData;return!this.pspSaveData||0===this.pspSaveData.getSaveFiles().length||!e||!this.outputFilename},individualSavesOrMemoryCardText(){return"individual-saves"===this.individualSavesOrMemoryCard?this.individualSavesText:this.memoryCardText}},methods:{changeIndividualSavesOrMemoryCard(e){this.individualSavesOrMemoryCard!==e&&(this.individualSavesOrMemoryCard=e,"convertToFormat"===this.conversionDirection?(this.changeMemoryCardIndex(),this.selectedSaveData=null,this.pspSaveData=null,this.$refs.inputFileEmulator&&this.$refs.inputFileEmulator.reset(),this.$refs.inputFileEmulatorMemcard&&this.$refs.inputFileEmulatorMemcard.reset()):"individual-saves"===e?null===this.selectedSaveData&&this.changeSelectedSaveData(0):(null!==this.inputFilename&&(this.outputFilename=l.Z.changeFilenameExtension(this.inputFilename,"mcr")),this.selectedSaveData=null))},getFileListNames(){return null!==this.pspSaveData&&null!==this.pspSaveData.getSaveFiles()?this.pspSaveData.getSaveFiles().map((e=>({displayText:`${e.description} (${e.regionName})`}))):null},changeConversionDirection(e){this.conversionDirection=e,this.pspSaveData=null,this.errorMessage=null,this.inputFilename=null,this.outputFilename=null,this.selectedSaveData=null,this.memoryCardIndex=0,this.individualSavesOrMemoryCard="memory-card","convertToFormat"===e&&this.changeMemoryCardIndex()},changeMemoryCardIndex(){this.outputFilename=`SCEVMC${this.memoryCardIndex}.VMP`},changeSelectedSaveData(e){null!==e&&(null!==this.pspSaveData&&this.pspSaveData.getSaveFiles().length>0?(this.selectedSaveData=e,this.outputFilename=this.pspSaveData.getSaveFiles()[this.selectedSaveData].filename,this.changeIndividualSavesOrMemoryCard("individual-saves")):(this.selectedSaveData=null,this.outputFilename=null))},readPspSaveData(e){this.errorMessage=null,this.selectedSaveData=null,this.inputFilename=e.filename;try{this.pspSaveData=P.createFromPspData(e.arrayBuffer),this.individualSavesOrMemoryCard=null,this.changeIndividualSavesOrMemoryCard("memory-card")}catch(a){this.errorMessage="File appears to not be in the correct format",this.pspSaveData=null,this.selectedSaveData=null}},readEmulatorSaveData(e){this.errorMessage=null,this.selectedSaveData=null,this.inputFilename=null;try{const a=e.map((e=>({filename:e.filename,rawData:e.arrayBuffer})));this.pspSaveData=P.createFromSaveFiles(a)}catch(a){this.errorMessage=a.message,this.pspSaveData=null,this.selectedSaveData=null}},readEmulatorMemcardSaveData(e){this.errorMessage=null,this.selectedSaveData=null,this.inputFilename=e.filename;try{this.pspSaveData=P.createFromMemoryCardData(e.arrayBuffer),this.changeIndividualSavesOrMemoryCard("memory-card")}catch(a){this.errorMessage="File appears to not be in the correct format",this.pspSaveData=null,this.selectedSaveData=null}},convertFile(){let e=null;e="convertToRaw"===this.conversionDirection?"individual-saves"===this.individualSavesOrMemoryCard?this.pspSaveData.getSaveFiles()[this.selectedSaveData].rawData:this.pspSaveData.getMemoryCard().getArrayBuffer():this.pspSaveData.getArrayBuffer();const a=new Blob([e],{type:"application/octet-stream"});(0,o.saveAs)(a,this.outputFilename)}}},Z=O,k=(0,y.Z)(Z,s,n,!1,null,"25259a6e",null),B=k.exports,E={name:"Ps1PspView",components:{ConvertPs1Psp:B}},A=E,$=(0,y.Z)(A,r,i,!1,null,null,null),L=$.exports}}]);