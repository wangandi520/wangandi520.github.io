"use strict";(self["webpackChunksave_file_converter"]=self["webpackChunksave_file_converter"]||[]).push([[537],{2074:function(e,t,a){a.d(t,{Z:function(){return v}});var i=function(){var e=this,t=e._self._c;return t("b-form-group",{scopedSlots:e._u([{key:"default",fn:function({ariaDescribedby:a}){return[t("b-form-radio-group",{staticClass:"radio-buttons",attrs:{options:e.options,"aria-describedby":a,buttons:"","button-variant":"outline-info"},model:{value:e.valueLocal,callback:function(t){e.valueLocal=t},expression:"valueLocal"}})]}}])})},r=[],n={name:"IndividualSavesOrMemoryCardSelector",props:{value:{type:String,default:null},individualSavesText:{type:String,default:"Individual saves"},memoryCardText:{type:String,default:"Memory card"}},model:{prop:"value",event:"change"},computed:{valueLocal:{get(){return this.value},set(e){this.$emit("change",e)}}},data(){return{options:[{value:"individual-saves",text:this.individualSavesText},{value:"memory-card",text:this.memoryCardText}]}}},l=n,s=a(1001),o=(0,s.Z)(l,i,r,!1,null,"725c0d84",null),v=o.exports},775:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("ConvertN64DexDrive")],1)},r=[],n=function(){var e=this,t=e._self._c;return t("div",[t("b-container",[t("b-row",{attrs:{"no-gutters":"","align-h":"center","align-v":"start"}},[t("b-col",{attrs:{sm:"12",md:"5","align-self":"start"}},[t("b-row",{attrs:{"no-gutters":"","align-h":"center","align-v":"start"}},[t("b-col",{attrs:{cols:"12"}},[t("b-jumbotron",{attrs:{fluid:"","header-level":e._f("mq")(e.$mq,{xs:5,sm:5,md:5,lg:5,xl:4})},scopedSlots:e._u([{key:"header",fn:function(){return[e._v("DexDrive")]},proxy:!0}])})],1)],1),"convertToRaw"===this.conversionDirection?t("div",[t("input-file",{attrs:{errorMessage:this.errorMessage,placeholderText:"Choose a file to convert (*.n64)",acceptExtension:".n64",leaveRoomForHelpIcon:!1},on:{load:function(t){return e.readDexDriveSaveData(t)}}}),t("file-list",{attrs:{display:null!==this.dexDriveSaveData,files:this.getFileListNames()},on:{change:function(t){return e.changeSelectedSaveData(t)}},model:{value:e.selectedSaveData,callback:function(t){e.selectedSaveData=t},expression:"selectedSaveData"}})],1):t("div",[t("output-filename",{attrs:{leaveRoomForHelpIcon:!1},model:{value:e.outputFilename,callback:function(t){e.outputFilename=t},expression:"outputFilename"}})],1)],1),t("b-col",{attrs:{sm:"12",md:"2",lg:"2",xl:"2","align-self":"start"}},[t("conversion-direction",{attrs:{horizontalLayout:["md","lg","xl"],verticalLayout:["xs","sm"],conversionDirection:this.conversionDirection},on:{change:function(t){return e.changeConversionDirection(t)}}})],1),t("b-col",{attrs:{sm:"12",md:"5","align-self":"start"}},[t("b-row",{attrs:{"no-gutters":"","align-h":"center","align-v":"start"}},[t("b-col",{attrs:{cols:"12"}},[t("b-jumbotron",{class:"md"===e.$mq?"fix-jumbotron":"",attrs:{fluid:"","header-level":e._f("mq")(e.$mq,{xs:5,sm:5,md:5,lg:5,xl:4})},scopedSlots:e._u([{key:"header",fn:function(){return[e._v(e._s(e.individualSavesOrMemoryCardText))]},proxy:!0}])})],1)],1),"convertToRaw"===this.conversionDirection?t("div",["individual-saves"===this.individualSavesOrMemoryCard?t("div",[this.userAllowedToChangeFilename?t("div",[t("output-filename",{model:{value:e.outputFilename,callback:function(t){e.outputFilename=t},expression:"outputFilename"}})],1):t("div",[t("output-filename",{attrs:{leaveRoomForHelpIcon:!0,disabled:!0,helpText:"The filename for an individual save contains important information that the game needs to find this save data. Please do not modify it after downloading the save."},model:{value:e.outputFilename,callback:function(t){e.outputFilename=t},expression:"outputFilename"}})],1)]):t("div",[t("output-filename",{attrs:{leaveRoomForHelpIcon:!1},model:{value:e.outputFilename,callback:function(t){e.outputFilename=t},expression:"outputFilename"}})],1),t("individual-saves-or-memory-card-selector",{attrs:{value:this.individualSavesOrMemoryCard,individualSavesText:this.individualSavesText,memoryCardText:this.memoryCardText},on:{change:function(t){return e.changeIndividualSavesOrMemoryCard(t)}}})],1):t("div",[t("input-file",{attrs:{errorMessage:this.errorMessage,placeholderText:"Choose files to add",leaveRoomForHelpIcon:!1,allowMultipleFiles:!0},on:{load:function(t){return e.readEmulatorSaveData(t)}}}),t("file-list",{attrs:{display:null!==this.dexDriveSaveData,files:this.getFileListNames(),enabled:!1}})],1)],1)],1),t("b-row",{staticClass:"justify-content-md-center",attrs:{"align-h":"center"}},[t("b-col",{attrs:{cols:"auto",sm:"4",md:"3",lg:"2","align-self":"center"}},[t("b-button",{staticClass:"n64-dexdrive-convert-button",attrs:{variant:"success",block:"",disabled:this.convertButtonDisabled},on:{click:function(t){return e.convertFile()}}},[e._v(" Convert! ")])],1)],1),t("b-row",[t("b-col",[t("div",{staticClass:"help"},[e._v(" Help: how can I "),t("router-link",{attrs:{to:"/original-hardware?sort=n64"}},[e._v("copy save files to and from an N64 cartridge or Controller Pak")]),e._v("? ")],1)])],1)],1)],1)},l=[],s=a(3162),o=a(3313),v=a(1044),u=a(2405),d=a(5482),c=a(1302),m=a(2074),h=(a(7658),a(3408),a(4590),a(3462),a(3767),a(8585),a(8696),a(1945));const D=4160,S="123-456-STD",p="US-ASCII",f="US-ASCII",g=64,x=256;function F(e){return g+e*x}function y(e){const t=[],a=new TextDecoder(f);for(let i=0;i<h.Z.NUM_NOTES;i+=1){const r=F(i),n=e.slice(r,r+x);t.push(o.Z.trimNull(a.decode(n)).trim())}return t}class C{static createFromDexDriveData(e,t=null){return new C(e,t)}static createFromSaveFiles(e,t=null){const a=h.Z.createFromSaveFiles(e,t),i=new ArrayBuffer(D),r=new Uint8Array(i),n=new TextEncoder(p),l=new TextEncoder(f);r.fill(0),r.set(n.encode(S),0);const s=Array.from({length:h.Z.NUM_NOTES},(()=>null)),v=a.getSaveFiles().map(((t,a)=>({...t,comment:e[a].comment})));v.forEach((e=>{s[e.noteIndex]=e.comment}));for(let o=0;o<h.Z.NUM_NOTES;o+=1)if(null!==s[o]){const e=l.encode(s[o]).slice(0,x);r.set(e,F(o))}const u=o.Z.concatArrayBuffers([i,a.getArrayBuffer()]);return C.createFromDexDriveData(u,t)}constructor(e,t=null){this.arrayBuffer=e;let a=e.slice(0,D),i=e.slice(D);try{o.Z.checkMagic(a,0,S,p)}catch(l){if(e.byteLength===h.Z.TOTAL_SIZE)a=o.Z.getFilledArrayBuffer(D,0),i=e;else if(e.byteLength!==D+h.Z.TOTAL_SIZE)throw new Error("This does not appear to be a N64 DexDrive file")}const r=y(a),n=h.Z.createFromN64MempackData(i);this.saveFiles=n.getSaveFiles().map((e=>({...e,comment:r[e.noteIndex]}))),this.mempack=h.Z.createFromSaveFiles(this.saveFiles,t)}getSaveFiles(){return this.saveFiles}getMempack(){return this.mempack}getArrayBuffer(){return this.arrayBuffer}}var b={name:"ConvertN64DexDrive",data(){return{dexDriveSaveData:null,errorMessage:null,inputFilename:null,outputFilename:null,conversionDirection:"convertToRaw",selectedSaveData:null,individualSavesOrMemoryCard:"memory-card",individualSavesText:"Individual saves",memoryCardText:"Controller Pak"}},components:{ConversionDirection:d.Z,InputFile:v.Z,OutputFilename:u.Z,FileList:c.Z,IndividualSavesOrMemoryCardSelector:m.Z},computed:{convertButtonDisabled(){const e="convertToRaw"===this.conversionDirection||null===this.selectedSaveData;return!this.dexDriveSaveData||0===this.dexDriveSaveData.getSaveFiles().length||!e||!this.outputFilename},individualSavesOrMemoryCardText(){return"individual-saves"===this.individualSavesOrMemoryCard?this.individualSavesText:this.memoryCardText},userAllowedToChangeFilename(){return!this.dexDriveSaveData||this.dexDriveSaveData.getSaveFiles().length>0&&null!==this.selectedSaveData&&h.Z.isCartSave(this.dexDriveSaveData.getSaveFiles()[this.selectedSaveData])}},methods:{changeIndividualSavesOrMemoryCard(e){this.individualSavesOrMemoryCard!==e&&(this.individualSavesOrMemoryCard=e,"individual-saves"===e?null===this.selectedSaveData&&this.changeSelectedSaveData(0):(null!==this.inputFilename&&(this.outputFilename=o.Z.changeFilenameExtension(this.inputFilename,"mpk")),this.selectedSaveData=null))},getFileListNames(){return null!==this.dexDriveSaveData&&null!==this.dexDriveSaveData.getSaveFiles()?this.dexDriveSaveData.getSaveFiles().map((e=>({displayText:h.Z.isCartSave(e)?`Cartridge save: ${h.Z.getDisplayName(e)}`:`${h.Z.getDisplayName(e)} (${e.regionName})`}))):[]},changeConversionDirection(e){this.conversionDirection=e,this.dexDriveSaveData=null,this.errorMessage=null,this.inputFilename=null,this.outputFilename=null,this.selectedSaveData=null,this.individualSavesOrMemoryCard="memory-card"},changeSelectedSaveData(e){null!==e&&(null!==this.dexDriveSaveData&&this.dexDriveSaveData.getSaveFiles().length>0?(this.selectedSaveData=e,this.outputFilename=h.Z.createFilename(this.dexDriveSaveData.getSaveFiles()[this.selectedSaveData]),this.changeIndividualSavesOrMemoryCard("individual-saves")):(this.selectedSaveData=null,this.outputFilename=null))},readDexDriveSaveData(e){this.errorMessage=null,this.selectedSaveData=null,this.inputFilename=e.filename;try{this.dexDriveSaveData=C.createFromDexDriveData(e.arrayBuffer);const t=this.dexDriveSaveData.getSaveFiles().some((e=>h.Z.isCartSave(e)));this.individualSavesOrMemoryCard=null,t?(this.changeIndividualSavesOrMemoryCard("individual-saves"),this.changeSelectedSaveData(0)):this.changeIndividualSavesOrMemoryCard("memory-card")}catch(t){this.errorMessage="File appears to not be in the correct format",this.dexDriveSaveData=null,this.selectedSaveData=null}},readEmulatorSaveData(e){this.errorMessage=null,this.selectedSaveData=null,this.inputFilename=null;try{let t=e.map((e=>({parsedFilename:h.Z.parseFilename(e.filename),rawData:e.arrayBuffer})));t=t.map((e=>({noteName:e.parsedFilename.noteName,noteNameExtension:e.parsedFilename.noteNameExtension,gameSerialCode:e.parsedFilename.gameSerialCode,publisherCode:e.parsedFilename.publisherCode,comment:"Created with savefileconverter.com",rawData:e.rawData}))),this.dexDriveSaveData=C.createFromSaveFiles(t),this.dexDriveSaveData.getSaveFiles().length>0?this.outputFilename=`${o.Z.convertDescriptionToFilename(this.dexDriveSaveData.getSaveFiles()[0].noteName)}.n64`:this.outputFilename="output.n64"}catch(t){this.errorMessage=t.message,this.dexDriveSaveData=null,this.selectedSaveData=null}},convertFile(){let e=null;e="convertToRaw"===this.conversionDirection?"individual-saves"===this.individualSavesOrMemoryCard?this.dexDriveSaveData.getSaveFiles()[this.selectedSaveData].rawData:this.dexDriveSaveData.getMempack().getArrayBuffer():this.dexDriveSaveData.getArrayBuffer();const t=new Blob([e],{type:"application/octet-stream"});(0,s.saveAs)(t,this.outputFilename)}}},T=b,M=a(1001),w=(0,M.Z)(T,n,l,!1,null,"6e70b499",null),Z=w.exports,_={name:"N64DexDriveView",components:{ConvertN64DexDrive:Z}},k=_,N=(0,M.Z)(k,i,r,!1,null,null,null),I=N.exports}}]);