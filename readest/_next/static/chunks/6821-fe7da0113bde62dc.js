"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6821],{6085:(e,t,n)=>{n.d(t,{n:()=>u,g:()=>f});var s=n(62574),a=n(84574),l=n(69921),i=n(28039);let o=(0,l.L1)()+"/sync";class r{async pullChanges(e,t,n){let s=await (0,i.iD)();if(!s)throw Error("Not authenticated");let a="".concat(o,"?since=").concat(encodeURIComponent(e),"&type=").concat(null!=t?t:"","&book=").concat(null!=n?n:""),l=await fetch(a,{headers:{Authorization:"Bearer ".concat(s)}});if(!l.ok){let e=await l.json();throw Error("Failed to pull changes: ".concat(e.error||l.statusText))}return l.json()}async pushChanges(e){let t=await (0,i.iD)();if(!t)throw Error("Not authenticated");let n=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(!n.ok){let e=await n.json();throw Error("Failed to push changes: ".concat(e.error||n.statusText))}return n.json()}}let c=new r,d=(0,a.createContext)({syncClient:c}),u=e=>{let{children:t}=e;return(0,s.jsx)(d.Provider,{value:{syncClient:c},children:t})},f=()=>(0,a.useContext)(d)},11437:(e,t,n)=>{n.d(t,{_:()=>d});var s=n(84574),a=n(38012),l=n(5375),i=n(88330),o=n(69921),r=n(58941),c=n(75454);function d(){let e=(0,a.useRouter)(),{setCheckOpenWithBooks:t}=(0,r.C)(),n=(0,s.useRef)(!1),d=n=>{console.log("Handle Open with URL:",n);let s=n;s.startsWith("file://")&&(s=decodeURI(s.replace("file://",""))),/^(https?:|data:|blob:)/i.test(s)||(window.OPEN_WITH_FILES=[s],t(!0),(0,c.i7)(e,"reload=".concat(Date.now())))};(0,s.useEffect)(()=>{if(!(0,o.uO)()||n.current)return;n.current=!0;let e=(0,i.getCurrentWindow)().listen("single-instance",e=>{let{event:t,payload:n}=e;console.log("Received deep link:",t,n);let{args:s}=n;(null==s?void 0:s[1])&&d(s[1])}),t=(async()=>await (0,l.bx)(e=>{e.forEach(e=>{d(e)})}))();return()=>{e.then(e=>e()),t.then(e=>e())}},[])}},16161:(e,t,n)=>{n.d(t,{A:()=>i});var s=n(84574);let a={onSwitchSideBar:["ctrl+Tab","opt+Tab","alt+Tab"],onToggleSideBar:["s"],onToggleNotebook:["n"],onToggleSearchBar:["ctrl+f","cmd+f"],onToggleScrollMode:["shift+j"],onToggleSelectMode:["shift+s"],onOpenFontLayoutSettings:["shift+f"],onReloadPage:["shift+r"],onToggleFullscreen:["F11"],onQuitApp:["ctrl+q","cmd+q"],onGoLeft:["ArrowLeft","PageUp","h"],onGoRight:["ArrowRight","PageDown","l"," "],onGoNext:["ArrowDown","j"],onGoPrev:["ArrowUp","k"],onGoHalfPageDown:["shift+ArrowDown","d"],onGoHalfPageUp:["shift+ArrowUp","u"],onGoBack:["shift+ArrowLeft","shift+h"],onGoForward:["shift+ArrowRight","shift+l"],onZoomIn:["ctrl+=","cmd+=","shift+="],onZoomOut:["ctrl+-","cmd+-","shift+-"],onResetZoom:["ctrl+0","cmd+0"],onSaveNote:["ctrl+Enter"],onCloseNote:["Escape"]},l=()=>{if("undefined"==typeof localStorage)return a;let e=JSON.parse(localStorage.getItem("customShortcuts")||"{}");return{...a,...e}},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],[n,a]=(0,s.useState)(l);(0,s.useEffect)(()=>{let e=()=>{a(l())};return window.addEventListener("shortcutUpdate",e),()=>window.removeEventListener("shortcutUpdate",e)},[]);let i=e=>{let t=e.toLowerCase().split("+");return{ctrlKey:t.includes("ctrl"),altKey:t.includes("alt")||t.includes("opt"),metaKey:t.includes("meta")||t.includes("cmd"),shiftKey:t.includes("shift"),key:t.find(e=>!["ctrl","alt","opt","meta","cmd","shift"].includes(e))}},o=(e,t,n,s,a,l)=>{let o=i(e);return o.key===t.toLowerCase()&&o.ctrlKey===n&&o.altKey===s&&o.metaKey===a&&o.shiftKey===l},r=(t,s,a,l,i)=>{if("backspace"===t)return!0;for(let[r,c]of Object.entries(e)){let e=n[r];if(c&&(null==e?void 0:e.some(e=>o(e,t,s,a,l,i))))return c(),!0}return!1},c=e=>{let t=document.activeElement,n="INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable,s="TEXTAREA"===t.tagName&&t.classList.contains("note-editor");if(!n||s){if(e instanceof KeyboardEvent){let{key:t,ctrlKey:n,altKey:a,metaKey:l,shiftKey:i}=e;if(s&&!("Enter"===t&&n||"Escape"==t))return;r(t.toLowerCase(),n,a,l,i)&&e.preventDefault()}else if(e instanceof MessageEvent&&e.data&&"iframe-keydown"===e.data.type){let{key:t,ctrlKey:n,altKey:s,metaKey:a,shiftKey:l}=e.data;r(t.toLowerCase(),n,s,a,l)}}};(0,s.useEffect)(()=>(window.addEventListener("keydown",c),window.addEventListener("message",c),()=>{window.removeEventListener("keydown",c),window.removeEventListener("message",c)}),[n,...t])}},18426:(e,t,n)=>{n.d(t,{N:()=>i});var s=n(84574),a=n(88330),l=n(69921);let i=e=>{let t=(0,s.useRef)(null),n=(0,s.useRef)(null);(0,s.useEffect)(()=>{let s=async()=>{try{"wakeLock"in navigator&&(t.current=await navigator.wakeLock.request("screen"),t.current.addEventListener("release",()=>{t.current=null}),console.log("Wake lock acquired"))}catch(e){console.info("Failed to acquire wake lock:",e)}},i=()=>{t.current&&(t.current.release(),t.current=null,console.log("Wake lock released"))},o=()=>{document.hidden?i():s()};return e?s():t.current&&i(),(0,l.hx)()&&e?document.addEventListener("visibilitychange",o):(0,l.uO)()&&e&&(n.current=(0,a.getCurrentWindow)().onFocusChanged(e=>{let{payload:t}=e;t?s():i()})),()=>{i(),(0,l.hx)()&&e&&document.removeEventListener("visibilitychange",o),n.current&&n.current.then(e=>e())}},[e])}},18631:(e,t,n)=>{n.d(t,{w:()=>l});var s=n(75972),a=n(7269);let l=(0,s.v)((e,t)=>({appService:void 0,isTrafficLightVisible:!1,shouldShowTrafficLight:!1,initializeTrafficLightStore:t=>{e({appService:t,isTrafficLightVisible:t.hasTrafficLight,shouldShowTrafficLight:t.hasTrafficLight})},setTrafficLightVisibility:async t=>{let{getCurrentWindow:s}=await Promise.resolve().then(n.bind(n,88330)),l=s();e({isTrafficLightVisible:!await l.isFullscreen()&&t,shouldShowTrafficLight:t}),(0,a.lA)("set_traffic_lights",{visible:t,x:10,y:22})},initializeTrafficLightListeners:async()=>{let{getCurrentWindow:s}=await Promise.resolve().then(n.bind(n,88330)),a=s(),l=await a.listen("will-enter-fullscreen",()=>{e({isTrafficLightVisible:!1})}),i=await a.listen("will-exit-fullscreen",()=>{let{shouldShowTrafficLight:n}=t();e({isTrafficLightVisible:n})});e({unlistenEnterFullScreen:l,unlistenExitFullScreen:i})},cleanupTrafficLightListeners:()=>{let{unlistenEnterFullScreen:n,unlistenExitFullScreen:s}=t();n&&n(),s&&s(),e({unlistenEnterFullScreen:void 0,unlistenExitFullScreen:void 0})}}))},20867:(e,t,n)=>{n.d(t,{y:()=>o});var s=n(62574),a=n(3073),l=n(84574),i=n(66763);let o=()=>{let[e,t]=(0,l.useState)(""),n=(0,l.useRef)("info"),o=(0,l.useRef)(5e3),r=(0,l.useRef)(""),c=(0,l.useRef)(null),d={info:"toast-info toast-center toast-middle",success:"toast-success toast-top toast-end",warning:"toast-warning toast-top toast-end",error:"toast-error toast-top toast-end"};(0,l.useEffect)(()=>(c.current&&clearTimeout(c.current),c.current=setTimeout(()=>t(""),o.current),()=>{c.current&&clearTimeout(c.current)}),[e]);let u=async e=>{let{message:s,type:a="info",timeout:l,className:i=""}=e.detail;t(s),n.current=a,l&&(o.current=l),r.current=i};return(0,l.useEffect)(()=>(i.I.on("toast",u),()=>{i.I.off("toast",u)}),[]),e&&(0,s.jsx)("div",{className:(0,a.A)("toast toast-center toast-middle z-50 w-auto max-w-screen-sm",d[n.current],d[n.current].includes("toast-top")&&"pt-[calc(44px+env(safe-area-inset-top))]"),children:(0,s.jsx)("div",{className:(0,a.A)("alert flex items-center justify-center",{info:"alert-primary border-base-300",success:"alert-success border-0",warning:"alert-warning border-0",error:"alert-error border-0"}[n.current]),children:(0,s.jsx)("span",{className:(0,a.A)("max-h-[50vh] min-w-32","overflow-y-auto text-center","info"===n.current?"max-w-[80vw]":"max-w-80 whitespace-normal break-words",r.current),children:e.split("\n").map((e,t)=>(0,s.jsxs)(l.Fragment,{children:[e||(0,s.jsx)(s.Fragment,{children:"\xa0"}),(0,s.jsx)("br",{})]},t))})})})}},22697:(e,t,n)=>{n.d(t,{i:()=>p,o:()=>w});var s=n(62574),a=n(84574),l=n(25143),i=n(80239),o=n(57597),r=n(78549),c=n(38174);let d=e=>{let t=navigator.userAgent;if(null==e?void 0:e.isAndroidApp){let e=t.match(/Chrome\/([0-9.]+)/);return e?"WebView ".concat(e[1]):"Android WebView"}if(null==e?void 0:e.isIOSApp){let e=t.match(/AppleWebKit\/([0-9.]+)/);return e?"WebView ".concat(e[1]):"iOS WebView"}if(null==e?void 0:e.isMacOSApp){let e=t.match(/AppleWebKit\/([0-9.]+)/);return e?"WebView ".concat(e[1]):"macOS WebView"}if((null==e?void 0:e.appPlatform)==="tauri"&&(null==e?void 0:e.osPlatform)==="windows"){let e=t.match(/Edg\/([0-9.]+)/);return e?"Edge ".concat(e[1]):"Edge WebView2"}if((null==e?void 0:e.appPlatform)==="tauri"&&(null==e?void 0:e.osPlatform)==="linux"){let e=t.match(/AppleWebKit\/([0-9.]+)/);return e?"WebView ".concat(e[1]):"Linux WebView"}else if(t.includes("CriOS")&&t.includes("Mobile/")&&t.includes("Safari")){let e=t.match(/CriOS\/([0-9.]+)/);return e?"Chrome ".concat(e[1]):"iOS Chrome"}else if(t.includes("FxiOS")&&t.includes("Mobile/")&&t.includes("Safari")){let e=t.match(/FxiOS\/([0-9.]+)/);return e?"Firefox ".concat(e[1]):"iOS Firefox"}else if(t.includes("Chrome")&&t.includes("AppleWebKit")&&t.includes("Macintosh")){let e=t.match(/Chrome\/([0-9.]+)/);return e?"Chrome ".concat(e[1]):"macOS Chrome"}else if(t.includes("Safari")&&t.includes("AppleWebKit")&&t.includes("Macintosh")){let e=t.match(/Safari\/([0-9.]+)/);return e?"Safari ".concat(e[1]):"macOS Safari"}else if(t.includes("Edg/")){let e=t.match(/Edg\/([0-9.]+)/);return e?"Edge ".concat(e[1]):"Edge WebView"}else if(t.includes("Firefox/")){let e=t.match(/Firefox\/([0-9.]+)/);return e?"Firefox ".concat(e[1]):"Firefox Gecko"}else if(t.includes("Chrome/")&&!t.includes("Chromium")){let e=t.match(/Chrome\/([0-9.]+)/);return e?"Chrome ".concat(e[1]):"Chrome"}else if(t.includes("Chromium/")){let e=t.match(/Chromium\/([0-9.]+)/);return e?"Chromium ".concat(e[1]):"Chromium"}else{if(!t.includes("MSIE "))return"Unknown";let e=t.match(/MSIE ([0-9.]+)/);return e?"IE ".concat(e[1]):"Internet Explorer"}};var u=n(64466),f=n(69921),m=n(90734);let h=e=>{let{href:t,children:n,...a}=e,l=async e=>{(0,f.uO)()&&(e.preventDefault(),await (0,m.CZ)(t))};return(0,s.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",onClick:l,...a,children:n})},w=e=>{let t=document.getElementById("about_window");if(t){let n=new CustomEvent("setDialogVisibility",{detail:{visible:e}});t.dispatchEvent(n)}},p=()=>{let e=(0,r.B)(),{appService:t}=(0,o.D)(),[n,f]=(0,a.useState)(null),[m,w]=(0,a.useState)(""),[p,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{w(d(t));let e=e=>{x(e.detail.visible)},n=document.getElementById("about_window");return n&&n.addEventListener("setDialogVisibility",e),()=>{n&&n.removeEventListener("setDialogVisibility",e)}},[]);let g=async()=>{f("checking");try{await (0,c.J)(e,!1)?x(!1):f("updated")}catch(e){console.info("Error checking for updates:",e),f("error")}};return(0,s.jsx)(u.A,{id:"about_window",isOpen:p,title:e("About Readest"),onClose:()=>{x(!1),f(null)},boxClassName:"sm:!w-96 sm:h-auto",children:(0,s.jsxs)("div",{className:"about-content flex h-full flex-col items-center justify-center",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 px-8",children:[(0,s.jsx)("div",{className:"mb-2 mt-8",children:(0,s.jsx)(l.default,{src:"/icon.png",alt:"App Logo",className:"h-20 w-20",width:64,height:64})}),(0,s.jsxs)("div",{className:"flex select-text flex-col items-center",children:[(0,s.jsx)("h2",{className:"mb-2 text-2xl font-bold",children:"Readest"}),(0,s.jsxs)("p",{className:"text-neutral-content text-center text-sm",children:[e("Version {{version}}",{version:i.rE})," ","(".concat(m,")")]})]}),(0,s.jsxs)("div",{className:"h-5",children:[(null==t?void 0:t.hasUpdater)&&!n&&(0,s.jsx)("span",{className:"badge badge-primary cursor-pointer p-1",onClick:g,children:e("Check Update")}),"updated"===n&&(0,s.jsx)("p",{className:"text-neutral-content mt-2 text-xs",children:e("Already the latest version")}),"checking"===n&&(0,s.jsx)("p",{className:"text-neutral-content mt-2 text-xs",children:e("Checking for updates...")}),"error"===n&&(0,s.jsx)("p",{className:"text-error mt-2 text-xs",children:e("Error checking for updates")})]})]}),(0,s.jsx)("div",{className:"divider py-16 sm:py-2"}),(0,s.jsxs)("div",{className:"flex flex-col items-center px-4 text-center",dir:"ltr",children:[(0,s.jsxs)("p",{className:"text-neutral-content text-sm",children:["\xa9 ",new Date().getFullYear()," Bilingify LLC. All rights reserved."]}),(0,s.jsxs)("p",{className:"text-neutral-content mt-2 text-xs",children:["This software is licensed under the"," ",(0,s.jsx)(h,{href:"https://www.gnu.org/licenses/agpl-3.0.html",className:"text-blue-500 underline",children:"GNU Affero General Public License v3.0"}),". You are free to use, modify, and distribute this software under the terms of the AGPL v3 license. Please see the license for more details."]}),(0,s.jsxs)("p",{className:"text-neutral-content my-2 text-xs",children:["Source code is available at"," ",(0,s.jsx)(h,{href:"https://github.com/readest/readest",className:"text-blue-500 underline",children:"GitHub"}),"."]})]})]})})}},25289:(e,t,n)=>{n.d(t,{n:()=>s});let s=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{emitLast:!0},s=0,a=null,l=null;return function(){for(var i=arguments.length,o=Array(i),r=0;r<i;r++)o[r]=arguments[r];let c=t-(Date.now()-s);c<=0?(a&&(clearTimeout(a),a=null),s=Date.now(),a=null,e(...o)):(l=o,a||(a=setTimeout(()=>{a=null,l&&n.emitLast&&(e(...l),l=null)},c)))}}},25538:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(62574),a=n(3073),l=n(25143),i=n(58529);let o=e=>{let{mode:t="grid",book:n,isPreview:o}=e;return(0,s.jsxs)("div",{className:(0,a.A)("relative flex h-full w-full"),children:[(0,s.jsx)(l.default,{src:n.coverImageUrl,alt:n.title,fill:!0,className:"object-cover",onError:e=>{var t;e.target.style.display="none",null==(t=e.target.nextElementSibling)||t.classList.remove("invisible")}}),(0,s.jsxs)("div",{className:(0,a.A)("invisible absolute inset-0 rounded-none p-2","text-neutral-content text-center font-serif font-medium",o&&"bg-base-200/50"),children:[(0,s.jsx)("div",{className:"flex h-1/2 items-center justify-center",children:(0,s.jsx)("span",{className:(0,a.A)(o?"line-clamp-2":"grid"===t?"line-clamp-3":"line-clamp-2",o?"text-[0.5em]":"grid"===t?"text-lg":"text-sm"),children:(0,i.Ef)(n.title)})}),(0,s.jsx)("div",{className:"h-1/6"}),(0,s.jsx)("div",{className:"flex h-1/3 items-center justify-center",children:(0,s.jsx)("span",{className:(0,a.A)("text-neutral-content/50 line-clamp-1",o?"text-[0.4em]":"grid"===t?"text-base":"text-xs"),children:(0,i.kY)(n.author)})})]})]})}},29353:(e,t,n)=>{n.d(t,{Lj:()=>m,YF:()=>c,_Y:()=>o,c_:()=>h,tP:()=>f,tQ:()=>u,u5:()=>r,wm:()=>d});var s=n(88330),a=n(19806),l=n(70627),i=n(66763);let o=async()=>{let e=(0,s.getCurrentWindow)(),t=await e.scaleFactor(),n=await e.outerPosition();return{x:n.x/t,y:n.y/t}},r=async()=>{(0,s.getCurrentWindow)().minimize()},c=async()=>{let e=(0,s.getCurrentWindow)();await e.isFullscreen()?(await e.setFullscreen(!1),await e.unmaximize()):(0,s.getCurrentWindow)().toggleMaximize()},d=async()=>{(0,s.getCurrentWindow)().close()},u=async e=>(0,s.getCurrentWindow)().listen(a.es.WINDOW_CLOSE_REQUESTED,async()=>{await e(),console.log("exit app"),await (0,l.N)(0)}),f=async()=>{let e=(0,s.getCurrentWindow)(),t=await e.isFullscreen();await e.isMaximized()?await e.unmaximize():await e.setFullscreen(!t)},m=async e=>{let t=(0,s.getCurrentWindow)();await t.setAlwaysOnTop(e)},h=async()=>{await i.I.dispatch("quit-app"),await (0,l.N)(0)}},29613:(e,t,n)=>{n.d(t,{I:()=>l});var s=n(75972),a=n(58941);let l=(0,s.v)((e,t)=>({booksData:{},getBookData:e=>{let n=e.split("-")[0];return t().booksData[n]||null},getConfig:e=>{var n;if(!e)return null;let s=e.split("-")[0];return(null==(n=t().booksData[s])?void 0:n.config)||null},setConfig:(t,n)=>{e(e=>{var s;let a=t.split("-")[0],l=(null==(s=e.booksData[a])?void 0:s.config)||{};return Object.assign(l,n),{booksData:{...e.booksData,[a]:{...e.booksData[a],config:l}}}})},saveConfig:async(e,t,n,s)=>{let l=await e.getAppService(),{library:i,setLibrary:o}=a.C.getState(),r=i.findIndex(e=>e.hash===t.split("-")[0]);if(-1==r)return;let c=i.splice(r,1)[0];c.progress=n.progress,c.updatedAt=Date.now(),i.unshift(c),o(i),n.updatedAt=Date.now(),await l.saveBookConfig(c,n,s),await l.saveLibraryBooks(i)},updateBooknotes:(t,n)=>{let s;return e(e=>{let a=t.split("-")[0],l=e.booksData[a];if(!l)return e;let i=Array.from(new Map(n.map(e=>["".concat(e.id,"-").concat(e.type,"-").concat(e.cfi),e])).values());return s={...l.config,updatedAt:Date.now(),booknotes:i},{booksData:{...e.booksData,[a]:{...l,config:{...l.config,updatedAt:Date.now(),booknotes:i}}}}}),s}}))},38174:(e,t,n)=>{n.d(t,{J:()=>h});var s=n(40379),a=n.n(s),l=n(5404),i=n(54599),o=n(67915),r=n(53677),c=n(44625),d=n(40965),u=n(80239);let f="lastAppUpdateCheck",m=e=>{let t=new r.wp("updater",{url:"/updater?version=".concat(e),title:"Software Update",width:626,height:406,center:!0,resizable:!0});t.once("tauri://created",()=>{console.log("new window created")}),t.once("tauri://error",e=>{console.error("error creating window",e)})},h=async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=localStorage.getItem(f),s=Date.now();if(t&&n&&s-parseInt(n,10)<1e3*d.L7)return!1;localStorage.setItem(f,s.toString()),console.log("Checking for updates");let r=(0,i.NW)();if(["macos","windows","linux"].includes(r)){let e=await (0,l.z)();return e&&m(e.version),!!e}if("android"===r)try{let e=await (0,o.h)(d.GM,{connectTimeout:5e3}),t=await e.json(),n=a().gt(t.version,u.rE);return n&&("android-arm64"in t.platforms||"android-universal"in t.platforms)&&(0,c.mL)(!0,t.version),n}catch(e){throw console.warn("Failed to fetch Android update info",e),Error("Failed to fetch Android update info")}return!1}},40078:(e,t,n)=>{n.d(t,{s:()=>s});let s=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{emitLast:!0},s=null,a=null;return function(){for(var l=arguments.length,i=Array(l),o=0;o<l;o++)i[o]=arguments[o];s&&clearTimeout(s),n.emitLast?(a=i,s=setTimeout(()=>{a&&(e(...a),a=null),s=null},t)):s=setTimeout(()=>{e(...i),s=null},t)}}},56945:(e,t,n)=>{n.d(t,{p:()=>u});var s=n(84574),a=n(38012),l=n(6085),i=n(20517),o=n(29613),r=n(75454);let c={books:e=>{let{book_hash:t,format:n,title:s,author:a,group_id:l,group_name:i,tags:o,progress:r,created_at:c,updated_at:d,deleted_at:u,uploaded_at:f}=e;return{hash:t,format:n,title:s,author:a,groupId:l,groupName:i,tags:o,progress:r,createdAt:new Date(c).getTime(),updatedAt:new Date(d).getTime(),deletedAt:u?new Date(u).getTime():null,uploadedAt:f?new Date(f).getTime():null}},notes:e=>{let{book_hash:t,id:n,type:s,cfi:a,text:l,style:i,color:o,note:r,created_at:c,updated_at:d,deleted_at:u}=e;return{bookHash:t,id:n,type:s,cfi:a,text:l,style:i,color:o,note:r,createdAt:new Date(c).getTime(),updatedAt:new Date(d).getTime(),deletedAt:u?new Date(u).getTime():null}},configs:e=>{let{book_hash:t,progress:n,location:s,search_config:a,view_settings:l,updated_at:i}=e;return{bookHash:t,location:s,progress:n&&JSON.parse(n),searchConfig:a&&JSON.parse(a),viewSettings:l&&JSON.parse(l),updatedAt:new Date(i).getTime()}}},d=e=>{let t=0;for(let n of e)n.updated_at&&(t=Math.max(t,new Date(n.updated_at).getTime())),n.deleted_at&&(t=Math.max(t,new Date(n.deleted_at).getTime()));return t};function u(e){let t=(0,a.useRouter)(),{settings:n,setSettings:u}=(0,i.C)(),{getConfig:f,setConfig:m}=(0,o.I)(),h=e?f(e):null,[w,p]=(0,s.useState)(!1),[x,g]=(0,s.useState)(!1),[b,v]=(0,s.useState)(!1),[y,j]=(0,s.useState)(null),[N,k]=(0,s.useState)(0),[S,C]=(0,s.useState)(0),[A,L]=(0,s.useState)(0),E=(0,s.useRef)(!1),[T,D]=(0,s.useState)(!1),[W,O]=(0,s.useState)({books:null,configs:null,notes:null}),[F,B]=(0,s.useState)(null),[I,R]=(0,s.useState)(null),[U,z]=(0,s.useState)(null),{syncClient:M}=(0,l.g)();(0,s.useEffect)(()=>{var e,t,s,a,l;if(!n||!h||E.current)return;E.current=!0;let i=null!=(e=n.lastSyncedAtBooks)?e:0,o=null!=(s=null!=(t=null==h?void 0:h.lastSyncedAtConfig)?t:n.lastSyncedAtConfigs)?s:0,r=null!=(l=null!=(a=null==h?void 0:h.lastSyncedAtNotes)?a:n.lastSyncedAtNotes)?l:0;k(i>0?i-6048e5:0),C(o>0?o-6048e5:0),L(r>0?r-6048e5:0)},[n,h]);let P=async(s,a,l,o,c)=>{o(!0),j(null);try{let t=await M.pullChanges(a,s,c);O({...W,[s]:t[s]});let n=t[s];if(!(null==n?void 0:n.length))return;let o=d(n);l(o);let r=i.C.getState().settings;switch(s){case"books":r.lastSyncedAtBooks=o,u(r);break;case"configs":c?e&&h&&(h.lastSyncedAtConfig=o,m(e,h)):(r.lastSyncedAtConfigs=o,u(r));break;case"notes":c?e&&h&&(h.lastSyncedAtNotes=o,m(e,h)):(r.lastSyncedAtNotes=o,u(r))}}catch(e){console.error(e),e instanceof Error?(e.message.includes("Not authenticated")&&n.keepLogin&&(n.keepLogin=!1,u(n),(0,r.OO)(t)),j(e.message||"Error pulling ".concat(s))):j("Error pulling ".concat(s))}finally{o(!1)}},V=async e=>{D(!0),j(null);try{let t=await M.pushChanges(e);O(t)}catch(e){console.error(e),e instanceof Error?j(e.message||"Error pushing changes"):j("Error pushing changes")}finally{D(!1)}},_=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"both";("push"===t||"both"===t)&&(null==e?void 0:e.length)&&await V({books:e}),("pull"===t||"both"===t)&&await P("books",N,k,p)},K=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"both";("push"===n||"both"===n)&&(null==e?void 0:e.length)&&await V({configs:e}),("pull"===n||"both"===n)&&await P("configs",S,C,g,t)},H=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"both";("push"===n||"both"===n)&&(null==e?void 0:e.length)&&await V({notes:e}),("pull"===n||"both"===n)&&await P("notes",A,L,v,t)};return(0,s.useEffect)(()=>{if(!T&&W){let{books:e,configs:t,notes:n}=W,s=null==e?void 0:e.map(e=>c.books(e)),a=null==t?void 0:t.map(e=>c.configs(e)),l=null==n?void 0:n.map(e=>c.notes(e));s&&B(s),a&&R(a),l&&z(l)}},[W,T]),{syncing:w||x||b,syncError:y,syncResult:W,syncedBooks:F,syncedConfigs:I,syncedNotes:U,lastSyncedAtBooks:N,lastSyncedAtNotes:A,lastSyncedAtConfigs:S,pullChanges:P,pushChanges:V,syncBooks:_,syncConfigs:K,syncNotes:H}}},58941:(e,t,n)=>{n.d(t,{C:()=>l});var s=n(75972),a=n(69921);let l=(0,s.v)((e,t)=>({library:[],currentBookshelf:[],checkOpenWithBooks:(0,a.uO)(),checkLastOpenBooks:(0,a.uO)(),getVisibleLibrary:()=>t().library.filter(e=>!e.deletedAt),setCurrentBookshelf:t=>{e({currentBookshelf:t})},setCheckOpenWithBooks:t=>e({checkOpenWithBooks:t}),setCheckLastOpenBooks:t=>e({checkLastOpenBooks:t}),setLibrary:t=>e({library:t}),updateBook:async(n,s)=>{let a=await n.getAppService(),{library:l}=t(),i=l.findIndex(e=>e.hash===s.hash);-1!==i&&(l[i]=s),e({library:[...l]}),a.saveLibraryBooks(l)}}))},60314:(e,t,n)=>{n.d(t,{A:()=>i});var s=n(62574),a=n(3073);n(84574);var l=n(25470);let i=e=>{let{label:t,description:n,buttonClass:i,labelClass:o,shortcut:r,disabled:c,noIcon:d=!1,Icon:u,children:f,onClick:m}=e,h=(0,l.D)(16),w=(0,s.jsxs)("button",{className:(0,a.A)("hover:bg-base-300 text-base-content flex w-full flex-col items-center justify-center rounded-md p-1 py-[10px]",c&&"btn-disabled text-gray-400",i),onClick:m,disabled:c,children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex min-w-0 items-center",children:[!d&&(0,s.jsx)("span",{style:{minWidth:"".concat(h,"px")},children:"function"==typeof u?(0,s.jsx)(u,{className:"text-base-content",size:h}):u}),(0,s.jsx)("span",{className:(0,a.A)("mx-2 flex-1 truncate text-base sm:text-sm",o),style:{minWidth:0},children:t})]}),r&&(0,s.jsx)("kbd",{className:(0,a.A)("border-base-300/40 bg-base-300/75 text-neutral-content hidden rounded-md border shadow-sm sm:flex","shrink-0 px-1.5 py-0.5 text-xs font-medium"),children:r})]}),(0,s.jsx)("div",{className:"flex w-full",children:n&&(0,s.jsx)("span",{className:"mt-1 truncate text-start text-xs text-gray-500",style:{minWidth:0,paddingInlineStart:d?"0":"".concat(h+8,"px")},children:n})})]});return f?(0,s.jsx)("ul",{className:"menu rounded-box m-0 p-0",children:(0,s.jsx)("li",{children:(0,s.jsxs)("details",{children:[(0,s.jsx)("summary",{className:"hover:bg-base-300 p-0 pr-3",children:w}),f]})})}):w}},64765:(e,t,n)=>{n.d(t,{A:()=>i});var s=n(62574),a=n(3073),l=n(84574);let i=e=>{let{className:t,menuClassName:n,buttonClassName:i,toggleButton:o,children:r,onToggle:c}=e,[d,u]=(0,l.useState)(!1),f=e=>{u(e),null==c||c(e)},m=(0,l.isValidElement)(r)?l.cloneElement(r,{setIsDropdownOpen:f,menuClassName:n}):r;return(0,s.jsxs)("div",{className:"dropdown-container",children:[d&&(0,s.jsx)("div",{className:"fixed inset-0 bg-transparent",onClick:()=>f(!1)}),(0,s.jsxs)("div",{className:(0,a.A)("dropdown",t),children:[(0,s.jsx)("div",{tabIndex:-1,onClick:()=>{let e=!d;u(e),null==c||c(e)},className:(0,a.A)("dropdown-toggle",i,d&&"bg-base-300/50"),children:o}),d&&m]})]})}},65865:(e,t,n)=>{n.d(t,{L:()=>r});var s=n(69921),a=n(5375);let l=()=>window.OPEN_WITH_FILES,i=async()=>{let{getMatches:e}=await n.e(164).then(n.bind(n,30164)),t=await e(),s=null==t?void 0:t.args,a=[];if(s)for(let e of["file1","file2","file3","file4"]){let t=s[e];t&&t.occurrences>0&&a.push(t.value)}return a},o=async()=>{let e=await (0,a.wB)();return e&&e.length>0?(console.log("Intent Open with URL:",e),e.map(e=>e.startsWith("file://")?decodeURI(e.replace("file://","")):e.startsWith("content://")?e:(console.info("Skip non-file URL:",e),null)).filter(e=>null!==e)):null},r=async()=>{if((0,s.hx)())return[];let e=l();return(!e||0===e.length)&&(0,s.Jd)()&&(e=await i()),e&&0!==e.length||(e=await o()),e}},70100:(e,t,n)=>{n.d(t,{D:()=>c});var s=n(50981);let a=[{family:"Bitter",weights:"ital,wght@0,100..900;1,100..900"},{family:"Fira Code",weights:"wght@300..700"},{family:"Literata",weights:"ital,opsz,wght@0,7..72,200..900;1,7..72,200..900"},{family:"Merriweather",weights:"ital,opsz,wght@0,18..144,300..900;1,18..144,300..900"},{family:"Noto Sans",weights:"ital,wght@0,100..900;1,100..900"},{family:"Open Sans",weights:"ital,wght@0,300..800;1,300..800"},{family:"Roboto",weights:"ital,wght@0,100..900;1,100..900"},{family:"Vollkorn",weights:"ital,wght@0,400..900;1,400..900"}],l=[{family:"LXGW WenKai TC",weights:""},{family:"Noto Sans SC",weights:""},{family:"Noto Sans TC",weights:""},{family:"Noto Serif JP",weights:""}],i=()=>'\n  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?'.concat(a.map(e=>{let{family:t,weights:n}=e;return"family=".concat(encodeURIComponent(t)).concat(n?":".concat(n):"")}).join("&"),'&display=swap" crossorigin="anonymous">\n'),o=()=>'\n  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/misans-webfont@1.0.4/misans-l3/misans-l3/result.min.css" crossorigin="anonymous">\n  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cn-fontsource-lxgw-wen-kai-gb-screen@1.0.6/font.min.css" crossorigin="anonymous">\n  <link rel=\'stylesheet\' href=\'https://fontsapi.zeoseven.com/431/main/result.css\' crossorigin="anonymous"/>\n  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?'.concat(l.map(e=>{let{family:t,weights:n}=e;return"family=".concat(encodeURIComponent(t)).concat(n?":".concat(n):"")}).join("&"),'&display=swap" crossorigin="anonymous">\n'),r=()=>'\n  @font-face {\n    font-family: "FangSong";\n    font-display: swap;\n    src: local("Fang Song"), local("FangSong"), local("Noto Serif CJK"), local("Source Han Serif SC VF"), url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.eot");\n    src: url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.eot?#iefix") format("embedded-opentype"),\n    url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.woff2") format("woff2"),\n    url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.woff") format("woff"),\n    url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.ttf") format("truetype"),\n    url("https://db.onlinewebfonts.com/t/2ecbfe1d9bfc191c6f15c0ccc23cbd43.svg#FangSong") format("svg");\n  }\n  @font-face {\n    font-family: "Kaiti";\n    font-display: swap;\n    src: local("Kai"), local("KaiTi"), local("AR PL UKai"), local("LXGW WenKai GB Screen"), url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.eot");\n    src: url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.eot?#iefix")format("embedded-opentype"),\n    url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.woff2")format("woff2"),\n    url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.woff")format("woff"),\n    url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.ttf")format("truetype"),\n    url("https://db.onlinewebfonts.com/t/1ee9941f1b8c128110ca4307dda59917.svg#STKaiti")format("svg");\n  }\n  @font-face {\n    font-family: "Heiti";\n    font-display: swap;\n    src: local("Hei"), local("SimHei"), local("WenQuanYi Zen Hei"), local("Source Han Sans SC VF"), url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.eot");\n    src: url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.eot?#iefix")format("embedded-opentype"),\n    url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.woff2")format("woff2"),\n    url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.woff")format("woff"),\n    url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.ttf")format("truetype"),\n    url("https://db.onlinewebfonts.com/t/a4948b9d43a91468825a5251df1ec58d.svg#WenQuanYi Micro Hei")format("svg");\n  }\n  @font-face {\n    font-family: "XiHeiti";\n    font-display: swap;\n    src: local("PingFang SC"), local("Microsoft YaHei"), local("WenQuanYi Micro Hei"), local("FZHei-B01"), url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.eot");\n    src: url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.eot?#iefix")format("embedded-opentype"),\n    url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.woff2")format("woff2"),\n    url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.woff")format("woff"),\n    url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.ttf")format("truetype"),\n    url("https://db.onlinewebfonts.com/t/4f0b783ba4a1b381fc7e7af81ecab481.svg#STHeiti J Light")format("svg");\n}\n',c=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t||(0,s.ii)(),a=i();if(n){let t=e.createElement("style");t.textContent=r(),e.head.appendChild(t),a="".concat(a,"\n").concat(o())}Array.from(new DOMParser().parseFromString(a,"text/html").head.children).forEach(t=>{if("LINK"===t.tagName){let n=e.createElement("link");n.rel=t.getAttribute("rel")||"",n.href=t.getAttribute("href")||"",n.crossOrigin=t.getAttribute("crossorigin")||"",e.head.appendChild(n)}})}},75454:(e,t,n)=>{n.d(t,{Ad:()=>o,OO:()=>i,YF:()=>l,i7:()=>r}),n(38012);var s=n(69921),a=n(40965);let l=(e,t,n,l)=>{let i=t.join(a.Zk);if((0,s.hx)()&&!(0,s.xx)())e.push("/reader/".concat(i).concat(n?"?".concat(n):""),l);else{let t=new URLSearchParams(n||"");t.set("ids",i),e.push("/reader?".concat(t.toString()),l)}},i=e=>{let t=window.location.pathname,n=window.location.search;e.push("/auth?redirect=".concat(encodeURIComponent("/auth"!==t?t+n:"/")))},o=e=>{e.push("/user")},r=(e,t,n)=>{e.push("/library".concat(t?"?".concat(t):""),n)}},77553:(e,t,n)=>{n.d(t,{A:()=>d});var s=n(62574),a=n(3073),l=n(84574),i=n(57597),o=n(29353),r=n(69921);let c=e=>{let{onClick:t,ariaLabel:n,id:a,children:l}=e;return(0,s.jsx)("button",{id:a,onClick:t,className:"window-button text-base-content/85 hover:text-base-content","aria-label":n,children:l})},d=e=>{let{className:t,headerRef:d,showMinimize:u=!0,showMaximize:f=!0,showClose:m=!0,onMinimize:h,onToggleMaximize:w,onClose:p}=e,x=(0,l.useRef)(null),{appService:g}=(0,i.D)(),b=async e=>{let t=e.target;if(t.closest(".btn")||t.closest(".window-button")||t.closest(".dropdown-container")||t.closest(".exclude-title-bar-mousedown"))return;let{getCurrentWindow:s}=await Promise.resolve().then(n.bind(n,88330));1===e.buttons&&(2===e.detail?s().toggleMaximize():s().startDragging())};(0,l.useEffect)(()=>{if(!(0,r.uO)())return;let e=null==d?void 0:d.current;return null==e||e.addEventListener("mousedown",b),()=>{null==e||e.removeEventListener("mousedown",b)}},[]);let v=async()=>{h?h():(0,o.u5)()},y=async()=>{w?w():(0,o.YF)()},j=async()=>{p?p():(0,o.wm)()};return(0,s.jsxs)("div",{ref:x,className:(0,a.A)("window-buttons flex h-8 items-center justify-end space-x-2",m||f||u?"visible":"hidden",t),children:[u&&(null==g?void 0:g.hasWindowBar)&&(0,s.jsx)(c,{onClick:v,ariaLabel:"Minimize",id:"titlebar-minimize",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{fill:"currentColor",d:"M20 14H4v-2h16"})})}),f&&(null==g?void 0:g.hasWindowBar)&&(0,s.jsx)(c,{onClick:y,ariaLabel:"Maximize/Restore",id:"titlebar-maximize",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{fill:"currentColor",d:"M4 4h16v16H4zm2 4v10h12V8z"})})}),m&&((null==g?void 0:g.hasWindowBar)||p)&&(0,s.jsx)(c,{onClick:j,ariaLabel:"Close",id:"titlebar-close",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{fill:"currentColor",d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"})})})]})}},89412:(e,t,n)=>{n.d(t,{A:()=>i});var s=n(62574),a=n(3073);n(84574);var l=n(78549);let i=e=>{let{title:t,message:n,onCancel:i,onConfirm:o}=e,r=(0,l.B)();return(0,s.jsx)("div",{className:(0,a.A)("z-[100] flex justify-center px-4"),children:(0,s.jsxs)("div",{role:"alert",className:(0,a.A)("alert flex items-center justify-between","bg-base-300 rounded-lg border-none p-4 shadow-2xl","w-full max-w-[90vw] sm:max-w-[70vw] md:max-w-[50vw] lg:max-w-[40vw] xl:max-w-[40vw]","min-w-[70vw] flex-col sm:min-w-[40vw] sm:flex-row"),children:[(0,s.jsxs)("div",{className:"labels flex items-center space-x-2 self-start sm:space-x-4 sm:self-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-info h-6 w-6 shrink-0",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)("h3",{className:"text-start text-sm sm:text-center",children:t}),(0,s.jsx)("div",{className:"text-start text-xs sm:text-center",children:n})]})]}),(0,s.jsxs)("div",{className:"buttons flex flex-wrap items-center justify-end gap-2 self-end sm:max-w-[20vw] sm:self-center",children:[(0,s.jsx)("button",{className:"btn btn-sm btn-neutral",onClick:i,children:r("Cancel")}),(0,s.jsx)("button",{className:"btn btn-sm btn-warning",onClick:o,children:r("Confirm")})]})]})})}},99613:(e,t,n)=>{n.d(t,{A:()=>w});var s=n(62574),a=n(3073),l=n(84574),i=n(90045),o=n(57597),r=n(20517),c=n(78549),d=n(58529),u=n(89412),f=n(64466),m=n(72645),h=n(25538);let w=e=>{let{book:t,isOpen:n,onClose:w,handleBookDownload:p,handleBookUpload:x,handleBookDelete:g}=e,b=(0,c.B)(),[v,y]=(0,l.useState)(!1),[j,N]=(0,l.useState)(!1),[k,S]=(0,l.useState)(null),[C,A]=(0,l.useState)(null),{envConfig:L}=(0,o.D)(),{settings:E}=(0,r.C)();(0,l.useEffect)(()=>{let e=setTimeout(()=>y(!0),300);(async()=>{let n=await L.getAppService();try{let e=await n.fetchBookDetails(t,E),s=await n.getBookFileSize(t);S(e),A(s)}finally{e&&clearTimeout(e),y(!1)}})()},[t]);let T=()=>{S(null),w()},D=async()=>{T(),N(!1),g&&g(t)},W=async()=>{T(),p&&p(t)},O=async()=>{T(),x&&x(t)};return k?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,s.jsx)(f.A,{title:b("Book Details"),isOpen:n,onClose:T,bgClassName:"sm:bg-black/50",boxClassName:"sm:min-w-[480px] sm:max-w-[480px] sm:h-auto sm:max-h-[90%]",contentClassName:"!px-6 !py-2",children:(0,s.jsx)("div",{className:"flex w-full select-text items-center justify-center",children:(0,s.jsxs)("div",{className:"relative w-full rounded-lg",children:[(0,s.jsxs)("div",{className:"mb-6 me-4 flex h-32 items-start",children:[(0,s.jsx)("div",{className:"me-10 aspect-[28/41] h-32 shadow-lg",children:(0,s.jsx)(h.A,{mode:"list",book:t})}),(0,s.jsxs)("div",{className:"title-author flex h-32 flex-col justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-base-content mb-2 line-clamp-2 break-all text-lg font-bold",children:(0,d.Ef)(t.title)||b("Untitled")}),(0,s.jsx)("p",{className:"text-neutral-content line-clamp-1",children:(0,d.kY)(t.author,t.primaryLanguage)||b("Unknown")})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-x-4",children:[g&&(0,s.jsx)("button",{onClick:()=>{N(!0)},children:(0,s.jsx)(i.b6i,{className:"fill-red-500"})}),t.uploadedAt&&p&&(0,s.jsx)("button",{onClick:W,children:(0,s.jsx)(i.$no,{className:"fill-base-content"})}),t.downloadedAt&&x&&(0,s.jsx)("button",{onClick:O,children:(0,s.jsx)(i.E10,{className:"fill-base-content"})})]})]})]}),(0,s.jsxs)("div",{className:"text-base-content my-4",children:[(0,s.jsxs)("div",{className:"mb-4 grid grid-cols-2 gap-4 sm:grid-cols-3",children:[(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:b("Publisher:")}),(0,s.jsx)("p",{className:"text-neutral-content text-sm",children:(0,d.ud)(k.publisher||"")||b("Unknown")})]}),(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:b("Published:")}),(0,s.jsx)("p",{className:"text-neutral-content text-sm",children:(0,d.Yq)(k.published)||b("Unknown")})]}),(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:b("Updated:")}),(0,s.jsx)("p",{className:"text-neutral-content text-sm",children:(0,d.Yq)(t.updatedAt)||""})]}),(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:b("Added:")}),(0,s.jsx)("p",{className:"text-neutral-content text-sm",children:(0,d.Yq)(t.createdAt)||""})]}),(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:b("Language:")}),(0,s.jsx)("p",{className:"text-neutral-content text-sm",children:(0,d.qq)(k.language)||b("Unknown")})]}),(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:b("Subjects:")}),(0,s.jsx)("p",{className:"text-neutral-content line-clamp-3 text-sm",children:(0,d.QK)(k.subject)||b("Unknown")})]}),(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:b("Format:")}),(0,s.jsx)("p",{className:"text-neutral-content text-sm",children:t.format||b("Unknown")})]}),(0,s.jsxs)("div",{className:"overflow-hidden",children:[(0,s.jsx)("span",{className:"font-bold",children:b("File Size:")}),(0,s.jsx)("p",{className:"text-neutral-content text-sm",children:(0,d.v7)(C)||b("Unknown")})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-bold",children:b("Description:")}),(0,s.jsx)("p",{className:"text-neutral-content text-sm prose prose-sm",dangerouslySetInnerHTML:{__html:k.description||b("No description available")}})]})]})]})})}),j&&(0,s.jsx)("div",{className:(0,a.A)("fixed bottom-0 left-0 right-0 z-50 flex justify-center","pb-[calc(env(safe-area-inset-bottom)+16px)]"),children:(0,s.jsx)(u.A,{title:b("Confirm Deletion"),message:b("Are you sure to delete the selected book?"),onCancel:()=>{N(!1)},onConfirm:D})})]}):v&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:(0,s.jsx)(m.A,{loading:!0})})}}}]);