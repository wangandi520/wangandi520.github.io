"use strict";(self["webpackChunksave_file_converter"]=self["webpackChunksave_file_converter"]||[]).push([[945],{1945:function(e,t,n){n.d(t,{Z:function(){return Wn}});var r=n(7327),o=(n(3408),n(4590),n(3462),n(3767),n(8585),n(8696),n(7658),n(3313)),a=n(9698);function i(e){return function(){return e}}var s=i;function u(e){return function(t,n,r){var o=-1,a=Object(t),i=r(t),s=i.length;while(s--){var u=i[e?s:++o];if(!1===n(a[u],u,a))break}return t}}var c=u,l=c(),f=l;function h(e,t){var n=-1,r=Array(e);while(++n<e)r[n]=t(n);return r}var p=h,g="object"==typeof global&&global&&global.Object===Object&&global,b=g,y="object"==typeof self&&self&&self.Object===Object&&self,m=b||y||Function("return this")(),d=m,w=d.Symbol,A=w,E=Object.prototype,v=E.hasOwnProperty,S=E.toString,C=A?A.toStringTag:void 0;function j(e){var t=v.call(e,C),n=e[C];try{e[C]=void 0;var r=!0}catch(a){}var o=S.call(e);return r&&(t?e[C]=n:delete e[C]),o}var x=j,N=Object.prototype,O=N.toString;function _(e){return O.call(e)}var U=_,B="[object Null]",D="[object Undefined]",F=A?A.toStringTag:void 0;function L(e){return null==e?void 0===e?D:B:F&&F in Object(e)?x(e):U(e)}var R=L;function $(e){return null!=e&&"object"==typeof e}var X=$,Z="[object Arguments]";function T(e){return X(e)&&R(e)==Z}var P=T,k=Object.prototype,I=k.hasOwnProperty,V=k.propertyIsEnumerable,G=P(function(){return arguments}())?P:function(e){return X(e)&&I.call(e,"callee")&&!V.call(e,"callee")},M=G,K=Array.isArray,W=K;function H(){return!1}var z=H,Y="object"==typeof exports&&exports&&!exports.nodeType&&exports,q=Y&&"object"==typeof module&&module&&!module.nodeType&&module,J=q&&q.exports===Y,Q=J?d.Buffer:void 0,ee=Q?Q.isBuffer:void 0,te=ee||z,ne=te,re=9007199254740991,oe=/^(?:0|[1-9]\d*)$/;function ae(e,t){var n=typeof e;return t=null==t?re:t,!!t&&("number"==n||"symbol"!=n&&oe.test(e))&&e>-1&&e%1==0&&e<t}var ie=ae,se=9007199254740991;function ue(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=se}var ce=ue,le="[object Arguments]",fe="[object Array]",he="[object Boolean]",pe="[object Date]",ge="[object Error]",be="[object Function]",ye="[object Map]",me="[object Number]",de="[object Object]",we="[object RegExp]",Ae="[object Set]",Ee="[object String]",ve="[object WeakMap]",Se="[object ArrayBuffer]",Ce="[object DataView]",je="[object Float32Array]",xe="[object Float64Array]",Ne="[object Int8Array]",Oe="[object Int16Array]",_e="[object Int32Array]",Ue="[object Uint8Array]",Be="[object Uint8ClampedArray]",De="[object Uint16Array]",Fe="[object Uint32Array]",Le={};function Re(e){return X(e)&&ce(e.length)&&!!Le[R(e)]}Le[je]=Le[xe]=Le[Ne]=Le[Oe]=Le[_e]=Le[Ue]=Le[Be]=Le[De]=Le[Fe]=!0,Le[le]=Le[fe]=Le[Se]=Le[he]=Le[Ce]=Le[pe]=Le[ge]=Le[be]=Le[ye]=Le[me]=Le[de]=Le[we]=Le[Ae]=Le[Ee]=Le[ve]=!1;var $e=Re;function Xe(e){return function(t){return e(t)}}var Ze=Xe,Te="object"==typeof exports&&exports&&!exports.nodeType&&exports,Pe=Te&&"object"==typeof module&&module&&!module.nodeType&&module,ke=Pe&&Pe.exports===Te,Ie=ke&&b.process,Ve=function(){try{var e=Pe&&Pe.require&&Pe.require("util").types;return e||Ie&&Ie.binding&&Ie.binding("util")}catch(t){}}(),Ge=Ve,Me=Ge&&Ge.isTypedArray,Ke=Me?Ze(Me):$e,We=Ke,He=Object.prototype,ze=He.hasOwnProperty;function Ye(e,t){var n=W(e),r=!n&&M(e),o=!n&&!r&&ne(e),a=!n&&!r&&!o&&We(e),i=n||r||o||a,s=i?p(e.length,String):[],u=s.length;for(var c in e)!t&&!ze.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ie(c,u))||s.push(c);return s}var qe=Ye,Je=Object.prototype;function Qe(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||Je;return e===n}var et=Qe;function tt(e,t){return function(n){return e(t(n))}}var nt=tt,rt=nt(Object.keys,Object),ot=rt,at=Object.prototype,it=at.hasOwnProperty;function st(e){if(!et(e))return ot(e);var t=[];for(var n in Object(e))it.call(e,n)&&"constructor"!=n&&t.push(n);return t}var ut=st;function ct(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var lt=ct,ft="[object AsyncFunction]",ht="[object Function]",pt="[object GeneratorFunction]",gt="[object Proxy]";function bt(e){if(!lt(e))return!1;var t=R(e);return t==ht||t==pt||t==ft||t==gt}var yt=bt;function mt(e){return null!=e&&ce(e.length)&&!yt(e)}var dt=mt;function wt(e){return dt(e)?qe(e):ut(e)}var At=wt;function Et(e,t){return e&&f(e,t,At)}var vt=Et;function St(e,t,n,r){return vt(e,(function(e,o,a){t(r,n(e),o,a)})),r}var Ct=St;function jt(e,t){return function(n,r){return Ct(n,e,t(r),{})}}var xt=jt;function Nt(e){return e}var Ot=Nt,_t=Object.prototype,Ut=_t.toString,Bt=xt((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ut.call(t)),e[t]=n}),s(Ot)),Dt=Bt;const Ft={0:"",15:" ",16:"0",17:"1",18:"2",19:"3",20:"4",21:"5",22:"6",23:"7",24:"8",25:"9",26:"A",27:"B",28:"C",29:"D",30:"E",31:"F",32:"G",33:"H",34:"I",35:"J",36:"K",37:"L",38:"M",39:"N",40:"O",41:"P",42:"Q",43:"R",44:"S",45:"T",46:"U",47:"V",48:"W",49:"X",50:"Y",51:"Z",52:"!",53:'"',54:"#",55:"'",56:"*",57:"+",58:",",59:"-",60:".",61:"/",62:":",63:"=",64:"?",65:"@",66:"。",67:"゛",68:"゜",69:"ァ",70:"ィ",71:"ゥ",72:"ェ",73:"ォ",74:"ッ",75:"ャ",76:"ュ",77:"ョ",78:"ヲ",79:"ン",80:"ア",81:"イ",82:"ウ",83:"エ",84:"オ",85:"カ",86:"キ",87:"ク",88:"ケ",89:"コ",90:"サ",91:"シ",92:"ス",93:"セ",94:"ソ",95:"タ",96:"チ",97:"ツ",98:"テ",99:"ト",100:"ナ",101:"ニ",102:"ヌ",103:"ネ",104:"ノ",105:"ハ",106:"ヒ",107:"フ",108:"ヘ",109:"ホ",110:"マ",111:"ミ",112:"ム",113:"メ",114:"モ",115:"ヤ",116:"ユ",117:"ヨ",118:"ラ",119:"リ",120:"ル",121:"レ",122:"ロ",123:"ワ",124:"ガ",125:"ギ",126:"グ",127:"ゲ",128:"ゴ",129:"ザ",130:"ジ",131:"ズ",132:"ゼ",133:"ゾ",134:"ダ",135:"ヂ",136:"ヅ",137:"デ",138:"ド",139:"バ",140:"ビ",141:"ブ",142:"ベ",143:"ボ",144:"パ",145:"ピ",146:"プ",147:"ペ",148:"ポ"},Lt=Dt(Ft);class Rt{static decode(e){let t="";for(let n=0;n<e.length;n+=1){const r=Ft[e[n]];t+=r||""}return t}static encode(e,t){const n=new Uint8Array(t);n.fill(0);for(let r=0;r<Math.min(e.length,t);r+=1){const t=e.charAt(r);n[r]=t in Lt?Lt[t]:0}return n}}var $t=n(8764)["Buffer"];const Xt=!1,Zt=16,Tt=128,Pt=256,kt=0,It=1,Vt=2,Gt=[3,4],Mt=5,Kt=(Tt-Mt)*Pt,Wt=32,Ht=[32,96,128,192],zt=28,Yt=25,qt=26,Jt=28,Qt=30,en=1,tn=1,nn=32,rn=0,on=4,an=4,sn=2,un=6,cn=8,ln=2,fn=10,hn=12,pn=4,gn=16,bn=16,yn=1,mn=3,dn=0,wn=3,An="utf8",En=[512,2048],vn={A:"All regions",B:"Brazil",C:"China",D:"Germany",E:"North America",F:"France",G:"Gateway 64 (NTSC)",H:"Netherlands",I:"Italy",J:"Japan",K:"South Korea",L:"Gateway 64 (PAL)",P:"Europe",R:"Russia",S:"Spain",U:"Australia",W:"Taiwan",X:"Europe",Y:"Europe",Z:"Europe"},Sn=";­Ñå",Cn="úÞ",jn="Þ­¾ï",xn="4";function Nn(e,t){const n=e*Pt;return t.slice(n,n+Pt)}function On(e,t){const n=e.map((e=>Nn(e,t)));return o.Z.concatArrayBuffers(n)}function _n(e,t){return e.getUint16(2*t,Xt)}function Un(e,t,n){e.setUint16(2*t,n,Xt)}function Bn(e){return o.Z.getFilledArrayBuffer(e,0)}function Dn(e){if(!Wn.isCartSave(e))return e;for(let t=0;t<En.length;t+=1){if(En[t]===e.rawData.byteLength)return e;if(En[t]>e.rawData.byteLength){let n=e.rawData;while(n.byteLength<En[t])n=o.Z.concatArrayBuffers([n,Bn(Pt)]);return{...e,rawData:n}}}return e}function Fn(e){const t=e.slice(),n=e.reduce(((e,t)=>e+t));return 0===n&&(t[t.length-1]|=1),{stringCode:String.fromCharCode(...e),stringCodeFixup:String.fromCharCode(...t).replace(/\0/g,"-")}}function Ln(e,t){const n=new Uint8Array(t);n.fill(0);for(let r=0;r<e.length;r+=1){const t=e.charCodeAt(r);n[r]=t<=255?t:0}return n}function Rn(e){const t=new DataView(e);let n=0,r=65522;for(let o=0;o<zt;o+=2)n+=t.getUint16(o,Xt),n&=65535;return r-=n,{sumA:n,sumB:r}}function $n(e){let t=!1;const n=new DataView(e);if(Ht.forEach((r=>{const o=e.slice(r,r+Wt),{sumA:a,sumB:i}=Rn(o),s=n.getUint16(r+Jt,Xt);let u=n.getUint16(r+Qt,Xt);u!==i&&(12^u)===i&&s===a&&(u^=12),t=t||s===a&&u===i})),!t)throw new Error("File appears to be corrupt - checksums in ID Area do not match")}function Xn(e=null){const t=null!==e?e:Math.random;return 0|256*t()}function Zn(e=null){const t=new ArrayBuffer(Wt),n=new DataView(t);n.setUint8(1,63&Xn(e)),n.setUint8(5,7&Xn(e)),n.setUint8(6,Xn(e)),n.setUint8(7,Xn(e)),n.setUint8(8,15&Xn(e)),n.setUint8(9,Xn(e)),n.setUint8(10,Xn(e)),n.setUint8(11,Xn(e)),n.setUint8(Yt,en),n.setUint8(qt,tn);const{sumA:r,sumB:a}=Rn(t);n.setUint16(Jt,r,Xt),n.setUint16(Qt,a,Xt);let i=new ArrayBuffer(Pt);return i=o.Z.fillArrayBuffer(i,0),Ht.forEach((e=>{i=o.Z.setArrayBufferPortion(i,t,e,0,Wt)})),i}function Tn(e){return e.charAt(wn)}function Pn(e){return e.charAt(dn)}function kn(e){const t=Tn(e);return t in vn?vn[t]:"Unknown region"}function In(e,t){const n=[],r=[],o=new Uint8Array(t),a=new DataView(t),i=new DataView(e);for(let s=0;s<t.byteLength;s+=nn){const e=s/nn,t=a.getUint16(s+un,Xt),u=_n(i,t),c=t>=Mt&&t<Tt,l=0===a.getUint16(s+fn,Xt),f=u===yn||u>=Mt&&u<Tt;if(c&&l&&f){n.push(t);const a=o.slice(s+rn,s+rn+on),i=o.slice(s+an,s+an+sn),{stringCode:u,stringCodeFixup:c}=Fn(a),{stringCode:l,stringCodeFixup:f}=Fn(i),h=Rt.decode(o.slice(s+gn,s+gn+bn)),p=Rt.decode(o.slice(s+hn,s+hn+pn));r.push({noteIndex:e,startingPage:t,gameSerialCode:u,gameSerialCodeFixup:c,publisherCode:l,publisherCodeFixup:f,noteName:h,noteNameExtension:p,region:Tn(u),regionName:kn(u),media:Pn(u)})}}return{noteKeys:n,notes:r}}function Vn(e){const t=e.map((e=>{const t=Bn(nn),n=new DataView(t),r=new Uint8Array(t),o=Rt.encode(e.noteName,bn),a=Rt.encode(e.noteNameExtension,pn),i=Ln(e.gameSerialCode,on),s=Ln(e.publisherCode,sn);return r.set(i,rn),r.set(s,an),n.setUint16(un,e.startingPage,Xt),r[cn]=ln,r.set(o,gn),r.set(a,hn),t}));while(t.length<Zt)t.push(Bn(nn));return o.Z.concatArrayBuffers(t)}function Gn(e,t){const n=new DataView(e),r={parsed:[],empty:[],stops:[],keys:[],values:[],duplicates:{}};for(let i=Mt;i<Tt;i+=1){const e=_n(n,i);if(e===yn)r.stops.push(i),r.keys.push(i);else if(e===mn)r.empty.push(i);else{if(!(e>=Mt&&e<Tt))throw new Error(`Inode table contains illegal value: ${e} at page ${i}`);if(r.duplicates[e])throw new Error(`Found duplicate entries in inode table. Both ${r.duplicates[e]} and ${i} point to page ${e}`);r.values.push(e),r.keys.push(i),r.duplicates[e]=i}}const o=r.keys.filter((e=>!r.values.includes(e)));if(t.length!==o.length||t.length!==r.stops.length)throw new Error(`Found ${t.length} starting keys in the note table, but found ${o.length} starting keys and ${r.stops.length} stop keys in inode table`);o.forEach((e=>{if(!t.includes(e))throw new Error(`Found start key ${e} in inode table which doesn't exist in note table`)}));const a={};if(o.forEach((e=>{const t=[e];let o=e,i=_n(n,o);while(i!==yn)t.push(i),o=i,i=_n(n,o);a[e]=t,r.parsed.push(...t)})),r.parsed.length!==r.keys.length)throw new Error(`We encountered ${r.parsed.length} keys when following the various index sequences, but found ${r.keys.length} keys when looking through the entire inode table.`);return a}function Mn(e){let t=new ArrayBuffer(Pt);const n=[];t=o.Z.fillArrayBuffer(t,0);const r=new DataView(t);let a=Mt;e.forEach((e=>{n.push(a);for(let t=0;t<e.rawData.byteLength-Pt;t+=Pt)Un(r,a,a+1),a+=1;Un(r,a,yn),a+=1}));while(a<Tt)Un(r,a,mn),a+=1;return{inodeTablePage:t,startingPages:n}}function Kn(e){const t=e.split(".");let n=e,r="";return 2===t.length&&([n,r]=t),{noteName:n,noteNameExtension:r}}class Wn{static createFromN64MempackData(e){return new Wn(e)}static createFromSaveFiles(e,t=null){if(e.length>Zt)throw new Error(`Found ${e.length} notes, but max is ${Zt}`);const n=e.reduce(((e,t)=>e+t.rawData.byteLength));if(n>Kt)throw new Error(`Total size of notes is ${n} bytes, but max is ${Kt}`);e.forEach((e=>{if(0===e.rawData.byteLength)throw new Error(`Save file ${e.noteNate} does not contain any data`);if(e.rawData.byteLength%Pt!==0)throw new Error(`All saves must be multiples of ${Pt} bytes, but save '${Wn.getDisplayName(e)}' is ${e.rawData.byteLength} bytes`)}));const r=Zn(t),{inodeTablePage:a,startingPages:i}=Mn(e),s=e.map(((e,t)=>({...e,startingPage:i[t]}))),u=Vn(s);let c=o.Z.concatArrayBuffers(e.map((e=>e.rawData)));while(c.byteLength<Kt)c=o.Z.concatArrayBuffers([c,Bn(Pt)]);const l=o.Z.concatArrayBuffers([r,a,a,u,c]);return new Wn(l)}constructor(e){this.arrayBuffer=e,$n(Nn(kt,e));const t=Nn(It,e),n=Nn(Vt,e),r=On(Gt,e),o=In(t,r);let a={};try{a=Gn(t,o.noteKeys)}catch(s){try{a=Gn(n,o.noteKeys)}catch(u){throw new Error("Both primary and backup inode tables appear to be corrupted. Error from backup table follows",{cause:u})}}const i=o.notes.map((t=>({...t,pageNumbers:a[t.startingPage],rawData:On(a[t.startingPage],e)})));this.saveFiles=i.map((e=>Dn(e)))}getSaveFiles(){return this.saveFiles}static isCartSave(e){return e.gameSerialCode===Sn||e.gameSerialCode===jn}static getDisplayName(e){return e.noteNameExtension.length>0?`${e.noteName}.${e.noteNameExtension}`:e.noteName}static createFilename(e){if(Wn.isCartSave(e))return`${Wn.getDisplayName(e)}.${a.Z.getFileExtension(e.rawData)}`;const t=$t.from(e.noteName,An).toString("hex"),n=$t.from(e.noteNameExtension,An).toString("hex"),r=$t.from(e.gameSerialCode,An).toString("hex"),o=$t.from(e.publisherCode,An).toString("hex");return`RAW-${t}-${n}-${r}-${o}`}static parseFilename(e){if(!e.startsWith("RAW-")){const t=o.Z.removeFilenameExtension(e).trim().toUpperCase(),{noteName:n,noteNameExtension:r}=Kn(t);return{noteName:n,noteNameExtension:r,gameSerialCode:Sn,publisherCode:Cn}}{const n=e.split("-");try{if(4===n.length){const e=$t.from(n[1],"hex").toString(An),t=$t.from(n[2],"hex").toString(An),r=$t.from(n[3],"hex").toString(An),{noteName:o,noteNameExtension:a}=Kn(e);return{noteName:o,noteNameExtension:a,gameSerialCode:t,publisherCode:r}}if(5===n.length){const e=$t.from(n[1],"hex").toString(An),t=$t.from(n[2],"hex").toString(An),r=$t.from(n[3],"hex").toString(An),o=$t.from(n[4],"hex").toString(An);return{noteName:e,noteNameExtension:t,gameSerialCode:r,publisherCode:o}}throw new Error("Wrong number of parts in filename")}catch(t){throw new Error("Filename not in correct format. Format should be 'RAW-XXXX-XXXX-XXXX' or 'RAW-XXXX-XXXX-XXXX-XXXX'")}}}getArrayBuffer(){return this.arrayBuffer}}(0,r.Z)(Wn,"NUM_NOTES",Zt),(0,r.Z)(Wn,"TOTAL_SIZE",Tt*Pt),(0,r.Z)(Wn,"GAMESHARK_ACTIONREPLAY_CART_SAVE_GAME_SERIAL_CODE",Sn),(0,r.Z)(Wn,"GAMESHARK_ACTIONREPLAY_CART_SAVE_PUBLISHER_CODE",Cn),(0,r.Z)(Wn,"GAMESHARK_ACTIONREPLAY_CART_SAVE_REGION_CODE",Tn(Sn)),(0,r.Z)(Wn,"GAMESHARK_ACTIONREPLAY_CART_SAVE_MEDIA_CODE",Pn(Sn)),(0,r.Z)(Wn,"BLACKBAG_CART_SAVE_GAME_SERIAL_CODE",jn),(0,r.Z)(Wn,"BLACKBAG_CART_SAVE_PUBLISHER_CODE",xn),(0,r.Z)(Wn,"BLACKBAG_CART_SAVE_REGION_CODE",Tn(jn)),(0,r.Z)(Wn,"BLACKBAG_CART_SAVE_MEDIA_CODE",Pn(jn))},6676:function(e,t,n){function r(e,t){for(let n=0;n<e.byteLength/2;n+=1){const r=e.getUint16(2*n,!0);t.setUint16(2*n,r,!1)}}function o(e,t){for(let n=0;n<e.byteLength/4;n+=1){const r=e.getUint32(4*n,!0);t.setUint32(4*n,r,!1)}}function a(e,t){for(let n=0;n<e.byteLength/8;n+=1){const r=e.getBigUint64(8*n,!0);t.setBigUint64(8*n,r,!1)}}n.d(t,{Z:function(){return s}});const i={2:r,4:o,8:a};class s{static swap(e,t){if(e.byteLength%t!==0)throw new Error(`File length must be a multiple of ${t} bytes`);if(!(t in i))throw new Error(`Word size must be one of ${Object.keys(i).join(", ")}`);const n=new ArrayBuffer(e.byteLength),r=new DataView(e),o=new DataView(n);return i[t](r,o),n}}},9698:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(6676);const o=[512,2048],a=[32768],i=[131072],s=4;class u{static needsEndianSwap(e){return!u.isEepromSave(e)}static isEepromSave(e){return o.indexOf(e.byteLength)>=0}static isSramSave(e){return a.indexOf(e.byteLength)>=0}static isFlashRamSave(e){return i.indexOf(e.byteLength)>=0}static getFileExtension(e){if(u.isEepromSave(e))return"eep";if(u.isSramSave(e))return"sra";if(u.isFlashRamSave(e))return"fla";throw new Error(`Unrecognized N64 file size: ${e.byteLength} bytes`)}static endianSwap(e){if(e.byteLength%s!==0)throw new Error(`N64 file size must be a multiple of ${s} bytes`);return r.Z.swap(e,s)}}},7327:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function a(e){var t=o(e,"string");return"symbol"===r(t)?t:String(t)}function i(e,t,n){return t=a(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return i}})}}]);