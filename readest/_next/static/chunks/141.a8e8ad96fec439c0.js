"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[141],{80141:(t,e,i)=>{i.r(e),i.d(e,{Paginator:()=>tR});var n=i(96261),s=i(89657),a=i(49033),l=i(19780),r=i(25842),h=i(84648);let o=t=>new Promise(e=>setTimeout(e,t)),c=(t,e,i)=>{let n;return function(){for(var s=arguments.length,a=Array(s),l=0;l<s;l++)a[l]=arguments[l];let r=i&&!n;n&&clearTimeout(n),n=setTimeout(()=>{n=null,i||t(...a)},e),r&&t(...a)}},d=(t,e,i)=>i*(e-t)+t,u=t=>1-(1-t)*(1-t),_=(t,e,i,n,s)=>new Promise(a=>{let l,r=h=>{null!=l||(l=h);let o=Math.min(1,(h-l)/i);s(d(t,e,n(o))),o<1?requestAnimationFrame(r):a()};requestAnimationFrame(r)}),p=t=>{if(!(null==t?void 0:t.collapsed))return t;let{endOffset:e,endContainer:i}=t;if(1===i.nodeType){let t=i.childNodes[e];return(null==t?void 0:t.nodeType)===1?t:i}if(e+1<i.length)t.setEnd(i,e+1);else{if(!(e>1))return i.parentNode;t.setStart(i,e-1)}return t},m=function(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i,s=t.createRange();return s.setStart(e,i),s.setEnd(e,n),s},g=function(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.nodeValue.length;if(s-n==1)return 0>i(m(t,e,n),m(t,e,s))?n:s;let a=Math.floor(n+(s-n)/2),l=i(m(t,e,n,a),m(t,e,a,s));return l<0?g(t,e,i,n,a):l>0?g(t,e,i,a,s):a},{SHOW_ELEMENT:v,SHOW_TEXT:f,SHOW_CDATA_SECTION:w,FILTER_ACCEPT:b,FILTER_REJECT:y,FILTER_SKIP:x}=NodeFilter,k=v|f|w,M=t=>{let e=1/0,i=-1/0,n=1/0,s=-1/0;for(let a of t.getClientRects())n=Math.min(n,a.left),e=Math.min(e,a.top),i=Math.max(i,a.right),s=Math.max(s,a.bottom);return new DOMRect(n,e,i-n,s-e)},E=(t,e,i,n)=>{var s,a;let l=t.createTreeWalker(t.body,k,{acceptNode:s=>{var a,l;let r=null==(a=s.localName)?void 0:a.toLowerCase();if("script"===r||"style"===r)return y;if(1===s.nodeType){let{left:t,right:a}=n(s.getBoundingClientRect());if(a<e||t>i)return y;if(t>=e&&a<=i)return b}else{if(!(null==(l=s.nodeValue)?void 0:l.trim()))return x;let a=t.createRange();a.selectNodeContents(s);let{left:r,right:h}=n(a.getBoundingClientRect());if(h>=e&&r<=i)return b}return x}}),r=[];for(let t=l.nextNode();t;t=l.nextNode())r.push(t);let h=null!=(s=r[0])?s:t.body,o=null!=(a=r[r.length-1])?a:h,c=1===h.nodeType?0:g(t,h,(t,i)=>{let s=n(M(t)),a=n(M(i));return s.right<e&&a.left>e?0:a.left>e?-1:1}),d=1===o.nodeType?0:g(t,o,(t,e)=>{let s=n(M(t)),a=n(M(e));return s.right<i&&a.left>i?0:a.left>i?-1:1}),u=t.createRange();return u.setStart(h,c),u.setEnd(o,d),u},S=t=>{let e=document.createRange();return e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset),e.collapsed},W=(t,e)=>{let i;if(t.startContainer?i=t.cloneRange():t.nodeType&&(i=document.createRange()).selectNode(t),i){let t=i.startContainer.ownerDocument.defaultView.getSelection();t&&(t.removeAllRanges(),-1===e?i.collapse(!0):1===e&&i.collapse(),t.addRange(i))}},C=t=>{let{defaultView:e}=t,{writingMode:i,direction:n}=e.getComputedStyle(t.body);return{vertical:"vertical-rl"===i||"vertical-lr"===i,rtl:"rtl"===t.body.dir||"rtl"===n||"rtl"===t.documentElement.dir}},z=t=>{let e=t.defaultView.getComputedStyle(t.body);return"rgba(0, 0, 0, 0)"===e.backgroundColor&&"none"===e.backgroundImage?t.defaultView.getComputedStyle(t.documentElement).background:e.background},T=(t,e)=>Array.from({length:t},()=>{let t=document.createElement("div"),i=document.createElement("div");return t.append(i),i.setAttribute("part",e),t}),P=(t,e)=>{let{style:i}=t;for(let[t,n]of Object.entries(e))i.setProperty(t,n,"important")};var R=new WeakMap,A=new WeakMap,L=new WeakMap,B=new WeakMap,N=new WeakMap,V=new WeakMap,I=new WeakMap,F=new WeakMap,O=new WeakMap,D=new WeakMap;class j{get element(){return(0,n._)(this,A)}get document(){return(0,n._)(this,L).contentDocument}async load(t,e,i,s){if("string"!=typeof t)throw Error("".concat(t," is not string"));return new Promise(l=>{(0,n._)(this,L).addEventListener("load",()=>{let t=this.document;null==i||i(t),(0,n._)(this,L).style.display="block";let{vertical:e,rtl:r}=C(t);this.docBackground=z(t),t.body.style.background="none";let h=this.docBackground;(0,n._)(this,L).style.display="none",(0,a._)(this,V,e),(0,a._)(this,I,r),(0,n._)(this,B).selectNodeContents(t.body);let o=null==s?void 0:s({vertical:e,rtl:r,background:h});(0,n._)(this,L).style.display="block",this.render(o),(0,n._)(this,R).observe(t.body),t.fonts.ready.then(()=>this.expand()),l()},{once:!0}),e?(0,n._)(this,L).srcdoc=e:(0,n._)(this,L).src=t})}render(t){t&&this.document&&((0,a._)(this,F,"scrolled"!==t.flow),(0,a._)(this,D,t),(0,n._)(this,F)?this.columnize(t):this.scrolled(t))}scrolled(t){let{margin:e,gap:i,columnWidth:s}=t,a=(0,n._)(this,V),l=this.document;P(l.documentElement,{"box-sizing":"border-box",padding:a?"".concat(1.5*e,"px ").concat(i,"px"):"0 ".concat(i,"px"),"column-width":"auto",height:"auto",width:"auto"}),P(l.body,{[a?"max-height":"max-width"]:"".concat(s,"px"),margin:"auto"}),this.setImageSize(),this.expand()}columnize(t){let{width:e,height:i,margin:s,gap:l,columnWidth:r}=t,h=(0,n._)(this,V);(0,a._)(this,O,h?i:e);let o=this.document;P(o.documentElement,{"box-sizing":"border-box","column-width":"".concat(Math.trunc(r),"px"),"column-gap":h?"".concat(s,"px"):"".concat(l,"px"),"column-fill":"auto",...h?{width:"".concat(e,"px")}:{height:"".concat(i,"px")},padding:h?"".concat(s/2,"px ").concat(l,"px"):"0 ".concat(l/2,"px"),overflow:"hidden","overflow-wrap":"break-word",position:"static",border:"0",margin:"0","max-height":"none","max-width":"none","min-height":"none","min-width":"none","-webkit-line-box-contain":"block glyphs replaced"}),P(o.body,{"max-height":"none","max-width":"none",margin:"0"}),this.setImageSize(),this.expand()}setImageSize(){let{width:t,height:e,margin:i}=(0,n._)(this,D),s=(0,n._)(this,V),a=this.document;for(let n of a.body.querySelectorAll("img, svg, video")){let{maxHeight:l,maxWidth:r}=a.defaultView.getComputedStyle(n);P(n,{"max-height":s?"none"!==l&&"0px"!==l?l:"100%":"".concat(e-2*i,"px"),"max-width":s?"".concat(t-2*i,"px"):"none"!==r&&"0px"!==r?r:"100%","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"})}}expand(){let{documentElement:t}=this.document;if((0,n._)(this,F)){let e=(0,n._)(this,V)?"height":"width",i=(0,n._)(this,V)?"width":"height",s=(0,n._)(this,B).getBoundingClientRect(),a=t.getBoundingClientRect(),l=Math.ceil((((0,n._)(this,V)?0:(0,n._)(this,I)?a.right-s.right:s.left-a.left)+s[e])/(0,n._)(this,O))*(0,n._)(this,O);(0,n._)(this,A).style.padding="0",(0,n._)(this,L).style[e]="".concat(l,"px"),(0,n._)(this,A).style[e]="".concat(l+2*(0,n._)(this,O),"px"),(0,n._)(this,L).style[i]="100%",(0,n._)(this,A).style[i]="100%",t.style[e]="".concat((0,n._)(this,O),"px"),(0,n._)(this,N)&&((0,n._)(this,N).element.style.margin="0",(0,n._)(this,N).element.style.left=(0,n._)(this,V)?"0":"".concat((0,n._)(this,O),"px"),(0,n._)(this,N).element.style.top=(0,n._)(this,V)?"".concat((0,n._)(this,O),"px"):"0",(0,n._)(this,N).element.style[e]="".concat(l,"px"),(0,n._)(this,N).redraw())}else{let e=(0,n._)(this,V)?"width":"height",i=(0,n._)(this,V)?"height":"width",s=t.getBoundingClientRect()[e],{margin:a,gap:l}=(0,n._)(this,D),r=(0,n._)(this,V)?"0 ".concat(l,"px"):"".concat(a,"px 0");(0,n._)(this,A).style.padding=r,(0,n._)(this,L).style[e]="".concat(s,"px"),(0,n._)(this,A).style[e]="".concat(s,"px"),(0,n._)(this,L).style[i]="100%",(0,n._)(this,A).style[i]="100%",(0,n._)(this,N)&&((0,n._)(this,N).element.style.margin=r,(0,n._)(this,N).element.style.left="0",(0,n._)(this,N).element.style.top="0",(0,n._)(this,N).element.style[e]="".concat(s,"px"),(0,n._)(this,N).redraw())}this.onExpand()}set overlayer(t){(0,a._)(this,N,t),(0,n._)(this,A).append(t.element)}get overlayer(){return(0,n._)(this,N)}destroy(){this.document&&(0,n._)(this,R).unobserve(this.document.body)}constructor({container:t,onExpand:e}){(0,s._)(this,R,{writable:!0,value:new ResizeObserver(()=>this.expand())}),(0,s._)(this,A,{writable:!0,value:document.createElement("div")}),(0,s._)(this,L,{writable:!0,value:document.createElement("iframe")}),(0,s._)(this,B,{writable:!0,value:document.createRange()}),(0,s._)(this,N,{writable:!0,value:void 0}),(0,s._)(this,V,{writable:!0,value:!1}),(0,s._)(this,I,{writable:!0,value:!1}),(0,s._)(this,F,{writable:!0,value:!0}),(0,s._)(this,O,{writable:!0,value:void 0}),(0,s._)(this,D,{writable:!0,value:{}}),this.container=t,this.onExpand=e,(0,n._)(this,L).setAttribute("part","filter"),(0,n._)(this,A).append((0,n._)(this,L)),Object.assign((0,n._)(this,A).style,{boxSizing:"content-box",position:"relative",overflow:"hidden",flex:"0 0 auto",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),Object.assign((0,n._)(this,L).style,{overflow:"hidden",border:"0",display:"none",width:"100%",height:"100%"}),(0,n._)(this,L).setAttribute("sandbox","allow-same-origin allow-scripts"),(0,n._)(this,L).setAttribute("scrolling","no")}}var q=new WeakMap,H=new WeakMap,X=new WeakMap,Y=new WeakMap,G=new WeakMap,J=new WeakMap,K=new WeakMap,Q=new WeakMap,U=new WeakMap,Z=new WeakMap,$=new WeakMap,tt=new WeakMap,te=new WeakMap,ti=new WeakMap,tn=new WeakMap,ts=new WeakMap,ta=new WeakMap,tl=new WeakMap,tr=new WeakMap,th=new WeakMap,to=new WeakMap,tc=new WeakMap,td=new WeakMap,tu=new WeakSet,t_=new WeakSet,tp=new WeakSet,tm=new WeakSet,tg=new WeakSet,tv=new WeakSet,tf=new WeakSet,tw=new WeakSet,tb=new WeakSet,ty=new WeakSet,tx=new WeakSet,tk=new WeakSet,tM=new WeakSet,tE=new WeakSet,tS=new WeakSet,tW=new WeakSet,tC=new WeakSet,tz=new WeakSet,tT=new WeakSet,tP=new WeakSet;class tR extends HTMLElement{attributeChangedCallback(t,e,i){switch(t){case"flow":this.render();break;case"gap":case"margin":case"max-block-size":case"max-column-count":case"max-inline-size":(0,n._)(this,X).style.setProperty("--_"+t,i),this.render()}}open(t){var e;this.bookDir=t.dir,this.sections=t.sections,null==(e=t.transformTarget)||e.addEventListener("data",t=>{let{detail:e}=t;"text/css"===e.type&&(e.data=Promise.resolve(e.data).then(t=>t.replace(RegExp("(?<=[{\\s;])-epub-","gi"),"").replace(/page-break-(after|before|inside)\s*:/gi,(t,e)=>"-webkit-column-break-".concat(e,":")).replace(/break-(after|before|inside)\s*:\s*(avoid-)?page/gi,(t,e,i)=>"break-".concat(e,": ").concat(null!=i?i:"","column"))))})}render(){(0,n._)(this,Q)&&((0,n._)(this,Q).render((0,l._)(this,tp,tB).call(this,{vertical:(0,n._)(this,U),rtl:(0,n._)(this,Z),background:(0,n._)(this,Q).docBackground})),(0,l._)(this,tx,tq).call(this,(0,n._)(this,te)))}get scrolled(){return"scrolled"===this.getAttribute("flow")}get scrollProp(){let{scrolled:t}=this;return(0,n._)(this,U)?t?"scrollLeft":"scrollTop":t?"scrollTop":"scrollLeft"}get sideProp(){let{scrolled:t}=this;return(0,n._)(this,U)?t?"width":"height":t?"height":"width"}get size(){return(0,n._)(this,G).getBoundingClientRect()[this.sideProp]}get viewSize(){return(0,n._)(this,Q)&&(0,n._)(this,Q).element?(0,n._)(this,Q).element.getBoundingClientRect()[this.sideProp]:0}get start(){return Math.abs((0,n._)(this,G)[this.scrollProp])}get end(){return this.start+this.size}get page(){return Math.floor((this.start+this.end)/2/this.size)}get pages(){return Math.round(this.viewSize/this.size)}get containerPosition(){return(0,n._)(this,G)[this.scrollProp]}set containerPosition(t){(0,n._)(this,G)[this.scrollProp]=t}scrollBy(t,e){let i=(0,n._)(this,U)?e:t,[s,a,l]=(0,n._)(this,th),r=(0,n._)(this,Z);this.containerPosition=Math.max(r?s-l:s-a,Math.min(r?s+a:s+l,this.containerPosition+i))}snap(t,e){let i=(0,n._)(this,U)?e:t,[s,a,r]=(0,n._)(this,th),{start:h,end:o,pages:c,size:d}=this,u=Math.abs(s)-a,_=Math.abs(s)+r,p=i*((0,n._)(this,Z)?-d:d),m=Math.floor(Math.max(u,Math.min(_,(h+o)/2+(isNaN(p)?0:p)))/d);(0,l._)(this,ty,tj).call(this,m,"snap").then(()=>{let t=m<=0?-1:m>=c-1?1:null;if(t)return(0,l._)(this,tW,tJ).call(this,{index:(0,l._)(this,tT,tU).call(this,t),anchor:t<0?()=>1:()=>0})})}async scrollToAnchor(t,e){return(0,l._)(this,tx,tq).call(this,t,e?"selection":"navigation")}async goTo(t){if((0,n._)(this,tn))return;let e=await t;if((0,l._)(this,tS,tG).call(this,e.index))return(0,l._)(this,tW,tJ).call(this,e)}get atStart(){return null==(0,l._)(this,tT,tU).call(this,-1)&&this.page<=1}get atEnd(){return null==(0,l._)(this,tT,tU).call(this,1)&&this.page>=this.pages-2}async prev(t){return await (0,l._)(this,tP,tZ).call(this,-1,t)}async next(t){return await (0,l._)(this,tP,tZ).call(this,1,t)}prevSection(){return this.goTo({index:(0,l._)(this,tT,tU).call(this,-1)})}nextSection(){return this.goTo({index:(0,l._)(this,tT,tU).call(this,1)})}firstSection(){let t=this.sections.findIndex(t=>"no"!==t.linear);return this.goTo({index:t})}lastSection(){let t=this.sections.findLastIndex(t=>"no"!==t.linear);return this.goTo({index:t})}getContents(){return(0,n._)(this,Q)?[{index:(0,n._)(this,tt),overlayer:(0,n._)(this,Q).overlayer,doc:(0,n._)(this,Q).document}]:[]}setStyles(t){var e,i,s,r,h;(0,a._)(this,ts,t);let o=(0,n._)(this,ta).get(null==(e=(0,n._)(this,Q))?void 0:e.document);if(!o)return;let[c,d]=o;if(Array.isArray(t)){let[e,i]=t;c.textContent=e,d.textContent=i}else d.textContent=t;requestAnimationFrame(()=>{(0,l._)(this,t_,tL).call(this,(0,n._)(this,Q).docBackground,this.columnCount)}),null==(h=(0,n._)(this,Q))||null==(r=h.document)||null==(s=r.fonts)||null==(i=s.ready)||i.then(()=>(0,n._)(this,Q).expand())}focusView(){(0,n._)(this,Q).document.defaultView.focus()}destroy(){var t,e;(0,n._)(this,H).unobserve(this),(0,n._)(this,Q).destroy(),(0,a._)(this,Q,null),null==(e=this.sections[(0,n._)(this,tt)])||null==(t=e.unload)||t.call(e),(0,n._)(this,tl).removeEventListener("change",(0,n._)(this,tr))}constructor(){super(),(0,r._)(this,tu),(0,r._)(this,t_),(0,r._)(this,tp),(0,r._)(this,tm),(0,r._)(this,tg),(0,r._)(this,tv),(0,r._)(this,tf),(0,r._)(this,tw),(0,r._)(this,tb),(0,r._)(this,ty),(0,r._)(this,tx),(0,r._)(this,tk),(0,r._)(this,tM),(0,r._)(this,tE),(0,r._)(this,tS),(0,r._)(this,tW),(0,r._)(this,tC),(0,r._)(this,tz),(0,r._)(this,tT),(0,r._)(this,tP),(0,s._)(this,q,{writable:!0,value:this.attachShadow({mode:"open"})}),(0,s._)(this,H,{writable:!0,value:new ResizeObserver(()=>this.render())}),(0,s._)(this,X,{writable:!0,value:void 0}),(0,s._)(this,Y,{writable:!0,value:void 0}),(0,s._)(this,G,{writable:!0,value:void 0}),(0,s._)(this,J,{writable:!0,value:void 0}),(0,s._)(this,K,{writable:!0,value:void 0}),(0,s._)(this,Q,{writable:!0,value:void 0}),(0,s._)(this,U,{writable:!0,value:!1}),(0,s._)(this,Z,{writable:!0,value:!1}),(0,s._)(this,$,{writable:!0,value:0}),(0,s._)(this,tt,{writable:!0,value:-1}),(0,s._)(this,te,{writable:!0,value:0}),(0,s._)(this,ti,{writable:!0,value:!1}),(0,s._)(this,tn,{writable:!0,value:!1}),(0,s._)(this,ts,{writable:!0,value:void 0}),(0,s._)(this,ta,{writable:!0,value:new WeakMap}),(0,s._)(this,tl,{writable:!0,value:matchMedia("(prefers-color-scheme: dark)")}),(0,s._)(this,tr,{writable:!0,value:void 0}),(0,s._)(this,th,{writable:!0,value:void 0}),(0,s._)(this,to,{writable:!0,value:void 0}),(0,s._)(this,tc,{writable:!0,value:void 0}),(0,s._)(this,td,{writable:!0,value:void 0}),(0,n._)(this,q).innerHTML='<style>\n        :host {\n            display: block;\n            container-type: size;\n        }\n        :host, #top {\n            box-sizing: border-box;\n            position: relative;\n            overflow: hidden;\n            width: 100%;\n            height: 100%;\n        }\n        #top {\n            --_gap: 7%;\n            --_margin: 48px;\n            --_max-inline-size: 720px;\n            --_max-block-size: 1440px;\n            --_max-column-count: 2;\n            --_max-column-count-portrait: 1;\n            --_max-column-count-spread: var(--_max-column-count);\n            --_half-gap: calc(var(--_gap) / 2);\n            --_max-width: calc(var(--_max-inline-size) * var(--_max-column-count-spread));\n            --_max-height: var(--_max-block-size);\n            display: grid;\n            grid-template-columns:\n                minmax(var(--_half-gap), 1fr)\n                var(--_half-gap)\n                minmax(0, calc(var(--_max-width) - var(--_gap)))\n                var(--_half-gap)\n                minmax(var(--_half-gap), 1fr);\n            grid-template-rows:\n                minmax(var(--_margin), 1fr)\n                minmax(0, var(--_max-height))\n                minmax(var(--_margin), 1fr);\n            &.vertical {\n                --_max-column-count-spread: var(--_max-column-count-portrait);\n                --_max-width: var(--_max-block-size);\n                --_max-height: calc(var(--_max-inline-size) * var(--_max-column-count-spread));\n            }\n            @container (orientation: portrait) {\n                & {\n                    --_max-column-count-spread: var(--_max-column-count-portrait);\n                }\n                &.vertical {\n                    --_max-column-count-spread: var(--_max-column-count);\n                }\n            }\n        }\n        #background {\n            grid-column: 1 / -1;\n            grid-row: 1 / -1;\n        }\n        #container {\n            grid-column: 2 / 5;\n            grid-row: 2;\n            overflow: hidden;\n        }\n        :host([flow="scrolled"]) #container {\n            grid-column: 1 / -1;\n            grid-row: 1 / -1;\n            overflow: auto;\n        }\n        #header {\n            grid-column: 3 / 4;\n            grid-row: 1;\n        }\n        #footer {\n            grid-column: 3 / 4;\n            grid-row: 3;\n            align-self: end;\n        }\n        #header, #footer {\n            display: grid;\n            height: var(--_margin);\n        }\n        :is(#header, #footer) > * {\n            display: flex;\n            align-items: center;\n            min-width: 0;\n        }\n        :is(#header, #footer) > * > * {\n            width: 100%;\n            overflow: hidden;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            text-align: center;\n            font-size: .75em;\n            opacity: .6;\n        }\n        </style>\n        <div id="top">\n            <div id="background" part="filter"></div>\n            <div id="header"></div>\n            <div id="container" part="container"></div>\n            <div id="footer"></div>\n        </div>\n        ',(0,a._)(this,X,(0,n._)(this,q).getElementById("top")),(0,a._)(this,Y,(0,n._)(this,q).getElementById("background")),(0,a._)(this,G,(0,n._)(this,q).getElementById("container")),(0,a._)(this,J,(0,n._)(this,q).getElementById("header")),(0,a._)(this,K,(0,n._)(this,q).getElementById("footer")),(0,n._)(this,H).observe((0,n._)(this,G)),(0,n._)(this,G).addEventListener("scroll",()=>this.dispatchEvent(new Event("scroll"))),(0,n._)(this,G).addEventListener("scroll",c(()=>{this.scrolled&&((0,n._)(this,ti)?(0,a._)(this,ti,!1):(0,l._)(this,tM,tX).call(this,"scroll"))},250));let t={passive:!1};this.addEventListener("touchstart",(0,l._)(this,tm,tN).bind(this),t),this.addEventListener("touchmove",(0,l._)(this,tg,tV).bind(this),t),this.addEventListener("touchend",(0,l._)(this,tv,tI).bind(this)),this.addEventListener("load",e=>{let{detail:{doc:i}}=e;i.addEventListener("touchstart",(0,l._)(this,tm,tN).bind(this),t),i.addEventListener("touchmove",(0,l._)(this,tg,tV).bind(this),t),i.addEventListener("touchend",(0,l._)(this,tv,tI).bind(this))}),this.addEventListener("relocate",t=>{let{detail:e}=t;"selection"===e.reason?W((0,n._)(this,te),0):"navigation"===e.reason&&(1===(0,n._)(this,te)?W(e.range,1):"number"==typeof(0,n._)(this,te)?W(e.range,-1):W((0,n._)(this,te),-1))});let e=c((t,e)=>{if(!e.rangeCount)return;let i=e.getRangeAt(0),n=S(e);n&&0>i.compareBoundaryPoints(Range.START_TO_START,t)?this.prev():!n&&i.compareBoundaryPoints(Range.END_TO_END,t)>0&&this.next()},700);this.addEventListener("load",t=>{let{detail:{doc:i}}=t,s=!1;i.addEventListener("pointerdown",()=>s=!0),i.addEventListener("pointerup",()=>s=!1);let a=!1;i.addEventListener("keydown",()=>a=!0),i.addEventListener("keyup",()=>a=!1),i.addEventListener("selectionchange",()=>{if(this.scrolled)return;let t=(0,n._)(this,td);if(!t)return;let r=i.getSelection();if(r.rangeCount){if(!s&&s&&"Range"===r.type)e(t,r);else if(a){let t=r.getRangeAt(0).cloneRange();S(r)||t.collapse(),(0,l._)(this,tx,tq).call(this,t)}}}),i.addEventListener("focusin",t=>{if(this.scrolled)return null;(0,n._)(this,G)&&(0,n._)(this,G).contains(t.target)&&requestAnimationFrame(()=>(0,l._)(this,tx,tq).call(this,t.target))})}),(0,a._)(this,tr,()=>{(0,n._)(this,Q)&&(0,l._)(this,t_,tL).call(this,(0,n._)(this,Q).docBackground,this.columnCount)}),(0,n._)(this,tl).addEventListener("change",(0,n._)(this,tr))}}function tA(){return(0,n._)(this,Q)&&((0,n._)(this,Q).destroy(),(0,n._)(this,G).removeChild((0,n._)(this,Q).element)),(0,a._)(this,Q,new j({container:this,onExpand:()=>(0,l._)(this,tx,tq).call(this,(0,n._)(this,te))})),(0,n._)(this,G).append((0,n._)(this,Q).element),(0,n._)(this,Q)}function tL(t,e){var i;let s=null==(i=(0,n._)(this,Q))?void 0:i.document;if(!s)return;let a=s.defaultView.getComputedStyle(s.documentElement),l=a.getPropertyValue("--theme-bg-color"),r="dark"===a.getPropertyValue("color-scheme");if(t&&l){let e=t.split(/\s(?=(?:url|rgb|hsl|#[0-9a-fA-F]{3,6}))/);r&&(e[0]=l),t=e.join(" ")}/cover.*fixed|fixed.*cover/.test(t)&&(t=t.replace("cover","auto 100%").replace("fixed","")),(0,n._)(this,Y).innerHTML="",(0,n._)(this,Y).style.display="grid",(0,n._)(this,Y).style.gridTemplateColumns="repeat(".concat(e,", 1fr)");for(let i=0;i<e;i++){let e=document.createElement("div");e.style.background=t,e.style.width="100%",e.style.height="100%",(0,n._)(this,Y).appendChild(e)}}function tB(t){let{vertical:e,rtl:i,background:s}=t;(0,a._)(this,U,e),(0,a._)(this,Z,i),(0,n._)(this,X).classList.toggle("vertical",e);let{width:r,height:h}=(0,n._)(this,G).getBoundingClientRect(),o=e?h:r,c=getComputedStyle((0,n._)(this,X)),d=parseFloat(c.getPropertyValue("--_max-inline-size")),u=parseInt(c.getPropertyValue("--_max-column-count-spread")),_=parseFloat(c.getPropertyValue("--_margin"));(0,a._)(this,$,_);let p=parseFloat(c.getPropertyValue("--_gap"))/100,m=-p/(p-1)*o,g=this.getAttribute("flow");if("scrolled"===g)return this.setAttribute("dir",e?"rtl":"ltr"),(0,n._)(this,X).style.padding="0",this.heads=null,this.feet=null,(0,n._)(this,J).replaceChildren(),(0,n._)(this,K).replaceChildren(),{flow:g,margin:_,gap:m,columnWidth:d};let v=Math.min(u,Math.ceil(o/d)),f=e?o/v-_:o/v-m;this.setAttribute("dir",i?"rtl":"ltr"),this.columnCount=v,(0,l._)(this,t_,tL).call(this,s,this.columnCount);let w=e?Math.min(2,Math.ceil(r/d)):v,b={gridTemplateColumns:"repeat(".concat(w,", 1fr)"),gap:"".concat(m,"px"),direction:"rtl"===this.bookDir?"rtl":"ltr"};Object.assign((0,n._)(this,J).style,b),Object.assign((0,n._)(this,K).style,b);let y=T(w,"head"),x=T(w,"foot");return this.heads=y.map(t=>t.children[0]),this.feet=x.map(t=>t.children[0]),(0,n._)(this,J).replaceChildren(...y),(0,n._)(this,K).replaceChildren(...x),{height:h,width:r,margin:_,gap:m,columnWidth:f}}function tN(t){let e=t.changedTouches[0];(0,a._)(this,to,{x:null==e?void 0:e.screenX,y:null==e?void 0:e.screenY,t:t.timeStamp,vx:0,xy:0})}function tV(t){var e;let i=(0,n._)(this,to);if(i.pinched||(i.pinched=globalThis.visualViewport.scale>1,this.scrolled||i.pinched))return;if(t.touches.length>1){(0,n._)(this,tc)&&t.preventDefault();return}let s=null==(e=(0,n._)(this,Q))?void 0:e.document,l=null==s?void 0:s.getSelection();if(l&&l.rangeCount>0&&!l.isCollapsed)return;t.preventDefault();let r=t.changedTouches[0],h=r.screenX,o=r.screenY,c=i.x-h,d=i.y-o,u=t.timeStamp-i.t;i.x=h,i.y=o,i.t=t.timeStamp,i.vx=c/u,i.vy=d/u,(0,a._)(this,tc,!0),Math.abs(c)>=Math.abs(d)?this.scrollBy(c,0):Math.abs(d)>Math.abs(c)&&this.scrollBy(0,d)}function tI(){(0,a._)(this,tc,!1),this.scrolled||requestAnimationFrame(()=>{1===globalThis.visualViewport.scale&&this.snap((0,n._)(this,to).vx,(0,n._)(this,to).vy)})}function tF(){if(this.scrolled){let t=this.viewSize,e=(0,n._)(this,$);return(0,n._)(this,U)?i=>{let{left:n,right:s}=i;return{left:t-s-e,right:t-n-e}}:t=>{let{top:i,bottom:n}=t;return{left:i+e,right:n+e}}}let t=this.pages*this.size;return(0,n._)(this,Z)?e=>{let{left:i,right:n}=e;return{left:t-n,right:t-i}}:(0,n._)(this,U)?t=>{let{top:e,bottom:i}=t;return{left:e,right:i}}:t=>t}async function tO(t,e){if(this.scrolled){let i=(0,l._)(this,tf,tF).call(this)(t).left-(0,n._)(this,$);return"selection"===e&&this.start<i&&i<this.start+this.size?(0,l._)(this,tb,tD).call(this,this.start,e):(0,l._)(this,tb,tD).call(this,i,e)}let i=(0,l._)(this,tf,tF).call(this)(t).left;return(0,l._)(this,ty,tj).call(this,Math.floor(i/this.size)+((0,n._)(this,Z)?-1:1),e)}async function tD(t,e,i){let{size:s}=this;if(this.containerPosition===t){(0,a._)(this,th,[t,this.atStart?0:s,this.atEnd?0:s]),(0,l._)(this,tM,tX).call(this,e);return}if(this.scrolled&&(0,n._)(this,U)&&(t=-t),("snap"===e||i)&&this.hasAttribute("animated"))return _(this.containerPosition,t,300,u,t=>this.containerPosition=t).then(()=>{(0,a._)(this,th,[t,this.atStart?0:s,this.atEnd?0:s]),(0,l._)(this,tM,tX).call(this,e)});this.containerPosition=t,(0,a._)(this,th,[t,this.atStart?0:s,this.atEnd?0:s]),(0,l._)(this,tM,tX).call(this,e)}async function tj(t,e,i){let s=this.size*((0,n._)(this,Z)?-t:t);return(0,l._)(this,tb,tD).call(this,s,e,i)}async function tq(t){var e,i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"anchor";(0,a._)(this,te,t);let s=null==(i=p(t))||null==(e=i.getClientRects)?void 0:e.call(i);if(s){let t=Array.from(s).find(t=>t.width>0&&t.height>0)||s[0];if(!t)return;await (0,l._)(this,tw,tO).call(this,t,n);return}if(this.scrolled)return void await (0,l._)(this,tb,tD).call(this,t*this.viewSize,n);let{pages:r}=this;if(!r)return;let h=Math.round(t*(r-2-1));await (0,l._)(this,ty,tj).call(this,h+1,n)}function tH(){if(this.scrolled)return E((0,n._)(this,Q).document,this.start+(0,n._)(this,$),this.end-(0,n._)(this,$),(0,l._)(this,tf,tF).call(this));let t=(0,n._)(this,Z)?-this.size:this.size;return E((0,n._)(this,Q).document,this.start-t,this.end-t,(0,l._)(this,tf,tF).call(this))}function tX(t){let e=(0,l._)(this,tk,tH).call(this);(0,a._)(this,td,e),"selection"!==t&&"navigation"!==t&&"anchor"!==t?(0,a._)(this,te,e):(0,a._)(this,ti,!0);let i={reason:t,range:e,index:(0,n._)(this,tt)};if(this.scrolled)i.fraction=this.start/this.viewSize;else if(this.pages>0){let{page:t,pages:e}=this;(0,n._)(this,J).style.visibility=t>1?"visible":"hidden",i.fraction=(t-1)/(e-2),i.size=1/(e-2)}this.dispatchEvent(new CustomEvent("relocate",{detail:i}))}async function tY(t){var e,i,s;let{index:r,src:h,data:o,anchor:c,onLoad:d,select:u}=await t;(0,a._)(this,tt,r);let _=null==(i=(0,n._)(this,Q))||null==(e=i.document)?void 0:e.hasFocus();if(h){let t=(0,l._)(this,tu,tA).call(this),e=(0,l._)(this,tp,tB).bind(this);await t.load(h,o,t=>{if(t.head){let e=t.createElement("style");t.head.prepend(e);let i=t.createElement("style");t.head.append(i),(0,n._)(this,ta).set(t,[e,i])}null==d||d({doc:t,index:r})},e),this.dispatchEvent(new CustomEvent("create-overlayer",{detail:{doc:t.document,index:r,attach:e=>t.overlayer=e}})),(0,a._)(this,Q,t)}await this.scrollToAnchor(null!=(s="function"==typeof c?c((0,n._)(this,Q).document):c)?s:0,u),_&&this.focusView()}function tG(t){return t>=0&&t<=this.sections.length-1}async function tJ(t){let{index:e,anchor:i,select:s}=t;if(e===(0,n._)(this,tt))await (0,l._)(this,tE,tY).call(this,{index:e,anchor:i,select:s});else{let t=(0,n._)(this,tt),a=e=>{var i,s;null==(s=this.sections[t])||null==(i=s.unload)||i.call(s),this.setStyles((0,n._)(this,ts)),this.dispatchEvent(new CustomEvent("load",{detail:e}))};await (0,l._)(this,tE,tY).call(this,Promise.resolve(this.sections[e].load()).then(async t=>{var n,l;let r=await (null==(n=(l=this.sections[e]).loadContent)?void 0:n.call(l));return{index:e,src:t,data:r,anchor:i,onLoad:a,select:s}}).catch(t=>(console.warn(t),console.warn(Error("Failed to load section ".concat(e))),{})))}}function tK(t){if(!(0,n._)(this,Q))return!0;if(this.scrolled)return this.start>0?(0,l._)(this,tb,tD).call(this,Math.max(0,this.start-(null!=t?t:this.size)),null,!0):!this.atStart;if(this.atStart)return;let e=this.page-1;return(0,l._)(this,ty,tj).call(this,e,"page",!0).then(()=>e<=0)}function tQ(t){if(!(0,n._)(this,Q))return!0;if(this.scrolled)return this.viewSize-this.end>2?(0,l._)(this,tb,tD).call(this,Math.min(this.viewSize,t?this.start+t:this.end),null,!0):!this.atEnd;if(this.atEnd)return;let e=this.page+1,i=this.pages;return(0,l._)(this,ty,tj).call(this,e,"page",!0).then(()=>e>=i-1)}function tU(t){var e;for(let i=(0,n._)(this,tt)+t;(0,l._)(this,tS,tG).call(this,i);i+=t)if((null==(e=this.sections[i])?void 0:e.linear)!=="no")return i}async function tZ(t,e){if((0,n._)(this,tn))return;(0,a._)(this,tn,!0);let i=-1===t,s=await (i?(0,l._)(this,tC,tK).call(this,e):(0,l._)(this,tz,tQ).call(this,e));s&&await (0,l._)(this,tW,tJ).call(this,{index:(0,l._)(this,tT,tU).call(this,t),anchor:i?()=>1:()=>0}),(s||!this.hasAttribute("animated"))&&await o(100),(0,a._)(this,tn,!1)}(0,h._)(tR,"observedAttributes",["flow","gap","margin","max-inline-size","max-block-size","max-column-count"]),customElements.define("foliate-paginator",tR)}}]);