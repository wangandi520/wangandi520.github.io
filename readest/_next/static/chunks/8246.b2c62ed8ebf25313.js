(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8246],{58246:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FixedLayout:()=>o}),n(81975);let i=e=>e?.split(/[,;\s]/)?.filter(e=>e)?.map(e=>e.split("=").map(e=>e.trim())),r=(e,t)=>{if("svg"===e.documentElement.localName){let[,,t,n]=e.documentElement.getAttribute("viewBox")?.split(/\s/)??[];return{width:t,height:n}}let n=i(e.querySelector('meta[name="viewport"]')?.getAttribute("content"));if(n)return Object.fromEntries(n);if("string"==typeof t)return i(t);if(t)return t;let r=e.querySelector("img");return r?{width:r.naturalWidth,height:r.naturalHeight}:(console.warn(Error("Missing viewport properties")),{width:1e3,height:2e3})};class o extends HTMLElement{static observedAttributes=["zoom"];#e=this.attachShadow({mode:"closed"});#t=new ResizeObserver(()=>this.#n());#i;#r=-1;defaultViewport;spread;#o=!1;#s;#a;#h;#c;#l;constructor(){super();let e=new CSSStyleSheet;this.#e.adoptedStyleSheets=[e],e.replaceSync(`:host {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: auto;
        }`),this.#t.observe(this)}attributeChangedCallback(e,t,n){"zoom"===e&&(this.#l="fit-width"!==n&&"fit-page"!==n?parseFloat(n):n,this.#n())}async #d({index:e,src:t}){let n="string"==typeof t,i=n?t:t?.src,o=n?null:t?.onZoom,s=document.createElement("div");s.setAttribute("dir","ltr");let a=document.createElement("iframe");return(s.append(a),Object.assign(a.style,{border:"0",display:"none",overflow:"hidden"}),a.setAttribute("sandbox","allow-same-origin allow-scripts"),a.setAttribute("scrolling","no"),a.setAttribute("part","filter"),this.#e.append(s),i)?new Promise(t=>{a.addEventListener("load",()=>{let n=a.contentDocument;this.dispatchEvent(new CustomEvent("load",{detail:{doc:n,index:e}}));let{width:i,height:h}=r(n,this.defaultViewport);t({element:s,iframe:a,width:parseFloat(i),height:parseFloat(h),onZoom:o})},{once:!0}),a.src=i}):{blank:!0,element:s,iframe:a}}#n(e=this.#c){if(!e)return;let t=this.#s??{},n=this.#h??this.#a??{},i="left"===e?t:n,{width:r,height:o}=this.getBoundingClientRect(),s="both"!==this.spread&&"portrait"!==this.spread&&o>r;this.#o=s;let a=t.width??n.width??0,h=t.height??n.height??0,c="number"!=typeof this.#l||isNaN(this.#l)?("fit-width"===this.#l?s||this.#h?r/(i.width??a):r/((t.width??a)+(n.width??a)):s||this.#h?Math.min(r/(i.width??a),o/(i.height??h)):Math.min(r/((t.width??a)+(n.width??a)),o/Math.max(t.height??h,n.height??h)))||1:this.#l,l=e=>{let{element:t,iframe:n,width:r,height:o,blank:l,onZoom:d}=e;if(!n)return;d&&d({doc:e.iframe.contentDocument,scale:c});let u=d?c:1;Object.assign(n.style,{width:`${r*u}px`,height:`${o*u}px`,transform:d?"none":`scale(${c})`,transformOrigin:"top left",display:l?"none":"block"}),Object.assign(t.style,{width:`${(r??a)*c}px`,height:`${(o??h)*c}px`,overflow:"hidden",display:"block",flexShrink:"0",marginBlock:"auto"}),s&&e!==i&&(t.style.display="none")};this.#h?l(this.#h):(l(t),l(n))}async #u({left:e,right:t,center:n,side:i}){this.#e.replaceChildren(),this.#s=null,this.#a=null,this.#h=null,n?(this.#h=await this.#d(n),this.#c="center"):(this.#s=await this.#d(e),this.#a=await this.#d(t),this.#c=this.#s.blank?"right":this.#a.blank?"left":i),this.#n()}#f(){if(!(this.#h||this.#s?.blank)&&this.#o&&this.#s?.element?.style?.display==="none")return this.#c="left",this.#n(),this.#p("page"),!0}#g(){if(!(this.#h||this.#a?.blank)&&this.#o&&this.#a?.element?.style?.display==="none")return this.#c="right",this.#n(),this.#p("page"),!0}open(e){this.book=e;let{rendition:t}=e;this.spread=t?.spread,this.defaultViewport=t?.viewport;let n="rtl"===e.dir,i=!n;this.rtl=n,t?.spread==="none"?this.#i=e.sections.map(e=>({center:e})):this.#i=e.sections.reduce((e,t,r)=>{let o=e[e.length-1],{pageSpread:s}=t,a=()=>{let t={};return e.push(t),t};return"center"===s?(o.left||o.right?a():o).center=t:"left"===s?(o.center||o.left||i&&r?a():o).left=t:"right"===s?(o.center||o.right||n&&r?a():o).right=t:i?o.center||o.right?a().left=t:o.left||!r?o.right=t:o.left=t:o.center||o.left?a().right=t:o.right||!r?o.left=t:o.right=t,e},[{}])}get index(){let e=this.#i[this.#r],t=e?.center??("left"===this.#c?e.left??e.right:e.right??e.left);return this.book.sections.indexOf(t)}#p(e){this.dispatchEvent(new CustomEvent("relocate",{detail:{reason:e,range:null,index:this.index,fraction:0,size:1}}))}getSpreadOf(e){let t=this.#i;for(let n=0;n<t.length;n++){let{left:i,right:r,center:o}=t[n];if(i===e)return{index:n,side:"left"};if(r===e)return{index:n,side:"right"};if(o===e)return{index:n,side:"center"}}}async goToSpread(e,t,n){if(e<0||e>this.#i.length-1)return;if(e===this.#r)return void this.#n(t);this.#r=e;let i=this.#i[e];if(i.center){let e=this.book.sections.indexOf(i.center),t=await i.center?.load?.();await this.#u({center:{index:e,src:t}})}else{let e=this.book.sections.indexOf(i.left),n=this.book.sections.indexOf(i.right),r=await i.left?.load?.(),o=await i.right?.load?.();await this.#u({left:{index:e,src:r},right:{index:n,src:o},side:t})}this.#p(n)}async select(e){await this.goTo(e)}async goTo(e){let{book:t}=this,n=await e,i=t.sections[n.index];if(!i)return;let{index:r,side:o}=this.getSpreadOf(i);await this.goToSpread(r,o)}async next(){if(!(this.rtl?this.#f():this.#g()))return this.goToSpread(this.#r+1,this.rtl?"right":"left","page")}async prev(){if(!(this.rtl?this.#g():this.#f()))return this.goToSpread(this.#r-1,this.rtl?"left":"right","page")}getContents(){return Array.from(this.#e.querySelectorAll("iframe"),e=>({doc:e.contentDocument}))}destroy(){this.#t.unobserve(this)}}customElements.define("foliate-fxl",o)},81975:()=>{!function(){"use strict";if("undefined"!=typeof document&&!("adoptedStyleSheets"in document)){var e="ShadyCSS"in window&&!ShadyCSS.nativeShadow,t=document.implementation.createHTMLDocument(""),n=new WeakMap,i="object"==typeof DOMException?Error:DOMException,r=Object.defineProperty,o=Array.prototype.forEach,s=/@import.+?;?$/gm,a=CSSStyleSheet.prototype;a.replace=function(){return Promise.reject(new i("Can't call replace on non-constructed CSSStyleSheets."))},a.replaceSync=function(){throw new i("Failed to execute 'replaceSync' on 'CSSStyleSheet': Can't call replaceSync on non-constructed CSSStyleSheets.")};var h=new WeakMap,c=new WeakMap,l=new WeakMap,d=new WeakMap,u=M.prototype;u.replace=function(e){try{return this.replaceSync(e),Promise.resolve(this)}catch(e){return Promise.reject(e)}},u.replaceSync=function(e){if(O(this),"string"==typeof e){var t,n,i=this;h.get(i).textContent=((n=(t=e).replace(s,""))!==t&&console.warn("@import rules are not allowed here. See https://github.com/WICG/construct-stylesheets/issues/119#issuecomment-588352418"),n.trim()),d.set(i,[]),c.get(i).forEach(function(e){e.isConnected()&&k(i,x(i,e))})}},r(u,"cssRules",{configurable:!0,enumerable:!0,get:function(){return O(this),h.get(this).sheet.cssRules}}),r(u,"media",{configurable:!0,enumerable:!0,get:function(){return O(this),h.get(this).sheet.media}}),["addRule","deleteRule","insertRule","removeRule"].forEach(function(e){u[e]=function(){var t=this;O(t);var n=arguments;d.get(t).push({method:e,args:n}),c.get(t).forEach(function(i){if(i.isConnected()){var r=x(t,i).sheet;r[e].apply(r,n)}});var i=h.get(t).sheet;return i[e].apply(i,n)}}),r(M,Symbol.hasInstance,{configurable:!0,value:E});var f={childList:!0,subtree:!0},p=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap;if(N.prototype={isConnected:function(){var e,t=g.get(this);return t instanceof Document?"loading"!==t.readyState:"isConnected"in(e=t.host)?e.isConnected:document.contains(e)},connect:function(){var e=T(this);y.get(this).observe(e,f),m.get(this).length>0&&A(this),R(e,function(e){F(e).connect()})},disconnect:function(){y.get(this).disconnect()},update:function(e){var t,n,i,r=this,o=g.get(r)===document?"Document":"ShadowRoot";if(!Array.isArray(e))throw TypeError("Failed to set the 'adoptedStyleSheets' property on "+o+": Iterator getter is not callable.");if(!e.every(E))throw TypeError("Failed to set the 'adoptedStyleSheets' property on "+o+": Failed to convert value to 'CSSStyleSheet'");if(e.some(C))throw TypeError("Failed to set the 'adoptedStyleSheets' property on "+o+": Can't adopt non-constructed stylesheets");r.sheets=e;var s=m.get(r),a=(t=e).filter(function(e,n){return t.indexOf(e)===n});(n=s,i=a,n.filter(function(e){return -1===i.indexOf(e)})).forEach(function(e){var t,n,i;(t=x(e,r)).parentNode.removeChild(t),n=e,i=r,l.get(n).delete(i),c.set(n,c.get(n).filter(function(e){return e!==i}))}),m.set(r,a),r.isConnected()&&a.length>0&&A(r)}},window.CSSStyleSheet=M,L(Document),"ShadowRoot"in window){L(ShadowRoot);var w=Element.prototype,S=w.attachShadow;w.attachShadow=function(e){var t=S.call(this,e);return"closed"===e.mode&&n.set(this,t),t}}var v=F(document);v.isConnected()?v.connect():document.addEventListener("DOMContentLoaded",v.connect.bind(v))}function b(e){return e.shadowRoot||n.get(e)}function E(e){return"object"==typeof e&&(u.isPrototypeOf(e)||a.isPrototypeOf(e))}function C(e){return"object"==typeof e&&a.isPrototypeOf(e)}function x(e,t){return l.get(e).get(t)}function k(e,t){requestAnimationFrame(function(){t.textContent=h.get(e).textContent,d.get(e).forEach(function(e){return t.sheet[e.method].apply(t.sheet,e.args)})})}function O(e){if(!h.has(e))throw TypeError("Illegal invocation")}function M(){var e=document.createElement("style");t.body.appendChild(e),h.set(this,e),c.set(this,[]),l.set(this,new WeakMap),d.set(this,[])}function F(e){var t=p.get(e);return t||(t=new N(e),p.set(e,t)),t}function L(e){r(e.prototype,"adoptedStyleSheets",{configurable:!0,enumerable:!0,get:function(){return F(this).sheets},set:function(e){F(this).update(e)}})}function R(e,t){for(var n=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT,function(e){return b(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},null,!1),i=void 0;i=n.nextNode();)t(b(i))}function T(e){var t=g.get(e);return t instanceof Document?t.body:t}function A(e){var t=document.createDocumentFragment(),n=m.get(e),i=y.get(e),r=T(e);i.disconnect(),n.forEach(function(n){var i;t.appendChild(x(n,e)||(i=document.createElement("style"),l.get(n).set(e,i),c.get(n).push(e),i))}),r.insertBefore(t,null),i.observe(r,f),n.forEach(function(t){k(t,x(t,e))})}function N(t){var n=this;n.sheets=[],g.set(n,t),m.set(n,[]),y.set(n,new MutationObserver(function(t,i){if(!document)return void i.disconnect();t.forEach(function(t){e||o.call(t.addedNodes,function(e){e instanceof Element&&R(e,function(e){F(e).connect()})}),o.call(t.removedNodes,function(t){t instanceof Element&&(t instanceof HTMLStyleElement&&m.get(n).some(function(e){return x(e,n)})&&A(n),e||R(t,function(e){F(e).disconnect()}))})})}))}}()}}]);