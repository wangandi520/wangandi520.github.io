"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7069],{54599:(e,t,i)=>{function a(){return window.__TAURI_OS_PLUGIN_INTERNALS__.os_type}function r(){return window.__TAURI_OS_PLUGIN_INTERNALS__.arch}i.d(t,{NW:()=>a,zJ:()=>r}),i(7269)},58068:(e,t,i)=>{i.d(t,{Ed:()=>s,LB:()=>d,Mp:()=>o,S$:()=>u,ZA:()=>l,i1:()=>n,ot:()=>p,ov:()=>r});var a=i(7269);async function r(e){return await (0,a.lA)("plugin:native-bridge|copy_uri_to_path",{payload:e})}async function n(e){await (0,a.lA)("plugin:native-bridge|use_background_audio",{payload:e})}async function s(e){return await (0,a.lA)("plugin:native-bridge|install_package",{payload:e})}async function o(e){return await (0,a.lA)("plugin:native-bridge|set_system_ui_visibility",{payload:e})}async function l(){return await (0,a.lA)("plugin:native-bridge|get_status_bar_height")}let c=null;async function u(){if(c)return c;let e=await (0,a.lA)("plugin:native-bridge|get_sys_fonts_list");return c=e,e}async function d(e){await (0,a.lA)("plugin:native-bridge|intercept_keys",{payload:e})}async function p(e){await (0,a.lA)("plugin:native-bridge|lock_screen_orientation",{payload:e})}},67069:(e,t,i)=>{i.d(t,{NativeAppService:()=>A});var a=i(84648),r=i(72897),n=i(7269);async function s(e={}){return"object"==typeof e&&Object.freeze(e),await (0,n.lA)("plugin:dialog|open",{options:e})}var o=i(66973),l=i(54599),c=i(50981),u=i(58529),d=i(58068),p=i(1487),_=i(81622),h=i(40965),w=i(79336);let f=(0,l.NW)(),g=(e,t)=>{switch(t){case"Settings":return{baseDir:r.DE.AppConfig,fp:e,base:t};case"Data":return{baseDir:r.DE.AppData,fp:e,base:t};case"Cache":return{baseDir:r.DE.AppCache,fp:e,base:t};case"Log":return{baseDir:r.DE.AppLog,fp:e,base:t};case"Books":return{baseDir:r.DE.AppData,fp:"".concat(h.zg,"/").concat(e),base:t};case"None":return{baseDir:0,fp:e,base:t};default:return{baseDir:r.DE.Temp,fp:e,base:t}}},y={getURL:e=>(0,c.Gz)(e)?e:(0,n.ch)(e),async getBlobURL(e,t){let i=await this.readFile(e,t,"binary");return URL.createObjectURL(new Blob([i]))},async openFile(e,t,i){let{fp:a,baseDir:r}=g(e,t),n=i||(0,u.e7)(a);if((0,c.Gz)(e))return await new p.T(e,n).open();if((0,c.em)(e)){if(n=await (0,o.P8)(e),e.includes("com.android.externalstorage"))return await new p.g(a,n,t?r:null).open();{let i=this.getPrefix("Cache"),a="".concat(i,"/").concat(n),s=await (0,d.ov)({uri:e,dst:a});if(!s.success)throw console.error("Failed to open file:",s),Error("Failed to open file");return await new p.g(a,n,t?r:null).open()}}{let i=this.getPrefix(t),s=e.startsWith("/")?e:i?await (0,o.fj)(i,e):null;return s&&"android"!==f?await new p.T(this.getURL(s),n).open():await new p.g(a,n,t?r:null).open()}},async copyFile(e,t,i){if((0,c.em)(e)){let a=this.getPrefix(i);if(!a)throw Error("Invalid base directory");let r=await (0,d.ov)({uri:e,dst:"".concat(a,"/").concat(t)});if(!r.success)throw console.error("Failed to copy file:",r),Error("Failed to copy file")}else{let{fp:a,baseDir:n}=g(t,i);await (0,r.m3)(e,a,i&&{toPathBaseDir:n})}},async readFile(e,t,i){let{fp:a,baseDir:n}=g(e,t);return"text"===i?(0,r.Gu)(a,t&&{baseDir:n}):(await (0,r.TA)(a,t&&{baseDir:n})).buffer},async writeFile(e,t,i){let{fp:a,baseDir:n}=g(e,t);if("string"==typeof i)return(0,r.Tl)(a,i,t&&{baseDir:n});if(!(i instanceof File))return(0,r._h)(a,new Uint8Array(i),t&&{baseDir:n});{let e=await (0,r.ho)(a,t&&{write:!0,create:!0,baseDir:n}),s=i.stream().getReader();try{for(;;){let{done:t,value:i}=await s.read();if(t)break;await e.write(i)}}finally{s.releaseLock(),await e.close()}}},async removeFile(e,t){let{fp:i,baseDir:a}=g(e,t);return(0,r.TF)(i,t&&{baseDir:a})},async createDir(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{fp:a,baseDir:n}=g(e,t);await (0,r.Ck)(a,t&&{baseDir:n,recursive:i})},async removeDir(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{fp:a,baseDir:n}=g(e,t);await (0,r.TF)(a,t&&{baseDir:n,recursive:i})},async readDir(e,t){let{fp:i,baseDir:a}=g(e,t);return(await (0,r.Ci)(i,t&&{baseDir:a})).map(e=>({path:e.name,isDir:e.isDirectory}))},async exists(e,t){let{fp:i,baseDir:a}=g(e,t);try{return await (0,r.t2)(i,t&&{baseDir:a})}catch(e){return!1}},getPrefix:()=>null};class A extends _.E{resolvePath(e,t){return g(e,t)}async getInitBooksDir(){return(0,o.fj)(await (0,o.Ft)(),h.zg)}async getCacheDir(){return await (0,o.Ll)()}async selectDirectory(){return await s({directory:!0,multiple:!1})}async selectFiles(e,t){let i=await s({multiple:!0,filters:[{name:e,extensions:t}]});return Array.isArray(i)?i:i?[i]:[]}constructor(...e){super(...e),(0,a._)(this,"fs",y),(0,a._)(this,"appPlatform","tauri"),(0,a._)(this,"isAppDataSandbox",["android","ios"].includes(f)),(0,a._)(this,"isMobile",["android","ios"].includes(f)),(0,a._)(this,"isAndroidApp","android"===f),(0,a._)(this,"isIOSApp","ios"===f),(0,a._)(this,"isMacOSApp","macos"===f),(0,a._)(this,"isLinuxApp","linux"===f),(0,a._)(this,"isMobileApp",["android","ios"].includes(f)),(0,a._)(this,"hasTrafficLight","macos"===f),(0,a._)(this,"hasWindow","ios"!==f&&"android"!==f),(0,a._)(this,"hasWindowBar","ios"!==f&&"android"!==f),(0,a._)(this,"hasContextMenu","ios"!==f&&"android"!==f),(0,a._)(this,"hasRoundedWindow","ios"!==f&&"android"!==f&&!!window.IS_ROUNDED),(0,a._)(this,"hasSafeAreaInset","ios"===f||"android"===f),(0,a._)(this,"hasHaptics","ios"===f||"android"===f),(0,a._)(this,"hasUpdater","ios"!==f&&!w.env.NEXT_PUBLIC_DISABLE_UPDATER&&!window.__READEST_UPDATER_DISABLED),(0,a._)(this,"getCoverImageUrl",e=>this.fs.getURL("".concat(this.localBooksDir,"/").concat((0,u.df)(e)))),(0,a._)(this,"getCoverImageBlobUrl",async e=>this.fs.getBlobURL("".concat(this.localBooksDir,"/").concat((0,u.df)(e)),"None"))}}}}]);