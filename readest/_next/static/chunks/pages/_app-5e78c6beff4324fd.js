(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{1714:()=>{},7343:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(62807));class n extends s.default{select(e){let t=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:i,foreignTable:r,referencedTable:s=r}={}){let n=s?`${s}.order`:"order",o=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===i?"":i?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:i=t}={}){let r=void 0===i?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:i,referencedTable:r=i}={}){let s=void 0===r?"offset":`${r}.offset`,n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(n,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:i=!1,buffers:r=!1,wal:s=!1,format:n="text"}={}){var o;let a=[e?"analyze":null,t?"verbose":null,i?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!=(o=this.headers.Accept)?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${n}; for="${l}"; options=${a};`,this}rollback(){var e;return(null!=(e=this.headers.Prefer)?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=n},11733:(e,t,i)=>{"use strict";i.d(t,{n:()=>h,g:()=>d});var r=i(33736),s=i(91844),n=i(74615),o=i(49682);let a=(0,n.L1)()+"/sync";class l{async pullChanges(e,t,i){let r=await (0,o.iD)();if(!r)throw Error("Not authenticated");let s="".concat(a,"?since=").concat(encodeURIComponent(e),"&type=").concat(null!=t?t:"","&book=").concat(null!=i?i:""),n=await fetch(s,{headers:{Authorization:"Bearer ".concat(r)}});if(!n.ok){let e=await n.json();throw Error("Failed to pull changes: ".concat(e.error||n.statusText))}return n.json()}async pushChanges(e){let t=await (0,o.iD)();if(!t)throw Error("Not authenticated");let i=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(!i.ok){let e=await i.json();throw Error("Failed to push changes: ".concat(e.error||i.statusText))}return i.json()}}let c=new l,u=(0,s.createContext)({syncClient:c}),h=e=>{let{children:t}=e;return(0,r.jsx)(u.Provider,{value:{syncClient:c},children:t})},d=()=>(0,s.useContext)(u)},11880:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;let r=i(84109);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`}},15599:(e,t,i)=>{"use strict";let r=i(75975),s=i(93438),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,i){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return l(e,t,i)}function l(e,t,i){if("string"==typeof e){var r=e,s=t;if(("string"!=typeof s||""===s)&&(s="utf8"),!a.isEncoding(s))throw TypeError("Unknown encoding: "+s);let i=0|p(r,s),n=o(i),l=n.write(r,s);return l!==i&&(n=n.slice(0,l)),n}if(ArrayBuffer.isView(e)){var n=e;if(M(n,Uint8Array)){let e=new Uint8Array(n);return d(e.buffer,e.byteOffset,e.byteLength)}return h(n)}if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(M(e,ArrayBuffer)||e&&M(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(M(e,SharedArrayBuffer)||e&&M(e.buffer,SharedArrayBuffer)))return d(e,t,i);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let l=e.valueOf&&e.valueOf();if(null!=l&&l!==e)return a.from(l,t,i);let c=function(e){if(a.isBuffer(e)){let t=0|f(e.length),i=o(t);return 0===i.length||e.copy(i,0,0,t),i}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?o(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(c)return c;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),o(e<0?0:0|f(e))}function h(e){let t=e.length<0?0:0|f(e.length),i=o(t);for(let r=0;r<t;r+=1)i[r]=255&e[r];return i}function d(e,t,i){let r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),a.prototype),r}function f(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||M(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let i=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===i)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return L(e).length;default:if(s)return r?-1:j(e).length;t=(""+t).toLowerCase(),s=!0}}function g(e,t,i){let s=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0||(i>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,i){let r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);let s="";for(let r=t;r<i;++r)s+=N[e[r]];return s}(this,t,i);case"utf8":case"utf-8":return y(this,t,i);case"ascii":return function(e,t,i){let r="";i=Math.min(e.length,i);for(let s=t;s<i;++s)r+=String.fromCharCode(127&e[s]);return r}(this,t,i);case"latin1":case"binary":return function(e,t,i){let r="";i=Math.min(e.length,i);for(let s=t;s<i;++s)r+=String.fromCharCode(e[s]);return r}(this,t,i);case"base64":var n,o,a;return n=this,o=t,a=i,0===o&&a===n.length?r.fromByteArray(n):r.fromByteArray(n.slice(o,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,i){let r=e.slice(t,i),s="";for(let e=0;e<r.length-1;e+=2)s+=String.fromCharCode(r[e]+256*r[e+1]);return s}(this,t,i);default:if(s)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}function v(e,t,i){let r=e[t];e[t]=e[i],e[i]=r}function _(e,t,i,r,s){var n;if(0===e.length)return -1;if("string"==typeof i?(r=i,i=0):i>0x7fffffff?i=0x7fffffff:i<-0x80000000&&(i=-0x80000000),(n=i*=1)!=n&&(i=s?0:e.length-1),i<0&&(i=e.length+i),i>=e.length)if(s)return -1;else i=e.length-1;else if(i<0)if(!s)return -1;else i=0;if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:m(e,t,i,r,s);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(s)return Uint8Array.prototype.indexOf.call(e,t,i);else return Uint8Array.prototype.lastIndexOf.call(e,t,i);return m(e,[t],i,r,s)}throw TypeError("val must be string, number or Buffer")}function m(e,t,i,r,s){let n,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,i/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let r=-1;for(n=i;n<a;n++)if(c(e,n)===c(t,-1===r?0:n-r)){if(-1===r&&(r=n),n-r+1===l)return r*o}else -1!==r&&(n-=n-r),r=-1}else for(i+l>a&&(i=a-l),n=i;n>=0;n--){let i=!0;for(let r=0;r<l;r++)if(c(e,n+r)!==c(t,r)){i=!1;break}if(i)return n}return -1}function y(e,t,i){i=Math.min(e.length,i);let r=[],s=t;for(;s<i;){let t=e[s],n=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=i){let i,r,a,l;switch(o){case 1:t<128&&(n=t);break;case 2:(192&(i=e[s+1]))==128&&(l=(31&t)<<6|63&i)>127&&(n=l);break;case 3:i=e[s+1],r=e[s+2],(192&i)==128&&(192&r)==128&&(l=(15&t)<<12|(63&i)<<6|63&r)>2047&&(l<55296||l>57343)&&(n=l);break;case 4:i=e[s+1],r=e[s+2],a=e[s+3],(192&i)==128&&(192&r)==128&&(192&a)==128&&(l=(15&t)<<18|(63&i)<<12|(63&r)<<6|63&a)>65535&&l<1114112&&(n=l)}}null===n?(n=65533,o=1):n>65535&&(n-=65536,r.push(n>>>10&1023|55296),n=56320|1023&n),r.push(n),s+=o}var n=r;let o=n.length;if(o<=4096)return String.fromCharCode.apply(String,n);let a="",l=0;for(;l<o;)a+=String.fromCharCode.apply(String,n.slice(l,l+=4096));return a}function b(e,t,i){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>i)throw RangeError("Trying to access beyond buffer length")}function w(e,t,i,r,s,n){if(!a.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<n)throw RangeError('"value" argument is out of bounds');if(i+r>e.length)throw RangeError("Index out of range")}function k(e,t,i,r,s){C(t,r,s,e,i,7);let n=Number(t&BigInt(0xffffffff));e[i++]=n,n>>=8,e[i++]=n,n>>=8,e[i++]=n,n>>=8,e[i++]=n;let o=Number(t>>BigInt(32)&BigInt(0xffffffff));return e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,i}function S(e,t,i,r,s){C(t,r,s,e,i,7);let n=Number(t&BigInt(0xffffffff));e[i+7]=n,n>>=8,e[i+6]=n,n>>=8,e[i+5]=n,n>>=8,e[i+4]=n;let o=Number(t>>BigInt(32)&BigInt(0xffffffff));return e[i+3]=o,o>>=8,e[i+2]=o,o>>=8,e[i+1]=o,o>>=8,e[i]=o,i+8}function E(e,t,i,r,s,n){if(i+r>e.length||i<0)throw RangeError("Index out of range")}function x(e,t,i,r,n){return t*=1,i>>>=0,n||E(e,t,i,4,34028234663852886e22,-34028234663852886e22),s.write(e,t,i,r,23,4),i+4}function T(e,t,i,r,n){return t*=1,i>>>=0,n||E(e,t,i,8,17976931348623157e292,-17976931348623157e292),s.write(e,t,i,r,52,8),i+8}t.hp=a,t.IS=50,a.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,i){return l(e,t,i)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,i){return(c(e),e<=0)?o(e):void 0!==t?"string"==typeof i?o(e).fill(t,i):o(e).fill(t):o(e)},a.allocUnsafe=function(e){return u(e)},a.allocUnsafeSlow=function(e){return u(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(M(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),M(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,r=t.length;for(let s=0,n=Math.min(i,r);s<n;++s)if(e[s]!==t[s]){i=e[s],r=t[s];break}return i<r?-1:+(r<i)},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){let i;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);if(void 0===t)for(i=0,t=0;i<e.length;++i)t+=e[i].length;let r=a.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){let t=e[i];if(M(t,Uint8Array))s+t.length>r.length?(a.isBuffer(t)||(t=a.from(t)),t.copy(r,s)):Uint8Array.prototype.set.call(r,t,s);else if(a.isBuffer(t))t.copy(r,s);else throw TypeError('"list" argument must be an Array of Buffers');s+=t.length}return r},a.byteLength=p,a.prototype._isBuffer=!0,a.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)v(this,t,t+1);return this},a.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},a.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},a.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?y(this,0,e):g.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){let e="",i=t.IS;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(e,t,i,r,s){if(M(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),t<0||i>e.length||r<0||s>this.length)throw RangeError("out of range index");if(r>=s&&t>=i)return 0;if(r>=s)return -1;if(t>=i)return 1;if(t>>>=0,i>>>=0,r>>>=0,s>>>=0,this===e)return 0;let n=s-r,o=i-t,l=Math.min(n,o),c=this.slice(r,s),u=e.slice(t,i);for(let e=0;e<l;++e)if(c[e]!==u[e]){n=c[e],o=u[e];break}return n<o?-1:+(o<n)},a.prototype.includes=function(e,t,i){return -1!==this.indexOf(e,t,i)},a.prototype.indexOf=function(e,t,i){return _(this,e,t,i,!0)},a.prototype.lastIndexOf=function(e,t,i){return _(this,e,t,i,!1)},a.prototype.write=function(e,t,i,r){var s,n,o,a,l,c,u,h;if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let d=this.length-t;if((void 0===i||i>d)&&(i=d),e.length>0&&(i<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let f=!1;for(;;)switch(r){case"hex":return function(e,t,i,r){let s;i=Number(i)||0;let n=e.length-i;r?(r=Number(r))>n&&(r=n):r=n;let o=t.length;for(r>o/2&&(r=o/2),s=0;s<r;++s){var a;let r=parseInt(t.substr(2*s,2),16);if((a=r)!=a)break;e[i+s]=r}return s}(this,e,t,i);case"utf8":case"utf-8":return s=t,n=i,F(j(e,this.length-s),this,s,n);case"ascii":case"latin1":case"binary":return o=t,a=i,F(function(e){let t=[];for(let i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(e),this,o,a);case"base64":return l=t,c=i,F(L(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,h=i,F(function(e,t){let i,r,s=[];for(let n=0;n<e.length&&!((t-=2)<0);++n)r=(i=e.charCodeAt(n))>>8,s.push(i%256),s.push(r);return s}(e,this.length-u),this,u,h);default:if(f)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){let i=this.length;e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);let r=this.subarray(e,t);return Object.setPrototypeOf(r,a.prototype),r},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||b(e,t,this.length);let r=this[e],s=1,n=0;for(;++n<t&&(s*=256);)r+=this[e+n]*s;return r},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||b(e,t,this.length);let r=this[e+--t],s=1;for(;t>0&&(s*=256);)r+=this[e+--t]*s;return r},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=B(function(e){A(e>>>=0,"offset");let t=this[e],i=this[e+7];(void 0===t||void 0===i)&&$(e,this.length-8);let r=t+256*this[++e]+65536*this[++e]+0x1000000*this[++e],s=this[++e]+256*this[++e]+65536*this[++e]+0x1000000*i;return BigInt(r)+(BigInt(s)<<BigInt(32))}),a.prototype.readBigUInt64BE=B(function(e){A(e>>>=0,"offset");let t=this[e],i=this[e+7];(void 0===t||void 0===i)&&$(e,this.length-8);let r=0x1000000*t+65536*this[++e]+256*this[++e]+this[++e],s=0x1000000*this[++e]+65536*this[++e]+256*this[++e]+i;return(BigInt(r)<<BigInt(32))+BigInt(s)}),a.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||b(e,t,this.length);let r=this[e],s=1,n=0;for(;++n<t&&(s*=256);)r+=this[e+n]*s;return r>=(s*=128)&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||b(e,t,this.length);let r=t,s=1,n=this[e+--r];for(;r>0&&(s*=256);)n+=this[e+--r]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readInt8=function(e,t){return(e>>>=0,t||b(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||b(e,2,this.length);let i=this[e]|this[e+1]<<8;return 32768&i?0xffff0000|i:i},a.prototype.readInt16BE=function(e,t){e>>>=0,t||b(e,2,this.length);let i=this[e+1]|this[e]<<8;return 32768&i?0xffff0000|i:i},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=B(function(e){A(e>>>=0,"offset");let t=this[e],i=this[e+7];return(void 0===t||void 0===i)&&$(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(i<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+0x1000000*this[++e])}),a.prototype.readBigInt64BE=B(function(e){A(e>>>=0,"offset");let t=this[e],i=this[e+7];return(void 0===t||void 0===i)&&$(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(0x1000000*this[++e]+65536*this[++e]+256*this[++e]+i)}),a.prototype.readFloatLE=function(e,t){return e>>>=0,t||b(e,4,this.length),s.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||b(e,4,this.length),s.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||b(e,8,this.length),s.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||b(e,8,this.length),s.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,i,r){if(e*=1,t>>>=0,i>>>=0,!r){let r=Math.pow(2,8*i)-1;w(this,e,t,i,r,0)}let s=1,n=0;for(this[t]=255&e;++n<i&&(s*=256);)this[t+n]=e/s&255;return t+i},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,i,r){if(e*=1,t>>>=0,i>>>=0,!r){let r=Math.pow(2,8*i)-1;w(this,e,t,i,r,0)}let s=i-1,n=1;for(this[t+s]=255&e;--s>=0&&(n*=256);)this[t+s]=e/n&255;return t+i},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigUInt64LE=B(function(e,t=0){return k(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=B(function(e,t=0){return S(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(e,t,i,r){if(e*=1,t>>>=0,!r){let r=Math.pow(2,8*i-1);w(this,e,t,i,r-1,-r)}let s=0,n=1,o=0;for(this[t]=255&e;++s<i&&(n*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/n|0)-o&255;return t+i},a.prototype.writeIntBE=function(e,t,i,r){if(e*=1,t>>>=0,!r){let r=Math.pow(2,8*i-1);w(this,e,t,i,r-1,-r)}let s=i-1,n=1,o=0;for(this[t+s]=255&e;--s>=0&&(n*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/n|0)-o&255;return t+i},a.prototype.writeInt8=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,i){return e*=1,t>>>=0,i||w(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigInt64LE=B(function(e,t=0){return k(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=B(function(e,t=0){return S(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeFloatLE=function(e,t,i){return x(this,e,t,!0,i)},a.prototype.writeFloatBE=function(e,t,i){return x(this,e,t,!1,i)},a.prototype.writeDoubleLE=function(e,t,i){return T(this,e,t,!0,i)},a.prototype.writeDoubleBE=function(e,t,i){return T(this,e,t,!1,i)},a.prototype.copy=function(e,t,i,r){if(!a.isBuffer(e))throw TypeError("argument should be a Buffer");if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);let s=r-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,r):Uint8Array.prototype.set.call(e,this.subarray(i,r),t),s},a.prototype.fill=function(e,t,i,r){let s;if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){let t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw RangeError("Out of range index");if(i<=t)return this;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=t;s<i;++s)this[s]=e;else{let n=a.isBuffer(e)?e:a.from(e,r),o=n.length;if(0===o)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=n[s%o]}return this};let O={};function P(e,t,i){O[e]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function I(e){let t="",i=e.length,r=+("-"===e[0]);for(;i>=r+4;i-=3)t=`_${e.slice(i-3,i)}${t}`;return`${e.slice(0,i)}${t}`}function C(e,t,i,r,s,n){if(e>i||e<t){let r,s="bigint"==typeof t?"n":"";throw r=n>3?0===t||t===BigInt(0)?`>= 0${s} and < 2${s} ** ${(n+1)*8}${s}`:`>= -(2${s} ** ${(n+1)*8-1}${s}) and < 2 ** ${(n+1)*8-1}${s}`:`>= ${t}${s} and <= ${i}${s}`,new O.ERR_OUT_OF_RANGE("value",r,e)}A(s,"offset"),(void 0===r[s]||void 0===r[s+n])&&$(s,r.length-(n+1))}function A(e,t){if("number"!=typeof e)throw new O.ERR_INVALID_ARG_TYPE(t,"number",e)}function $(e,t,i){if(Math.floor(e)!==e)throw A(e,i),new O.ERR_OUT_OF_RANGE(i||"offset","an integer",e);if(t<0)throw new O.ERR_BUFFER_OUT_OF_BOUNDS;throw new O.ERR_OUT_OF_RANGE(i||"offset",`>= ${+!!i} and <= ${t}`,e)}P("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),P("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),P("ERR_OUT_OF_RANGE",function(e,t,i){let r=`The value of "${e}" is out of range.`,s=i;return Number.isInteger(i)&&Math.abs(i)>0x100000000?s=I(String(i)):"bigint"==typeof i&&(s=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(s=I(s)),s+="n"),r+=` It must be ${t}. Received ${s}`},RangeError);let R=/[^+/0-9A-Za-z-_]/g;function j(e,t){let i;t=t||1/0;let r=e.length,s=null,n=[];for(let o=0;o<r;++o){if((i=e.charCodeAt(o))>55295&&i<57344){if(!s){if(i>56319||o+1===r){(t-=3)>-1&&n.push(239,191,189);continue}s=i;continue}if(i<56320){(t-=3)>-1&&n.push(239,191,189),s=i;continue}i=(s-55296<<10|i-56320)+65536}else s&&(t-=3)>-1&&n.push(239,191,189);if(s=null,i<128){if((t-=1)<0)break;n.push(i)}else if(i<2048){if((t-=2)<0)break;n.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;n.push(i>>12|224,i>>6&63|128,63&i|128)}else if(i<1114112){if((t-=4)<0)break;n.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else throw Error("Invalid code point")}return n}function L(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(R,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,i,r){let s;for(s=0;s<r&&!(s+i>=t.length)&&!(s>=e.length);++s)t[s+i]=e[s];return s}function M(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}let N=function(){let e="0123456789abcdef",t=Array(256);for(let i=0;i<16;++i){let r=16*i;for(let s=0;s<16;++s)t[r+s]=e[i]+e[s]}return t}();function B(e){return"undefined"==typeof BigInt?U:e}function U(){throw Error("BigInt not supported")}},17590:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>nC});var r="undefined"!=typeof window?window:void 0,s="undefined"!=typeof globalThis?globalThis:r,n=Array.prototype,o=n.forEach,a=n.indexOf,l=null==s?void 0:s.navigator,c=null==s?void 0:s.document,u=null==s?void 0:s.location,h=null==s?void 0:s.fetch,d=null!=s&&s.XMLHttpRequest&&"withCredentials"in new s.XMLHttpRequest?s.XMLHttpRequest:void 0,f=null==s?void 0:s.AbortController,p=null==l?void 0:l.userAgent,g=null!=r?r:{},v={DEBUG:!1,LIB_VERSION:"1.246.0"},_="$copy_autocapture",m=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"],y=function(e){return e.GZipJS="gzip-js",e.Base64="base64",e}({}),b=["fatal","error","warning","log","info","debug"];function w(e,t){return -1!==e.indexOf(t)}var k=function(e){return e.trim()},S=function(e){return e.replace(/^\$/,"")},E=Array.isArray,x=Object.prototype,T=x.hasOwnProperty,O=x.toString,P=E||function(e){return"[object Array]"===O.call(e)},I=e=>"function"==typeof e,C=e=>e===Object(e)&&!P(e),A=e=>{if(C(e)){for(var t in e)if(T.call(e,t))return!1;return!0}return!1},$=e=>void 0===e,R=e=>"[object String]"==O.call(e),j=e=>R(e)&&0===e.trim().length,L=e=>null===e,F=e=>$(e)||L(e),M=e=>"[object Number]"==O.call(e),N=e=>"[object Boolean]"===O.call(e),B=e=>e instanceof FormData,U=e=>w(m,e),D=e=>{var t={t:function(t){if(r&&(v.DEBUG||g.POSTHOG_DEBUG)&&!$(r.console)&&r.console){for(var i=("__rrweb_original__"in r.console[t])?r.console[t].__rrweb_original__:r.console[t],s=arguments.length,n=Array(s>1?s-1:0),o=1;o<s;o++)n[o-1]=arguments[o];i(e,...n)}},info:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];t.t("log",...i)},warn:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];t.t("warn",...i)},error:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];t.t("error",...i)},critical:function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];console.error(e,...i)},uninitializedWarning:e=>{t.error("You must initialize PostHog before calling "+e)},createLogger:t=>D(e+" "+t)};return t},q=D("[PostHog.js]"),H=q.createLogger,z=H("[ExternalScriptsLoader]"),G=(e,t,i)=>{if(e.config.disable_external_dependency_loading)return z.warn(t+" was requested but loading of external scripts is disabled."),i("Loading of external scripts is disabled");var r=null==c?void 0:c.querySelectorAll("script");if(r){for(var s=0;s<r.length;s++)if(r[s].src===t)return i()}var n=()=>{if(!c)return i("document not found");var r=c.createElement("script");if(r.type="text/javascript",r.crossOrigin="anonymous",r.src=t,r.onload=e=>i(void 0,e),r.onerror=e=>i(e),e.config.prepare_external_dependency_script&&(r=e.config.prepare_external_dependency_script(r)),!r)return i("prepare_external_dependency_script returned null");var s,n=c.querySelectorAll("body > script");n.length>0?null==(s=n[0].parentNode)||s.insertBefore(r,n[0]):c.body.appendChild(r)};null!=c&&c.body?n():null==c||c.addEventListener("DOMContentLoaded",n)};function W(){return(W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(null,arguments)}function J(e,t){if(null==e)return{};var i={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i}g.__PosthogExtensions__=g.__PosthogExtensions__||{},g.__PosthogExtensions__.loadExternalDependency=(e,t,i)=>{var r="/static/"+t+".js?v="+e.version;"remote-config"===t&&(r="/array/"+e.config.token+"/config.js"),"toolbar"===t&&(r=r+"&t="+3e5*Math.floor(Date.now()/3e5));var s=e.requestRouter.endpointFor("assets",r);G(e,s,i)},g.__PosthogExtensions__.loadSiteApp=(e,t,i)=>{var r=e.requestRouter.endpointFor("api",t);G(e,r,i)};var K={};function V(e,t,i){if(P(e)){if(o&&e.forEach===o)e.forEach(t,i);else if("length"in e&&e.length===+e.length){for(var r=0,s=e.length;r<s;r++)if(r in e&&t.call(i,e[r],r)===K)return}}}function X(e,t,i){if(!F(e)){if(P(e))return V(e,t,i);if(B(e)){for(var r of e.entries())if(t.call(i,r[1],r[0])===K)return}else for(var s in e)if(T.call(e,s)&&t.call(i,e[s],s)===K)return}}var Y=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return V(i,function(t){for(var i in t)void 0!==t[i]&&(e[i]=t[i])}),e},Z=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return V(i,function(t){V(t,function(t){e.push(t)})}),e};function Q(e){for(var t=Object.keys(e),i=t.length,r=Array(i);i--;)r[i]=[t[i],e[t[i]]];return r}var ee=function(e){try{return e()}catch(e){return}},et=function(e){return function(){try{for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.apply(this,i)}catch(e){q.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),q.critical(e)}}},ei=function(e){var t={};return X(e,function(e,i){(R(e)&&e.length>0||M(e))&&(t[i]=e)}),t},er=["herokuapp.com","vercel.app","netlify.app"];function es(e,t){for(var i=0;i<e.length;i++)if(t(e[i]))return e[i]}function en(e,t,i,r){var{capture:s=!1,passive:n=!0}=null!=r?r:{};null==e||e.addEventListener(t,i,{capture:s,passive:n})}var eo="$people_distinct_id",ea="__alias",el="__timers",ec="$autocapture_disabled_server_side",eu="$heatmaps_enabled_server_side",eh="$exception_capture_enabled_server_side",ed="$error_tracking_suppression_rules",ef="$web_vitals_enabled_server_side",ep="$dead_clicks_enabled_server_side",eg="$web_vitals_allowed_metrics",ev="$session_recording_enabled_server_side",e_="$console_log_recording_enabled_server_side",em="$session_recording_network_payload_capture",ey="$session_recording_masking",eb="$session_recording_canvas_recording",ew="$replay_sample_rate",ek="$replay_minimum_duration",eS="$replay_script_config",eE="$sesid",ex="$session_is_sampled",eT="$session_recording_url_trigger_activated_session",eO="$session_recording_event_trigger_activated_session",eP="$enabled_feature_flags",eI="$early_access_features",eC="$feature_flag_details",eA="$stored_person_properties",e$="$stored_group_properties",eR="$surveys",ej="$surveys_activated",eL="$flag_call_reported",eF="$user_state",eM="$client_session_props",eN="$capture_rate_limit",eB="$initial_campaign_params",eU="$initial_referrer_info",eD="$initial_person_info",eq="$epp",eH="__POSTHOG_TOOLBAR__",ez="$posthog_cookieless",eG=[eo,ea,"__cmpns",el,ev,eu,eE,eP,ed,eF,eI,eC,e$,eA,eR,eL,eM,eN,eB,eU,eq,eD];function eW(e){return e instanceof Element&&(e.id===eH||!(null==e.closest||!e.closest(".toolbar-global-fade-container")))}function eJ(e){return!!e&&1===e.nodeType}function eK(e,t){return!!e&&!!e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function eV(e){return!!e&&3===e.nodeType}function eX(e){return!!e&&11===e.nodeType}function eY(e){return e?k(e).split(/\s+/):[]}function eZ(e){var t=null==r?void 0:r.location.href;return!!(t&&e&&e.some(e=>t.match(e)))}function eQ(e){var t="";switch(typeof e.className){case"string":t=e.className;break;case"object":t=(e.className&&"baseVal"in e.className?e.className.baseVal:null)||e.getAttribute("class")||"";break;default:t=""}return eY(t)}function e0(e){return F(e)?null:k(e).split(/(\s+)/).filter(e=>tr(e)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function e1(e){var t="";return e6(e)&&!e8(e)&&e.childNodes&&e.childNodes.length&&X(e.childNodes,function(e){var i;eV(e)&&e.textContent&&(t+=null!=(i=e0(e.textContent))?i:"")}),k(t)}function e2(e){var t;return $(e.target)?e.srcElement||null:null!=(t=e.target)&&t.shadowRoot?e.composedPath()[0]||null:e.target||null}var e5=["a","button","form","input","select","textarea","label"];function e3(e){var t=e.parentNode;return!(!t||!eJ(t))&&t}function e6(e){for(var t=e;t.parentNode&&!eK(t,"body");t=t.parentNode){var i=eQ(t);if(w(i,"ph-sensitive")||w(i,"ph-no-capture"))return!1}if(w(eQ(e),"ph-include"))return!0;var r=e.type||"";if(R(r))switch(r.toLowerCase()){case"hidden":case"password":return!1}var s=e.name||e.id||"";return!(R(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function e8(e){return!!(eK(e,"input")&&!["button","checkbox","submit","reset"].includes(e.type)||eK(e,"select")||eK(e,"textarea")||"true"===e.getAttribute("contenteditable"))}var e4="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",e7=RegExp("^(?:"+e4+")$"),e9=new RegExp(e4),te="\\d{3}-?\\d{2}-?\\d{4}",tt=RegExp("^("+te+")$"),ti=RegExp("("+te+")");function tr(e,t){return void 0===t&&(t=!0),!(F(e)||R(e)&&(e=k(e),(t?e7:e9).test((e||"").replace(/[- ]/g,""))||(t?tt:ti).test(e)))&&!0}function ts(e){var t=e1(e);return tr(t=(t+" "+function e(t){var i="";return t&&t.childNodes&&t.childNodes.length&&X(t.childNodes,function(t){var r;if(t&&"span"===(null==(r=t.tagName)?void 0:r.toLowerCase()))try{var s=e1(t);i=(i+" "+s).trim(),t.childNodes&&t.childNodes.length&&(i=(i+" "+e(t)).trim())}catch(e){q.error("[AutoCapture]",e)}}),i}(e)).trim())?t:""}function tn(e){return e.replace(/"|\\"/g,'\\"')}class to{constructor(){this.clicks=[]}isRageClick(e,t,i){var r=this.clicks[this.clicks.length-1];if(r&&Math.abs(e-r.x)+Math.abs(t-r.y)<30&&i-r.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:i}),3===this.clicks.length)return!0}else this.clicks=[{x:e,y:t,timestamp:i}];return!1}}var ta=["localhost","127.0.0.1"],tl=e=>{var t=null==c?void 0:c.createElement("a");return $(t)?null:(t.href=e,t)},tc=function(e,t){void 0===t&&(t="&");var i,r,s=[];return X(e,function(e,t){$(e)||$(t)||"undefined"===t||(i=encodeURIComponent(e instanceof File?e.name:e.toString()),r=encodeURIComponent(t),s[s.length]=r+"="+i)}),s.join(t)},tu=function(e,t){for(var i,r=((e.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<r.length;s++){var n=r[s].split("=");if(n[0]===t){i=n;break}}if(!P(i)||i.length<2)return"";var o=i[1];try{o=decodeURIComponent(o)}catch(e){q.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},th=function(e,t,i){if(!e||!t||!t.length)return e;for(var r=e.split("#"),s=r[0]||"",n=r[1],o=s.split("?"),a=o[1],l=o[0],c=(a||"").split("&"),u=[],h=0;h<c.length;h++){var d=c[h].split("=");P(d)&&(t.includes(d[0])?u.push(d[0]+"="+i):u.push(c[h]))}var f=l;return null!=a&&(f+="?"+u.join("&")),null!=n&&(f+="#"+n),f},td=function(e,t){var i=e.match(RegExp(t+"=([^&]*)"));return i?i[1]:null},tf=H("[AutoCapture]");function tp(e,t){return t.length>e?t.slice(0,e)+"...":t}class tg{constructor(e){this.i=!1,this.o=null,this.rageclicks=new to,this.h=!1,this.instance=e,this.m=null}get S(){var e,t,i=C(this.instance.config.autocapture)?this.instance.config.autocapture:{};return i.url_allowlist=null==(e=i.url_allowlist)?void 0:e.map(e=>new RegExp(e)),i.url_ignorelist=null==(t=i.url_ignorelist)?void 0:t.map(e=>new RegExp(e)),i}$(){if(this.isBrowserSupported()){if(r&&c){var e=e=>{e=e||(null==r?void 0:r.event);try{this.k(e)}catch(e){tf.error("Failed to capture event",e)}};if(en(c,"submit",e,{capture:!0}),en(c,"change",e,{capture:!0}),en(c,"click",e,{capture:!0}),this.S.capture_copied_text){var t=e=>{e=e||(null==r?void 0:r.event),this.k(e,_)};en(c,"copy",t,{capture:!0}),en(c,"cut",t,{capture:!0})}}}else tf.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.i&&(this.$(),this.i=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.h=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[ec]:!!e.autocapture_opt_out}),this.o=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.m=e}getElementSelectors(e){var t,i=[];return null==(t=this.m)||t.forEach(t=>{var r=null==c?void 0:c.querySelectorAll(t);null==r||r.forEach(r=>{e===r&&i.push(t)})}),i}get isEnabled(){var e,t,i=null==(e=this.instance.persistence)?void 0:e.props[ec];if(L(this.o)&&!N(i)&&!this.instance.config.advanced_disable_decide)return!1;var r=null!=(t=this.o)?t:!!i;return!!this.instance.config.autocapture&&!r}k(e,t){if(void 0===t&&(t="$autocapture"),this.isEnabled){var i,s=e2(e);eV(s)&&(s=s.parentNode||null),"$autocapture"===t&&"click"===e.type&&e instanceof MouseEvent&&this.instance.config.rageclick&&null!=(i=this.rageclicks)&&i.isRageClick(e.clientX,e.clientY,(new Date).getTime())&&this.k(e,"$rageclick");var n=t===_;if(s&&function(e,t,i,s,n){if(void 0===i&&(i=void 0),!r||!e||eK(e,"html")||!eJ(e)||null!=(o=i)&&o.url_allowlist&&!eZ(i.url_allowlist)||null!=(a=i)&&a.url_ignorelist&&eZ(i.url_ignorelist))return!1;if(null!=(l=i)&&l.dom_event_allowlist){var o,a,l,c=i.dom_event_allowlist;if(c&&!c.some(e=>t.type===e))return!1}for(var u=!1,h=[e],d=!0,f=e;f.parentNode&&!eK(f,"body");)if(eX(f.parentNode))h.push(f.parentNode.host),f=f.parentNode.host;else{if(!(d=e3(f)))break;if(s||e5.indexOf(d.tagName.toLowerCase())>-1)u=!0;else{var p=r.getComputedStyle(d);p&&"pointer"===p.getPropertyValue("cursor")&&(u=!0)}h.push(d),f=d}if(!function(e,t){var i=null==t?void 0:t.element_allowlist;if($(i))return!0;var r,s=function(e){if(i.some(t=>e.tagName.toLowerCase()===t))return{v:!0}};for(var n of e)if(r=s(n))return r.v;return!1}(h,i)||!function(e,t){var i=null==t?void 0:t.css_selector_allowlist;if($(i))return!0;var r,s=function(e){if(i.some(t=>e.matches(t)))return{v:!0}};for(var n of e)if(r=s(n))return r.v;return!1}(h,i))return!1;var g=r.getComputedStyle(e);if(g&&"pointer"===g.getPropertyValue("cursor")&&"click"===t.type)return!0;var v=e.tagName.toLowerCase();switch(v){case"html":return!1;case"form":return(n||["submit"]).indexOf(t.type)>=0;case"input":case"select":case"textarea":return(n||["change","click"]).indexOf(t.type)>=0;default:return u?(n||["click"]).indexOf(t.type)>=0:(n||["click"]).indexOf(t.type)>=0&&(e5.indexOf(v)>-1||"true"===e.getAttribute("contenteditable"))}}(s,e,this.S,n,n?["copy","cut"]:void 0)){var{props:o,explicitNoCapture:a}=function(e,t){for(var i,s,{e:n,maskAllElementAttributes:o,maskAllText:a,elementAttributeIgnoreList:l,elementsChainAsString:c}=t,u=[e],h=e;h.parentNode&&!eK(h,"body");)eX(h.parentNode)?(u.push(h.parentNode.host),h=h.parentNode.host):(u.push(h.parentNode),h=h.parentNode);var d,f=[],p={},g=!1,v=!1;if(X(u,e=>{var t=e6(e);"a"===e.tagName.toLowerCase()&&(g=e.getAttribute("href"),g=t&&g&&tr(g)&&g),w(eQ(e),"ph-no-capture")&&(v=!0),f.push(function(e,t,i,r){var s=e.tagName.toLowerCase(),n={tag_name:s};e5.indexOf(s)>-1&&!i&&("a"===s.toLowerCase()||"button"===s.toLowerCase()?n.$el_text=tp(1024,ts(e)):n.$el_text=tp(1024,e1(e)));var o=eQ(e);o.length>0&&(n.classes=o.filter(function(e){return""!==e})),X(e.attributes,function(i){var s;if((!e8(e)||-1!==["name","id","class","aria-label"].indexOf(i.name))&&(null==r||!r.includes(i.name))&&!t&&tr(i.value)&&(!R(s=i.name)||"_ngcontent"!==s.substring(0,10)&&"_nghost"!==s.substring(0,7))){var o=i.value;"class"===i.name&&(o=eY(o).join(" ")),n["attr__"+i.name]=tp(1024,o)}});for(var a=1,l=1,c=e;c=function(e){if(e.previousElementSibling)return e.previousElementSibling;var t=e;do t=t.previousSibling;while(t&&!eJ(t));return t}(c);)a++,c.tagName===e.tagName&&l++;return n.nth_child=a,n.nth_of_type=l,n}(e,o,a,l)),Y(p,function(e){if(!e6(e))return{};var t={};return X(e.attributes,function(e){if(e.name&&0===e.name.indexOf("data-ph-capture-attribute")){var i=e.name.replace("data-ph-capture-attribute-",""),r=e.value;i&&r&&tr(r)&&(t[i]=r)}}),t}(e))}),v)return{props:{},explicitNoCapture:v};if(a||("a"===e.tagName.toLowerCase()||"button"===e.tagName.toLowerCase()?f[0].$el_text=ts(e):f[0].$el_text=e1(e)),g){f[0].attr__href=g;var _,m,y=null==(_=tl(g))?void 0:_.host,b=null==r||null==(m=r.location)?void 0:m.host;y&&b&&y!==b&&(d=g)}return{props:Y({$event_type:n.type,$ce_version:1},c?{}:{$elements:f},{$elements_chain:f.map(e=>{var t,i,r,s={text:null==(i=e.$el_text)?void 0:i.slice(0,400),tag_name:e.tag_name,href:null==(r=e.attr__href)?void 0:r.slice(0,2048),attr_class:(t=e.attr__class)?P(t)?t:eY(t):void 0,attr_id:e.attr__id,nth_child:e.nth_child,nth_of_type:e.nth_of_type,attributes:{}};return Q(e).filter(e=>{var[t]=e;return 0===t.indexOf("attr__")}).forEach(e=>{var[t,i]=e;return s.attributes[t]=i}),s}).map(e=>{var t,i,r="";if(e.tag_name&&(r+=e.tag_name),e.attr_class)for(var s of(e.attr_class.sort(),e.attr_class))r+="."+s.replace(/"/g,"");var n=W({},e.text?{text:e.text}:{},{"nth-child":null!=(t=e.nth_child)?t:0,"nth-of-type":null!=(i=e.nth_of_type)?i:0},e.href?{href:e.href}:{},e.attr_id?{attr_id:e.attr_id}:{},e.attributes),o={};return Q(n).sort((e,t)=>{var[i]=e,[r]=t;return i.localeCompare(r)}).forEach(e=>{var[t,i]=e;return o[tn(t.toString())]=tn(i.toString())}),r+=":",r+=Q(o).map(e=>{var[t,i]=e;return t+'="'+i+'"'}).join("")}).join(";")},null!=(i=f[0])&&i.$el_text?{$el_text:null==(s=f[0])?void 0:s.$el_text}:{},d&&"click"===n.type?{$external_click_url:d}:{},p)}}(s,{e:e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.S.element_attribute_ignorelist,elementsChainAsString:this.h});if(a)return!1;var l=this.getElementSelectors(s);if(l&&l.length>0&&(o.$element_selectors=l),t===_){var c,u=e0(null==r||null==(c=r.getSelection())?void 0:c.toString()),h=e.type||"clipboard";if(!u)return!1;o.$selected_content=u,o.$copy_type=h}return this.instance.capture(t,o),!0}}}isBrowserSupported(){return I(null==c?void 0:c.querySelectorAll)}}Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Number.isInteger||(Number.isInteger=function(e){return M(e)&&isFinite(e)&&Math.floor(e)===e});var tv="0123456789abcdef";class t_{constructor(e){if(this.bytes=e,16!==e.length)throw TypeError("not 128-bit length")}static fromFieldsV7(e,t,i,r){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(i)||!Number.isInteger(r)||e<0||t<0||i<0||r<0||e>0xffffffffffff||t>4095||i>0x3fffffff||r>0xffffffff)throw RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=e/0x10000000000,s[1]=e/0x100000000,s[2]=e/0x1000000,s[3]=e/65536,s[4]=e/256,s[5]=e,s[6]=112|t>>>8,s[7]=t,s[8]=128|i>>>24,s[9]=i>>>16,s[10]=i>>>8,s[11]=i,s[12]=r>>>24,s[13]=r>>>16,s[14]=r>>>8,s[15]=r,new t_(s)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+tv.charAt(this.bytes[t]>>>4)+tv.charAt(15&this.bytes[t]),3!==t&&5!==t&&7!==t&&9!==t||(e+="-");if(36!==e.length)throw Error("Invalid UUIDv7 was generated");return e}clone(){return new t_(this.bytes.slice(0))}equals(e){return 0===this.compareTo(e)}compareTo(e){for(var t=0;t<16;t++){var i=this.bytes[t]-e.bytes[t];if(0!==i)return Math.sign(i)}return 0}}class tm{constructor(){this.I=0,this.P=0,this.R=new tw}generate(){var e=this.generateOrAbort();if($(e)){this.I=0;var t=this.generateOrAbort();if($(t))throw Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.I)this.I=e,this.T();else{if(!(e+1e4>this.I))return;this.P++,this.P>0x3ffffffffff&&(this.I++,this.T())}return t_.fromFieldsV7(this.I,Math.trunc(this.P/0x40000000),0x3fffffff&this.P,this.R.nextUint32())}T(){this.P=1024*this.R.nextUint32()+(1023&this.R.nextUint32())}}var ty,tb=e=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");for(var t=0;t<e.length;t++)e[t]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return e};r&&!$(r.crypto)&&crypto.getRandomValues&&(tb=e=>crypto.getRandomValues(e));class tw{constructor(){this.M=new Uint32Array(8),this.C=1/0}nextUint32(){return this.C>=this.M.length&&(tb(this.M),this.C=0),this.M[this.C++]}}var tk=()=>tS().toString(),tS=()=>(ty||(ty=new tm)).generate(),tE="",tx=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,tT={O:()=>!!c,F:function(e){q.error("cookieStore error: "+e)},A:function(e){if(c){try{for(var t=e+"=",i=c.cookie.split(";").filter(e=>e.length),r=0;r<i.length;r++){for(var s=i[r];" "==s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(t))return decodeURIComponent(s.substring(t.length,s.length))}}catch(e){}return null}},D:function(e){var t;try{t=JSON.parse(tT.A(e))||{}}catch(e){}return t},L:function(e,t,i,r,s){if(c)try{var n="",o="",a=function(e,t){if(t){var i=function(e,t){if(void 0===t&&(t=c),tE)return tE;if(!t||["localhost","127.0.0.1"].includes(e))return"";for(var i=e.split("."),r=Math.min(i.length,8),s="dmn_chk_"+tk();!tE&&r--;){var n=i.slice(r).join("."),o=s+"=1;domain=."+n+";path=/";t.cookie=o+";max-age=3",t.cookie.includes(s)&&(t.cookie=o+";max-age=0",tE=n)}return tE}(e);if(!i){var r,s=(r=e.match(tx))?r[0]:"";s!==i&&q.info("Warning: cookie subdomain discovery mismatch",s,i),i=s}return i?"; domain=."+i:""}return""}(c.location.hostname,r);if(i){var l=new Date;l.setTime(l.getTime()+24*i*36e5),n="; expires="+l.toUTCString()}s&&(o="; secure");var u=e+"="+encodeURIComponent(JSON.stringify(t))+n+"; SameSite=Lax; path=/"+a+o;return u.length>3686.4&&q.warn("cookieStore warning: large cookie, len="+u.length),c.cookie=u,u}catch(e){return}},N:function(e,t){try{tT.L(e,"",-1,t)}catch(e){return}}},tO=null,tP={O:function(){if(!L(tO))return tO;var e=!0;if($(r))e=!1;else try{var t="__mplssupport__";tP.L(t,"xyz"),'"xyz"'!==tP.A(t)&&(e=!1),tP.N(t)}catch(t){e=!1}return e||q.error("localStorage unsupported; falling back to cookie store"),tO=e,e},F:function(e){q.error("localStorage error: "+e)},A:function(e){try{return null==r?void 0:r.localStorage.getItem(e)}catch(e){tP.F(e)}return null},D:function(e){try{return JSON.parse(tP.A(e))||{}}catch(e){}return null},L:function(e,t){try{null==r||r.localStorage.setItem(e,JSON.stringify(t))}catch(e){tP.F(e)}},N:function(e){try{null==r||r.localStorage.removeItem(e)}catch(e){tP.F(e)}}},tI=["distinct_id",eE,ex,eq,eD],tC=W({},tP,{D:function(e){try{var t={};try{t=tT.D(e)||{}}catch(e){}var i=Y(t,JSON.parse(tP.A(e)||"{}"));return tP.L(e,i),i}catch(e){}return null},L:function(e,t,i,r,s,n){try{tP.L(e,t,void 0,void 0,n);var o={};tI.forEach(e=>{t[e]&&(o[e]=t[e])}),Object.keys(o).length&&tT.L(e,o,i,r,s,n)}catch(e){tP.F(e)}},N:function(e,t){try{null==r||r.localStorage.removeItem(e),tT.N(e,t)}catch(e){tP.F(e)}}}),tA={},t$={O:function(){return!0},F:function(e){q.error("memoryStorage error: "+e)},A:function(e){return tA[e]||null},D:function(e){return tA[e]||null},L:function(e,t){tA[e]=t},N:function(e){delete tA[e]}},tR=null,tj={O:function(){if(!L(tR))return tR;if(tR=!0,$(r))tR=!1;else try{var e="__support__";tj.L(e,"xyz"),'"xyz"'!==tj.A(e)&&(tR=!1),tj.N(e)}catch(e){tR=!1}return tR},F:function(e){q.error("sessionStorage error: ",e)},A:function(e){try{return null==r?void 0:r.sessionStorage.getItem(e)}catch(e){tj.F(e)}return null},D:function(e){try{return JSON.parse(tj.A(e))||null}catch(e){}return null},L:function(e,t){try{null==r||r.sessionStorage.setItem(e,JSON.stringify(t))}catch(e){tj.F(e)}},N:function(e){try{null==r||r.sessionStorage.removeItem(e)}catch(e){tj.F(e)}}},tL=function(e){return e[e.PENDING=-1]="PENDING",e[e.DENIED=0]="DENIED",e[e.GRANTED=1]="GRANTED",e}({});class tF{constructor(e){this._instance=e}get S(){return this._instance.config}get consent(){return this.j()?tL.DENIED:this.U}isOptedOut(){return this.consent===tL.DENIED||this.consent===tL.PENDING&&this.S.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(e){this.q.L(this.B,+!!e,this.S.cookie_expiration,this.S.cross_subdomain_cookie,this.S.secure_cookie)}reset(){this.q.N(this.B,this.S.cross_subdomain_cookie)}get B(){var{token:e,opt_out_capturing_cookie_prefix:t}=this._instance.config;return(t||"__ph_opt_in_out_")+e}get U(){var e=this.q.A(this.B);return"1"===e?tL.GRANTED:"0"===e?tL.DENIED:tL.PENDING}get q(){if(!this.H){var e=this.S.opt_out_capturing_persistence_type;this.H="localStorage"===e?tP:tT;var t="localStorage"===e?tT:tP;t.A(this.B)&&(this.H.A(this.B)||this.optInOut("1"===t.A(this.B)),t.N(this.B,this.S.cross_subdomain_cookie))}return this.H}j(){return!!this.S.respect_dnt&&!!es([null==l?void 0:l.doNotTrack,null==l?void 0:l.msDoNotTrack,g.doNotTrack],e=>w([!0,1,"1","yes"],e))}}var tM=H("[Dead Clicks]"),tN=()=>!0,tB=e=>{var t,i=!(null==(t=e.instance.persistence)||!t.get_property(ep)),r=e.instance.config.capture_dead_clicks;return N(r)?r:i};class tU{get lazyLoadedDeadClicksAutocapture(){return this.W}constructor(e,t,i){this.instance=e,this.isEnabled=t,this.onCapture=i,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[ep]:null==e?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.G(()=>{this.J()})}G(e){var t,i;null!=(t=g.__PosthogExtensions__)&&t.initDeadClicksAutocapture&&e(),null==(i=g.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this.instance,"dead-clicks-autocapture",t=>{t?tM.error("failed to load script",t):e()})}J(){var e;if(c){if(!this.W&&null!=(e=g.__PosthogExtensions__)&&e.initDeadClicksAutocapture){var t=C(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.W=g.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.W.start(c),tM.info("starting...")}}else tM.error("`document` not found. Cannot start.")}stop(){this.W&&(this.W.stop(),this.W=void 0,tM.info("stopping..."))}}var tD=H("[ExceptionAutocapture]");class tq{constructor(e){var t;this.V=()=>{var e;if(r&&this.isEnabled&&null!=(e=g.__PosthogExtensions__)&&e.errorWrappingFunctions){var t=g.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,i=g.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,s=g.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.K&&this.S.capture_unhandled_errors&&(this.K=t(this.captureException.bind(this))),!this.Y&&this.S.capture_unhandled_rejections&&(this.Y=i(this.captureException.bind(this))),!this.X&&this.S.capture_console_errors&&(this.X=s(this.captureException.bind(this)))}catch(e){tD.error("failed to start",e),this.Z()}}},this._instance=e,this.tt=!(null==(t=this._instance.persistence)||!t.props[eh]),this.S=this.it(),this.startIfEnabled()}it(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return C(e)?t=W({},t,e):($(e)?this.tt:e)&&(t=W({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.S.capture_console_errors||this.S.capture_unhandled_errors||this.S.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(tD.info("enabled"),this.G(this.V))}G(e){var t,i;null!=(t=g.__PosthogExtensions__)&&t.errorWrappingFunctions&&e(),null==(i=g.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"exception-autocapture",t=>{if(t)return tD.error("failed to load script",t);e()})}Z(){var e,t,i;null==(e=this.K)||e.call(this),this.K=void 0,null==(t=this.Y)||t.call(this),this.Y=void 0,null==(i=this.X)||i.call(this),this.X=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.tt=!!t,this.S=this.it(),this._instance.persistence&&this._instance.persistence.register({[eh]:this.tt}),this.startIfEnabled()}captureException(e){e.$exception_personURL=this._instance.requestRouter.endpointFor("ui")+"/project/"+this._instance.config.token+"/person/"+this._instance.get_distinct_id(),this._instance.exceptions.sendExceptionEvent(e)}}function tH(e){return!$(Event)&&tz(e,Event)}function tz(e,t){try{return e instanceof t}catch(e){return!1}}function tG(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object DOMError]":return!0;default:return tz(e,Error)}}function tW(e,t){return Object.prototype.toString.call(e)==="[object "+t+"]"}function tJ(e){return tW(e,"DOMError")}var tK=/\(error: (.*)\)/;function tV(e,t,i,r){var s={platform:"web:javascript",filename:e,function:"<anonymous>"===t?"?":t,in_app:!0};return $(i)||(s.lineno=i),$(r)||(s.colno=r),s}var tX,tY,tZ,tQ=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,t0=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,t1=/\((\S*)(?::(\d+))(?::(\d+))\)/,t2=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,t5=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,t3=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=t.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return function(e,t){void 0===t&&(t=0);for(var i=[],s=e.split("\n"),n=t;n<s.length;n++){var o=s[n];if(!(o.length>1024)){var a=tK.test(o)?o.replace(tK,"$1"):o;if(!a.match(/\S*Error: /)){for(var l of r){var c=l(a);if(c){i.push(c);break}}if(i.length>=50)break}}}if(!i.length)return[];var u=Array.from(i);return u.reverse(),u.slice(0,50).map(e=>{var t;return W({},e,{filename:e.filename||((t=u)[t.length-1]||{}).filename,function:e.function||"?"})})}}([30,e=>{var t=tQ.exec(e);if(t){var[,i,r,s]=t;return tV(i,"?",+r,+s)}var n=t0.exec(e);if(n){if(n[2]&&0===n[2].indexOf("eval")){var o=t1.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}var[a,l]=t6(n[1]||"?",n[2]);return tV(l,a,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}}],[50,e=>{var t=t2.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var i=t5.exec(t[3]);i&&(t[1]=t[1]||"eval",t[3]=i[1],t[4]=i[2],t[5]="")}var r=t[3],s=t[1]||"?";return[s,r]=t6(s,r),tV(r,s,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]),t6=(e,t)=>{var i=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return i||r?[-1!==e.indexOf("@")?e.split("@")[0]:"?",i?"safari-extension:"+t:"safari-web-extension:"+t]:[e,t]},t8=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;function t4(e,t){void 0===t&&(t=0);var i=e.stacktrace||e.stack||"",r=e&&t7.test(e.message)?1:0;try{var s,n,o=(s=t3(i,r),n=function(e){var t=globalThis._posthogChunkIds;if(!t)return{};var i=Object.keys(t);return tZ&&i.length===tY||(tY=i.length,tZ=i.reduce((i,r)=>{tX||(tX={});var s=tX[r];if(s)i[s[0]]=s[1];else for(var n=e(r),o=n.length-1;o>=0;o--){var a=n[o],l=null==a?void 0:a.filename,c=t[r];if(l&&c){i[l]=c,tX[r]=[l,c];break}}return i},{})),tZ}(t3),s.forEach(e=>{e.filename&&(e.chunk_id=n[e.filename])}),s);return o.slice(0,o.length-t)}catch(e){}return[]}var t7=/Minified React error #\d+;/i;function t9(e,t){return{$exception_list:function e(t,i){var r,s,n,o,a,l,c,u,h=(r=t,s=i,l=t4(r),c=null==(o=null==s?void 0:s.handled)||o,u=null!=(a=null==s?void 0:s.synthetic)&&a,{type:null!=s&&s.overrideExceptionType?s.overrideExceptionType:r.name,value:(n=r.message).error&&"string"==typeof n.error.message?String(n.error.message):String(n),stacktrace:{frames:l,type:"raw"},mechanism:{handled:c,synthetic:u}});return t.cause&&tG(t.cause)&&t.cause!==t?[h,...e(t.cause,{handled:null==i?void 0:i.handled,synthetic:null==i?void 0:i.synthetic})]:[h]}(e,t),$exception_level:"error"}}function ie(e,t){var i,r,s,n=null==(i=null==t?void 0:t.handled)||i,o=null==(r=null==t?void 0:t.synthetic)||r,a={type:null!=t&&t.overrideExceptionType?t.overrideExceptionType:null!=(s=null==t?void 0:t.defaultExceptionType)?s:"Error",value:e||(null==t?void 0:t.defaultExceptionMessage),mechanism:{handled:n,synthetic:o}};if(null!=t&&t.syntheticException){var l=t4(t.syntheticException,1);l.length&&(a.stacktrace={frames:l,type:"raw"})}return{$exception_list:[a],$exception_level:"error"}}function it(e,t,i){try{if(!(t in e))return()=>{};var r=e[t],s=i(r);return I(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),e[t]=s,()=>{e[t]=r}}catch(e){return()=>{}}}class ii{constructor(e){var t;this._instance=e,this.et=(null==r||null==(t=r.location)?void 0:t.pathname)||""}get isEnabled(){return"history_change"===this._instance.config.capture_pageview}startIfEnabled(){this.isEnabled&&(q.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.rt&&this.rt(),this.rt=void 0,q.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(r&&r.history){var i=this;null!=(e=r.history.pushState)&&e.__posthog_wrapped__||it(r.history,"pushState",e=>function(t,r,s){e.call(this,t,r,s),i.st("pushState")}),null!=(t=r.history.replaceState)&&t.__posthog_wrapped__||it(r.history,"replaceState",e=>function(t,r,s){e.call(this,t,r,s),i.st("replaceState")}),this.nt()}}st(e){try{var t,i=null==r||null==(t=r.location)?void 0:t.pathname;if(!i)return;i!==this.et&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.et=i}catch(t){q.error("Error capturing "+e+" pageview",t)}}nt(){if(!this.rt){var e=()=>{this.st("popstate")};en(r,"popstate",e),this.rt=()=>{r&&r.removeEventListener("popstate",e)}}}}function ir(e){var t,i;return(null==(t=JSON.stringify(e,(i=[],function(e,t){if(C(t)){for(;i.length>0&&i[i.length-1]!==this;)i.pop();return i.includes(t)?"[Circular]":(i.push(t),t)}return t})))?void 0:t.length)||0}var is=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(is||{}),io=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(io||{}),ia="[SessionRecording]",il="redacted",ic={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:e=>e,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},iu=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],ih=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],id=["/s/","/e/","/i/"];function ip(e,t,i,r){if(F(e))return e;var s=(null==t?void 0:t["content-length"])||new Blob([e]).size;return R(s)&&(s=parseInt(s)),s>i?ia+" "+r+" body too large to record ("+s+" bytes)":e}function ig(e,t){if(F(e))return e;var i=e;return tr(i,!1)||(i=ia+" "+t+" body "+il),X(ih,e=>{var r,s;null!=(r=i)&&r.length&&-1!==(null==(s=i)?void 0:s.indexOf(e))&&(i=ia+" "+t+" body "+il+" as might contain: "+e)}),i}var iv=(e,t)=>{var i,r,s={payloadSizeLimitBytes:ic.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...ic.performanceEntryTypeToObserve],payloadHostDenyList:[...t.payloadHostDenyList||[],...ic.payloadHostDenyList]},n=!1!==e.session_recording.recordHeaders&&t.recordHeaders,o=!1!==e.session_recording.recordBody&&t.recordBody,a=!1!==e.capture_performance&&t.recordPerformance,l=(r=Math.min(1e6,null!=(i=s.payloadSizeLimitBytes)?i:1e6),e=>(null!=e&&e.requestBody&&(e.requestBody=ip(e.requestBody,e.requestHeaders,r,"Request")),null!=e&&e.responseBody&&(e.responseBody=ip(e.responseBody,e.responseHeaders,r,"Response")),e)),c=t=>{var i;return l(((e,t)=>{var i,r=tl(e.name),s=0===t.indexOf("http")?null==(i=tl(t))?void 0:i.pathname:t;"/"===s&&(s="");var n=null==r?void 0:r.pathname.replace(s||"","");if(!(r&&n&&id.some(e=>0===n.indexOf(e))))return e})((F(i=t.requestHeaders)||X(Object.keys(null!=i?i:{}),e=>{iu.includes(e.toLowerCase())&&(i[e]=il)}),t),e.api_host))},u=I(e.session_recording.maskNetworkRequestFn);return u&&I(e.session_recording.maskCapturedNetworkRequestFn)&&q.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),u&&(e.session_recording.maskCapturedNetworkRequestFn=t=>{var i=e.session_recording.maskNetworkRequestFn({url:t.name});return W({},t,{name:null==i?void 0:i.url})}),s.maskRequestFn=I(e.session_recording.maskCapturedNetworkRequestFn)?t=>{var i,r=c(t);return r&&null!=(i=null==e.session_recording.maskCapturedNetworkRequestFn?void 0:e.session_recording.maskCapturedNetworkRequestFn(r))?i:void 0}:e=>(function(e){if(!$(e))return e.requestBody=ig(e.requestBody,"Request"),e.responseBody=ig(e.responseBody,"Response"),e})(c(e)),W({},ic,s,{recordHeaders:n,recordBody:o,recordPerformance:a,recordInitialRequests:a})};function i_(e,t,i,r,s){return t>i&&(q.warn("min cannot be greater than max."),t=i),M(e)?e>i?(r&&q.warn(r+" cannot be  greater than max: "+i+". Using max value instead."),i):e<t?(r&&q.warn(r+" cannot be less than min: "+t+". Using min value instead."),t):e:(r&&q.warn(r+" must be a number. using max or fallback. max: "+i+", fallback: "+s),i_(s||i,t,i,r))}class im{constructor(e,t){var i,r;void 0===t&&(t={}),this.ot=100,this.lt=10,this.ut={},this.ht={},this.dt=()=>{Object.keys(this.ut).forEach(e=>{this.ut[e]=this.ut[e]+this.lt,this.ut[e]>=this.ot&&delete this.ut[e]})},this.vt=e=>{var t=this._rrweb.mirror.getNode(e);if("svg"!==(null==t?void 0:t.nodeName)&&t instanceof Element){var i=t.closest("svg");if(i)return[this._rrweb.mirror.getId(i),i]}return[e,t]},this.ct=e=>{var t,i,r,s,n,o,a,l;return(null!=(t=null==(i=e.removes)?void 0:i.length)?t:0)+(null!=(r=null==(s=e.attributes)?void 0:s.length)?r:0)+(null!=(n=null==(o=e.texts)?void 0:o.length)?n:0)+(null!=(a=null==(l=e.adds)?void 0:l.length)?a:0)},this.throttleMutations=e=>{if(3!==e.type||0!==e.data.source)return e;var t=e.data,i=this.ct(t);t.attributes&&(t.attributes=t.attributes.filter(e=>{var t,i,r,[s,n]=this.vt(e.id);return 0!==this.ut[s]&&(this.ut[s]=null!=(t=this.ut[s])?t:this.ot,this.ut[s]=Math.max(this.ut[s]-1,0),0===this.ut[s]&&(this.ht[s]||(this.ht[s]=!0,null==(i=(r=this.ft).onBlockedNode)||i.call(r,s,n))),e)}));var r=this.ct(t);return 0!==r||i===r?e:void 0},this._rrweb=e,this.ft=t,this.lt=i_(null!=(i=this.ft.refillRate)?i:this.lt,0,100,"mutation throttling refill rate"),this.ot=i_(null!=(r=this.ft.bucketSize)?r:this.ot,0,100,"mutation throttling bucket size"),setInterval(()=>{this.dt()},1e3)}}var iy=Uint8Array,ib=Uint16Array,iw=Uint32Array,ik=new iy([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),iS=new iy([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),iE=new iy([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ix=function(e,t){for(var i=new ib(31),r=0;r<31;++r)i[r]=t+=1<<e[r-1];var s=new iw(i[30]);for(r=1;r<30;++r)for(var n=i[r];n<i[r+1];++n)s[n]=n-i[r]<<5|r;return[i,s]},iT=ix(ik,2),iO=iT[0],iP=iT[1];iO[28]=258,iP[258]=28;for(var iI=ix(iS,0)[1],iC=new ib(32768),iA=0;iA<32768;++iA){var i$=(43690&iA)>>>1|(21845&iA)<<1;i$=(61680&(i$=(52428&i$)>>>2|(13107&i$)<<2))>>>4|(3855&i$)<<4,iC[iA]=((65280&i$)>>>8|(255&i$)<<8)>>>1}var iR=function(e,t,i){for(var r=e.length,s=0,n=new ib(t);s<r;++s)++n[e[s]-1];var o,a=new ib(t);for(s=0;s<t;++s)a[s]=a[s-1]+n[s-1]<<1;if(i){o=new ib(1<<t);var l=15-t;for(s=0;s<r;++s)if(e[s])for(var c=s<<4|e[s],u=t-e[s],h=a[e[s]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)o[iC[h]>>>l]=c}else for(o=new ib(r),s=0;s<r;++s)o[s]=iC[a[e[s]-1]++]>>>15-e[s];return o},ij=new iy(288);for(iA=0;iA<144;++iA)ij[iA]=8;for(iA=144;iA<256;++iA)ij[iA]=9;for(iA=256;iA<280;++iA)ij[iA]=7;for(iA=280;iA<288;++iA)ij[iA]=8;var iL=new iy(32);for(iA=0;iA<32;++iA)iL[iA]=5;var iF=iR(ij,9,0),iM=iR(iL,5,0),iN=function(e){return(e/8|0)+(7&e&&1)},iB=function(e,t,i){(null==i||i>e.length)&&(i=e.length);var r=new(e instanceof ib?ib:e instanceof iw?iw:iy)(i-t);return r.set(e.subarray(t,i)),r},iU=function(e,t,i){i<<=7&t;var r=t/8|0;e[r]|=i,e[r+1]|=i>>>8},iD=function(e,t,i){i<<=7&t;var r=t/8|0;e[r]|=i,e[r+1]|=i>>>8,e[r+2]|=i>>>16},iq=function(e,t){for(var i=[],r=0;r<e.length;++r)e[r]&&i.push({s:r,f:e[r]});var s=i.length,n=i.slice();if(!s)return[new iy(0),0];if(1==s){var o=new iy(i[0].s+1);return o[i[0].s]=1,[o,1]}i.sort(function(e,t){return e.f-t.f}),i.push({s:-1,f:25001});var a=i[0],l=i[1],c=0,u=1,h=2;for(i[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=s-1;)a=i[i[c].f<i[h].f?c++:h++],l=i[c!=u&&i[c].f<i[h].f?c++:h++],i[u++]={s:-1,f:a.f+l.f,l:a,r:l};var d=n[0].s;for(r=1;r<s;++r)n[r].s>d&&(d=n[r].s);var f=new ib(d+1),p=iH(i[u-1],f,0);if(p>t){r=0;var g=0,v=p-t,_=1<<v;for(n.sort(function(e,t){return f[t.s]-f[e.s]||e.f-t.f});r<s;++r){var m=n[r].s;if(!(f[m]>t))break;g+=_-(1<<p-f[m]),f[m]=t}for(g>>>=v;g>0;){var y=n[r].s;f[y]<t?g-=1<<t-f[y]++-1:++r}for(;r>=0&&g;--r){var b=n[r].s;f[b]==t&&(--f[b],++g)}p=t}return[new iy(f),p]},iH=function(e,t,i){return -1==e.s?Math.max(iH(e.l,t,i+1),iH(e.r,t,i+1)):t[e.s]=i},iz=function(e){for(var t=e.length;t&&!e[--t];);for(var i=new ib(++t),r=0,s=e[0],n=1,o=function(e){i[r++]=e},a=1;a<=t;++a)if(e[a]==s&&a!=t)++n;else{if(!s&&n>2){for(;n>138;n-=138)o(32754);n>2&&(o(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(o(s),--n;n>6;n-=6)o(8304);n>2&&(o(n-3<<5|8208),n=0)}for(;n--;)o(s);n=1,s=e[a]}return[i.subarray(0,r),t]},iG=function(e,t){for(var i=0,r=0;r<t.length;++r)i+=e[r]*t[r];return i},iW=function(e,t,i){var r=i.length,s=iN(t+2);e[s]=255&r,e[s+1]=r>>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var n=0;n<r;++n)e[s+n+4]=i[n];return 8*(s+4+r)},iJ=function(e,t,i,r,s,n,o,a,l,c,u){iU(t,u++,i),++s[256];for(var h=iq(s,15),d=h[0],f=h[1],p=iq(n,15),g=p[0],v=p[1],_=iz(d),m=_[0],y=_[1],b=iz(g),w=b[0],k=b[1],S=new ib(19),E=0;E<m.length;++E)S[31&m[E]]++;for(E=0;E<w.length;++E)S[31&w[E]]++;for(var x=iq(S,7),T=x[0],O=x[1],P=19;P>4&&!T[iE[P-1]];--P);var I,C,A,$,R=c+5<<3,j=iG(s,ij)+iG(n,iL)+o,L=iG(s,d)+iG(n,g)+o+14+3*P+iG(S,T)+(2*S[16]+3*S[17]+7*S[18]);if(R<=j&&R<=L)return iW(t,u,e.subarray(l,l+c));if(iU(t,u,1+(L<j)),u+=2,L<j){I=iR(d,f,0),C=d,A=iR(g,v,0),$=g;var F=iR(T,O,0);for(iU(t,u,y-257),iU(t,u+5,k-1),iU(t,u+10,P-4),u+=14,E=0;E<P;++E)iU(t,u+3*E,T[iE[E]]);u+=3*P;for(var M=[m,w],N=0;N<2;++N){var B=M[N];for(E=0;E<B.length;++E){var U=31&B[E];iU(t,u,F[U]),u+=T[U],U>15&&(iU(t,u,B[E]>>>5&127),u+=B[E]>>>12)}}}else I=iF,C=ij,A=iM,$=iL;for(E=0;E<a;++E)if(r[E]>255){iD(t,u,I[(U=r[E]>>>18&31)+257]),u+=C[U+257],U>7&&(iU(t,u,r[E]>>>23&31),u+=ik[U]);var D=31&r[E];iD(t,u,A[D]),u+=$[D],D>3&&(iD(t,u,r[E]>>>5&8191),u+=iS[D])}else iD(t,u,I[r[E]]),u+=C[r[E]];return iD(t,u,I[256]),u+C[256]},iK=new iw([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),iV=function(){for(var e=new iw(256),t=0;t<256;++t){for(var i=t,r=9;--r;)i=(1&i&&0xedb88320)^i>>>1;e[t]=i}return e}(),iX=function(){var e=0xffffffff;return{p:function(t){for(var i=e,r=0;r<t.length;++r)i=iV[255&i^t[r]]^i>>>8;e=i},d:function(){return 0xffffffff^e}}},iY=function(e,t,i){for(;i;++t)e[t]=i,i>>>=8},iZ=function(e,t){var i=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:2*(9==t.level),e[9]=3,0!=t.mtime&&iY(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),i){e[3]=8;for(var r=0;r<=i.length;++r)e[r+10]=i.charCodeAt(r)}};function iQ(e,t){void 0===t&&(t={});var i,r,s,n=iX(),o=e.length;n.p(e);var a=(r=t,s=10+((i=t).filename&&i.filename.length+1||0),function(e,t,i,r,s,n){var o=e.length,a=new iy(r+o+5*(1+Math.floor(o/7e3))+8),l=a.subarray(r,a.length-s),c=0;if(!t||o<8)for(var u=0;u<=o;u+=65535){var h=u+65535;h<o?c=iW(l,c,e.subarray(u,h)):(l[u]=n,c=iW(l,c,e.subarray(u,o)))}else{for(var d=iK[t-1],f=d>>>13,p=8191&d,g=(1<<i)-1,v=new ib(32768),_=new ib(g+1),m=Math.ceil(i/3),y=2*m,b=function(t){return(e[t]^e[t+1]<<m^e[t+2]<<y)&g},w=new iw(25e3),k=new ib(288),S=new ib(32),E=0,x=0,T=(u=0,0),O=0,P=0;u<o;++u){var I=b(u),C=32767&u,A=_[I];if(v[C]=A,_[I]=C,O<=u){var $=o-u;if((E>7e3||T>24576)&&$>423){c=iJ(e,l,0,w,k,S,x,T,P,u-P,c),T=E=x=0,P=u;for(var R=0;R<286;++R)k[R]=0;for(R=0;R<30;++R)S[R]=0}var j=2,L=0,F=p,M=C-A&32767;if($>2&&I==b(u-M))for(var N=Math.min(f,$)-1,B=Math.min(32767,u),U=Math.min(258,$);M<=B&&--F&&C!=A;){if(e[u+j]==e[u+j-M]){for(var D=0;D<U&&e[u+D]==e[u+D-M];++D);if(D>j){if(j=D,L=M,D>N)break;var q=Math.min(M,D-2),H=0;for(R=0;R<q;++R){var z=u-M+R+32768&32767,G=z-v[z]+32768&32767;G>H&&(H=G,A=z)}}}M+=(C=A)-(A=v[C])+32768&32767}if(L){w[T++]=0x10000000|iP[j]<<18|iI[L];var W=31&iP[j],J=31&iI[L];x+=ik[W]+iS[J],++k[257+W],++S[J],O=u+j,++E}else w[T++]=e[u],++k[e[u]]}}c=iJ(e,l,n,w,k,S,x,T,P,u-P,c)}return iB(a,0,r+iN(c)+s)}(e,null==r.level?6:r.level,null==r.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+r.mem,s,8,!0)),l=a.length;return iZ(a,t),iY(a,l-8,n.d()),iY(a,l-4,o),a}function i0(e,t){var i=e.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var r=new iy(e.length+(e.length>>>1)),s=0,n=function(e){r[s++]=e},o=0;o<i;++o){if(s+5>r.length){var a=new iy(s+8+(i-o<<1));a.set(r),r=a}var l=e.charCodeAt(o);l<128||t?n(l):(l<2048?n(192|l>>>6):(l>55295&&l<57344?(n(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++o))>>>18),n(128|l>>>12&63)):n(224|l>>>12),n(128|l>>>6&63)),n(128|63&l))}return iB(r,0,s)}var i1="disabled",i2="sampled",i5="active",i3="buffering",i6="paused",i8="trigger",i4=i8+"_activated",i7=i8+"_pending",i9=i8+"_"+i1;function re(e,t){return t.some(t=>"regex"===t.matching&&new RegExp(t.url).test(e))}class rt{constructor(e){this.gt=e}triggerStatus(e){var t=this.gt.map(t=>t.triggerStatus(e));return t.includes(i4)?i4:t.includes(i7)?i7:i9}stop(){this.gt.forEach(e=>e.stop())}}class ri{constructor(e){this.gt=e}triggerStatus(e){var t=new Set;for(var i of this.gt)t.add(i.triggerStatus(e));switch(t.delete(i9),t.size){case 0:return i9;case 1:return Array.from(t)[0];default:return i7}}stop(){this.gt.forEach(e=>e.stop())}}class rr{triggerStatus(){return i7}stop(){}}class rs{constructor(e){this._t=[],this.bt=[],this.urlBlocked=!1,this._instance=e}onRemoteConfig(e){var t,i;this._t=(null==(t=e.sessionRecording)?void 0:t.urlTriggers)||[],this.bt=(null==(i=e.sessionRecording)?void 0:i.urlBlocklist)||[]}wt(e){var t;return 0===this._t.length?i9:(null==(t=this._instance)?void 0:t.get_property(eT))===e?i4:i7}triggerStatus(e){var t=this.wt(e),i=t===i4?i4:t===i7?i7:i9;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:i}),i}checkUrlTriggerConditions(e,t,i){if(void 0!==r&&r.location.href){var s=r.location.href,n=this.urlBlocked,o=re(s,this.bt);n&&o||(o&&!n?e():!o&&n&&t(),re(s,this._t)&&i("url"))}}stop(){}}class rn{constructor(e){this.linkedFlag=null,this.linkedFlagSeen=!1,this.yt=()=>{},this._instance=e}triggerStatus(){var e=i7;return F(this.linkedFlag)&&(e=i9),this.linkedFlagSeen&&(e=i4),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:e}),e}onRemoteConfig(e,t){var i;if(this.linkedFlag=(null==(i=e.sessionRecording)?void 0:i.linkedFlag)||null,!F(this.linkedFlag)&&!this.linkedFlagSeen){var r=R(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,s=R(this.linkedFlag)?null:this.linkedFlag.variant;this.yt=this._instance.onFeatureFlags((e,i)=>{var n=!1;if(C(i)&&r in i){var o=i[r];n=N(o)?!0===o:s?o===s:!!o}this.linkedFlagSeen=n,n&&t(r,s)})}}stop(){this.yt()}}class ro{constructor(e){this.St=[],this._instance=e}onRemoteConfig(e){var t;this.St=(null==(t=e.sessionRecording)?void 0:t.eventTriggers)||[]}$t(e){var t;return 0===this.St.length?i9:(null==(t=this._instance)?void 0:t.get_property(eO))===e?i4:i7}triggerStatus(e){var t=this.$t(e),i=t===i4?i4:t===i7?i7:i9;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:i}),i}stop(){}}function ra(e){return e.isRecordingEnabled?i3:i1}function rl(e){if(!e.receivedDecide)return i3;if(!e.isRecordingEnabled)return i1;if(e.urlTriggerMatching.urlBlocked)return i6;var t=!0===e.isSampled,i=new rt([e.eventTriggerMatching,e.urlTriggerMatching,e.linkedFlagMatching]).triggerStatus(e.sessionId);return t?i2:i===i4?i5:i===i7?i3:!1===e.isSampled?i1:i5}function rc(e){if(!e.receivedDecide)return i3;if(!e.isRecordingEnabled)return i1;if(e.urlTriggerMatching.urlBlocked)return i6;var t=new ri([e.eventTriggerMatching,e.urlTriggerMatching,e.linkedFlagMatching]).triggerStatus(e.sessionId),i=t!==i9,r=N(e.isSampled);return i&&t===i7?i3:i&&t===i9||r&&!e.isSampled?i1:!0===e.isSampled?i2:i5}var ru="[SessionRecording]",rh=H(ru);function rd(){var e;return null==g||null==(e=g.__PosthogExtensions__)||null==(e=e.rrweb)?void 0:e.record}var rf=[io.MouseMove,io.MouseInteraction,io.Scroll,io.ViewportResize,io.Input,io.TouchMove,io.MediaInteraction,io.Drag],rp=e=>({rrwebMethod:e,enqueuedAt:Date.now(),attempt:1});function rg(e){return function(e,t){for(var i="",r=0;r<e.length;){var s=e[r++];s<128||t?i+=String.fromCharCode(s):s<224?i+=String.fromCharCode((31&s)<<6|63&e[r++]):s<240?i+=String.fromCharCode((15&s)<<12|(63&e[r++])<<6|63&e[r++]):i+=String.fromCharCode(55296|(s=((15&s)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536)>>10,56320|1023&s)}return i}(iQ(i0(JSON.stringify(e))),!0)}function rv(e){return e.type===is.Custom&&"sessionIdle"===e.data.tag}class r_{get sessionId(){return this.kt}get xt(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get started(){return this.Et}get It(){if(!this._instance.sessionManager)throw Error(ru+" must be started with a valid sessionManager.");return this._instance.sessionManager}get Pt(){var e,t;return this.Rt.triggerStatus(this.sessionId)===i7?6e4:null!=(e=null==(t=this._instance.config.session_recording)?void 0:t.full_snapshot_interval_millis)?e:3e5}get Tt(){var e=this._instance.get_property(ex);return N(e)?e:null}get Mt(){var e,t,i=null==(e=this.M)?void 0:e.data[(null==(t=this.M)?void 0:t.data.length)-1],{sessionStartTimestamp:r}=this.It.checkAndGetSessionAndWindowId(!0);return i?i.timestamp-r:null}get Ct(){var e=!!this._instance.get_property(ev),t=!this._instance.config.disable_session_recording;return r&&e&&t}get Ot(){var e=!!this._instance.get_property(e_),t=this._instance.config.enable_recording_console_log;return null!=t?t:e}get Ft(){var e,t,i,r,s,n,o=this._instance.config.session_recording.captureCanvas,a=this._instance.get_property(eb),l=null!=(e=null!=(t=null==o?void 0:o.recordCanvas)?t:null==a?void 0:a.enabled)&&e,c=null!=(i=null!=(r=null==o?void 0:o.canvasFps)?r:null==a?void 0:a.fps)?i:4,u=null!=(s=null!=(n=null==o?void 0:o.canvasQuality)?n:null==a?void 0:a.quality)?s:.4;if("string"==typeof u){var h=parseFloat(u);u=isNaN(h)?.4:h}return{enabled:l,fps:i_(c,0,12,"canvas recording fps",4),quality:i_(u,0,1,"canvas recording quality",.4)}}get At(){var e,t,i=this._instance.get_property(em),r={recordHeaders:null==(e=this._instance.config.session_recording)?void 0:e.recordHeaders,recordBody:null==(t=this._instance.config.session_recording)?void 0:t.recordBody},s=(null==r?void 0:r.recordHeaders)||(null==i?void 0:i.recordHeaders),n=(null==r?void 0:r.recordBody)||(null==i?void 0:i.recordBody),o=C(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,a=!!(N(o)?o:null==i?void 0:i.capturePerformance);return s||n||a?{recordHeaders:s,recordBody:n,recordPerformance:a}:void 0}get Dt(){var e,t,i,r,s,n,o=this._instance.get_property(ey),a={maskAllInputs:null==(e=this._instance.config.session_recording)?void 0:e.maskAllInputs,maskTextSelector:null==(t=this._instance.config.session_recording)?void 0:t.maskTextSelector,blockSelector:null==(i=this._instance.config.session_recording)?void 0:i.blockSelector},l=null!=(r=null==a?void 0:a.maskAllInputs)?r:null==o?void 0:o.maskAllInputs,c=null!=(s=null==a?void 0:a.maskTextSelector)?s:null==o?void 0:o.maskTextSelector,u=null!=(n=null==a?void 0:a.blockSelector)?n:null==o?void 0:o.blockSelector;return $(l)&&$(c)&&$(u)?void 0:{maskAllInputs:null==l||l,maskTextSelector:c,blockSelector:u}}get Lt(){var e=this._instance.get_property(ew);return M(e)?e:null}get Nt(){var e=this._instance.get_property(ek);return M(e)?e:null}get status(){return this.jt?this.zt({receivedDecide:this.jt,isRecordingEnabled:this.Ct,isSampled:this.Tt,urlTriggerMatching:this.Ut,eventTriggerMatching:this.qt,linkedFlagMatching:this.Bt,sessionId:this.sessionId}):i3}constructor(e){if(this.zt=ra,this.jt=!1,this.Ht=[],this.Wt="unknown",this.Gt=Date.now(),this.Rt=new rr,this.Jt=void 0,this.Vt=void 0,this.Kt=void 0,this.Yt=void 0,this.Xt=void 0,this._forceAllowLocalhostNetworkCapture=!1,this.Qt=()=>{this.Zt()},this.ti=()=>{this.ii("browser offline",{})},this.ei=()=>{this.ii("browser online",{})},this.ri=()=>{if(null!=c&&c.visibilityState){var e="window "+c.visibilityState;this.ii(e,{})}},this._instance=e,this.Et=!1,this.si="/s/",this.ni=void 0,this.jt=!1,!this._instance.sessionManager)throw rh.error("started without valid sessionManager"),Error(ru+" started without valid sessionManager. This is a bug.");if(this._instance.config.__preview_experimental_cookieless_mode)throw Error(ru+" cannot be used with __preview_experimental_cookieless_mode.");this.Bt=new rn(this._instance),this.Ut=new rs(this._instance),this.qt=new ro(this._instance);var{sessionId:t,windowId:i}=this.It.checkAndGetSessionAndWindowId();this.kt=t,this.oi=i,this.M=this.ai(),this.xt>=this.It.sessionTimeoutMs&&rh.warn("session_idle_threshold_ms ("+this.xt+") is greater than the session timeout ("+this.It.sessionTimeoutMs+"). Session will never be detected as idle")}startIfEnabledOrStop(e){this.Ct?(this.li(e),en(r,"beforeunload",this.Qt),en(r,"offline",this.ti),en(r,"online",this.ei),en(r,"visibilitychange",this.ri),this.ui(),this.hi(),F(this.Jt)&&(this.Jt=this._instance.on("eventCaptured",e=>{try{if("$pageview"===e.event){var t=null!=e&&e.properties.$current_url?this.di(null==e?void 0:e.properties.$current_url):"";if(!t)return;this.ii("$pageview",{href:t})}}catch(e){rh.error("Could not add $pageview to rrweb session",e)}})),this.Vt||(this.Vt=this.It.onSessionId((e,t,i)=>{var r,s;i&&(this.ii("$session_id_change",{sessionId:e,windowId:t,changeReason:i}),null==(r=this._instance)||null==(r=r.persistence)||r.unregister(eO),null==(s=this._instance)||null==(s=s.persistence)||s.unregister(eT))}))):this.stopRecording()}stopRecording(){var e,t,i,s;this.Et&&this.ni&&(this.ni(),this.ni=void 0,this.Et=!1,null==r||r.removeEventListener("beforeunload",this.Qt),null==r||r.removeEventListener("offline",this.ti),null==r||r.removeEventListener("online",this.ei),null==r||r.removeEventListener("visibilitychange",this.ri),this.ai(),clearInterval(this.vi),null==(e=this.Jt)||e.call(this),this.Jt=void 0,null==(t=this.Xt)||t.call(this),this.Xt=void 0,null==(i=this.Vt)||i.call(this),this.Vt=void 0,null==(s=this.Yt)||s.call(this),this.Yt=void 0,this.qt.stop(),this.Ut.stop(),this.Bt.stop(),rh.info("stopped"))}ci(){var e;null==(e=this._instance.persistence)||e.unregister(ex)}fi(e){var t,i=this.kt!==e,r=this.Lt;if(M(r)){var s=this.Tt,n=i||!N(s),o=n?function(e){for(var t=0,i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i)|0;return Math.abs(t)}(e)%100<i_(100*r,0,100):s;n&&(o?this.pi(i2):rh.warn("Sample rate ("+r+") has determined that this sessionId ("+e+") will not be sent to the server."),this.ii("samplingDecisionMade",{sampleRate:r,isSampled:o})),null==(t=this._instance.persistence)||t.register({[ex]:o})}else this.ci()}onRemoteConfig(e){var t,i,r,s;this.ii("$remote_config_received",e),this.gi(e),null!=(t=e.sessionRecording)&&t.endpoint&&(this.si=null==(s=e.sessionRecording)?void 0:s.endpoint),this.ui(),"any"===(null==(i=e.sessionRecording)?void 0:i.triggerMatchType)?(this.zt=rl,this.Rt=new rt([this.qt,this.Ut])):(this.zt=rc,this.Rt=new ri([this.qt,this.Ut])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:null==(r=e.sessionRecording)?void 0:r.triggerMatchType}),this.Ut.onRemoteConfig(e),this.qt.onRemoteConfig(e),this.Bt.onRemoteConfig(e,(e,t)=>{this.pi("linked_flag_matched",{flag:e,variant:t})}),this.jt=!0,this.startIfEnabledOrStop()}ui(){M(this.Lt)&&F(this.Yt)&&(this.Yt=this.It.onSessionId(e=>{this.fi(e)}))}gi(e){if(this._instance.persistence){var t,i=this._instance.persistence,r=()=>{var t,r,s,n,o,a,l,c,u,h=null==(t=e.sessionRecording)?void 0:t.sampleRate,d=F(h)?null:parseFloat(h);F(d)&&this.ci();var f=null==(r=e.sessionRecording)?void 0:r.minimumDurationMilliseconds;i.register({[ev]:!!e.sessionRecording,[e_]:null==(s=e.sessionRecording)?void 0:s.consoleLogRecordingEnabled,[em]:W({capturePerformance:e.capturePerformance},null==(n=e.sessionRecording)?void 0:n.networkPayloadCapture),[ey]:null==(o=e.sessionRecording)?void 0:o.masking,[eb]:{enabled:null==(a=e.sessionRecording)?void 0:a.recordCanvas,fps:null==(l=e.sessionRecording)?void 0:l.canvasFps,quality:null==(c=e.sessionRecording)?void 0:c.canvasQuality},[ew]:d,[ek]:$(f)?null:f,[eS]:null==(u=e.sessionRecording)?void 0:u.scriptConfig})};r(),null==(t=this.Kt)||t.call(this),this.Kt=this.It.onSessionId(r)}}log(e,t){var i;void 0===t&&(t="log"),null==(i=this._instance.sessionRecording)||i.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:t,trace:[],payload:[JSON.stringify(e)]}},timestamp:Date.now()})}li(e){if(!$(Object.assign)&&!$(Array.from)&&!(this.Et||this._instance.config.disable_session_recording||this._instance.consent.isOptedOut())){var t;(this.Et=!0,this.It.checkAndGetSessionAndWindowId(),rd())?this.mi():null==(t=g.__PosthogExtensions__)||null==t.loadExternalDependency||t.loadExternalDependency(this._instance,this.bi,e=>{if(e)return rh.error("could not load recorder",e);this.mi()}),rh.info("starting"),this.status===i5&&this.pi(e||"recording_initialized")}}get bi(){var e;return(null==(e=this._instance)||null==(e=e.persistence)||null==(e=e.get_property(eS))?void 0:e.script)||"recorder"}wi(e){var t;return 3===e.type&&-1!==rf.indexOf(null==(t=e.data)?void 0:t.source)}yi(e){var t=this.wi(e);t||this.Wt||e.timestamp-this.Gt>this.xt&&(this.Wt=!0,clearInterval(this.vi),this.ii("sessionIdle",{eventTimestamp:e.timestamp,lastActivityTimestamp:this.Gt,threshold:this.xt,bufferLength:this.M.data.length,bufferSize:this.M.size}),this.Zt());var i=!1;if(t&&(this.Gt=e.timestamp,this.Wt)){var r="unknown"===this.Wt;this.Wt=!1,r||(this.ii("sessionNoLongerIdle",{reason:"user activity",type:e.type}),i=!0)}if(!this.Wt){var{windowId:s,sessionId:n}=this.It.checkAndGetSessionAndWindowId(!t,e.timestamp),o=this.kt!==n,a=this.oi!==s;this.oi=s,this.kt=n,o||a?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):i&&this.Si()}}$i(e){try{return e.rrwebMethod(),!0}catch(t){return this.Ht.length<10?this.Ht.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):rh.warn("could not emit queued rrweb event.",t,e),!1}}ii(e,t){return this.$i(rp(()=>rd().addCustomEvent(e,t)))}ki(){return this.$i(rp(()=>rd().takeFullSnapshot()))}mi(){var e,t,i,r,s={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1};for(var[n,o]of Object.entries(this._instance.config.session_recording||{}))n in s&&("maskInputOptions"===n?s.maskInputOptions=W({password:!0},o):s[n]=o);this.Ft&&this.Ft.enabled&&(s.recordCanvas=!0,s.sampling={canvas:this.Ft.fps},s.dataURLOptions={type:"image/webp",quality:this.Ft.quality}),this.Dt&&(s.maskAllInputs=null==(t=this.Dt.maskAllInputs)||t,s.maskTextSelector=null!=(i=this.Dt.maskTextSelector)?i:void 0,s.blockSelector=null!=(r=this.Dt.blockSelector)?r:void 0);var a=rd();if(a){this.xi=null!=(e=this.xi)?e:new im(a,{refillRate:this._instance.config.session_recording.__mutationRateLimiterRefillRate,bucketSize:this._instance.config.session_recording.__mutationRateLimiterBucketSize,onBlockedNode:(e,t)=>{var i="Too many mutations on node '"+e+"'. Rate limiting. This could be due to SVG animations or something similar";rh.info(i,{node:t}),this.log(ru+" "+i,"warn")}});var l=this.Ei();this.ni=a(W({emit:e=>{this.onRRwebEmit(e)},plugins:l},s)),this.Gt=Date.now(),this.Wt=N(this.Wt)?this.Wt:"unknown",this.ii("$session_options",{sessionRecordingOptions:s,activePlugins:l.map(e=>null==e?void 0:e.name)}),this.ii("$posthog_config",{config:this._instance.config})}else rh.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}Si(){if(this.vi&&clearInterval(this.vi),!0!==this.Wt){var e=this.Pt;e&&(this.vi=setInterval(()=>{this.ki()},e))}}Ei(){var e,t,i=[],r=null==(e=g.__PosthogExtensions__)||null==(e=e.rrwebPlugins)?void 0:e.getRecordConsolePlugin;r&&this.Ot&&i.push(r());var s=null==(t=g.__PosthogExtensions__)||null==(t=t.rrwebPlugins)?void 0:t.getRecordNetworkPlugin;return this.At&&I(s)&&(!ta.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?i.push(s(iv(this._instance.config,this.At))):rh.info("NetworkCapture not started because we are on localhost.")),i}onRRwebEmit(e){var t;if(this.Ii(),e&&C(e)){if(e.type===is.Meta){var i=this.di(e.data.href);if(this.Pi=i,!i)return;e.data.href=i}else this.Ri();if(this.Ut.checkUrlTriggerConditions(()=>this.Ti(),()=>this.Mi(),e=>this.Ci(e)),!this.Ut.urlBlocked||e.type===is.Custom&&"recording paused"===e.data.tag){e.type===is.FullSnapshot&&this.Si(),e.type===is.FullSnapshot&&this.jt&&this.Rt.triggerStatus(this.sessionId)===i7&&this.ai();var r=this.xi?this.xi.throttleMutations(e):e;if(r){var s=function(e){if(e&&C(e)&&6===e.type&&C(e.data)&&"rrweb/console@1"===e.data.plugin){e.data.payload.payload.length>10&&(e.data.payload.payload=e.data.payload.payload.slice(0,10),e.data.payload.payload.push("...[truncated]"));for(var t=[],i=0;i<e.data.payload.payload.length;i++)e.data.payload.payload[i]&&e.data.payload.payload[i].length>2e3?t.push(e.data.payload.payload[i].slice(0,2e3)+"...[truncated]"):t.push(e.data.payload.payload[i]);return e.data.payload.payload=t,e}return e}(r);if(this.yi(s),!0!==this.Wt||rv(s)){if(rv(s)){var n=s.data.payload;n&&(s.timestamp=n.lastActivityTimestamp+n.threshold)}var o=null==(t=this._instance.config.session_recording.compress_events)||t?function(e){if(1024>ir(e))return e;try{if(e.type===is.FullSnapshot)return W({},e,{data:rg(e.data),cv:"2024-10"});if(e.type===is.IncrementalSnapshot&&e.data.source===io.Mutation)return W({},e,{cv:"2024-10",data:W({},e.data,{texts:rg(e.data.texts),attributes:rg(e.data.attributes),removes:rg(e.data.removes),adds:rg(e.data.adds)})});if(e.type===is.IncrementalSnapshot&&e.data.source===io.StyleSheetRule)return W({},e,{cv:"2024-10",data:W({},e.data,{adds:e.data.adds?rg(e.data.adds):void 0,removes:e.data.removes?rg(e.data.removes):void 0})})}catch(e){rh.error("could not compress event - will use uncompressed event",e)}return e}(s):s,a={$snapshot_bytes:ir(o),$snapshot_data:o,$session_id:this.kt,$window_id:this.oi};this.status!==i1?this.Oi(a):this.ai()}}}}}Ri(){if(!this._instance.config.capture_pageview&&r){var e=this.di(r.location.href);this.Pi!==e&&(this.ii("$url_changed",{href:e}),this.Pi=e)}}Ii(){if(this.Ht.length){var e=[...this.Ht];this.Ht=[],e.forEach(e=>{Date.now()-e.enqueuedAt<=2e3&&this.$i(e)})}}di(e){var t=this._instance.config.session_recording;if(t.maskNetworkRequestFn){var i,r={url:e};return null==(i=r=t.maskNetworkRequestFn(r))?void 0:i.url}return e}ai(){return this.M={size:0,data:[],sessionId:this.kt,windowId:this.oi},this.M}Zt(){this.Fi&&(clearTimeout(this.Fi),this.Fi=void 0);var e=this.Nt,t=this.Mt,i=M(t)&&t>=0,r=M(e)&&i&&t<e;return this.status===i3||this.status===i6||this.status===i1||r?(this.Fi=setTimeout(()=>{this.Zt()},2e3),this.M):(this.M.data.length>0&&(function e(t,i){if(void 0===i&&(i=6606028.8),t.size>=i&&t.data.length>1){var r=Math.floor(t.data.length/2),s=t.data.slice(0,r),n=t.data.slice(r);return[e({size:ir(s),data:s,sessionId:t.sessionId,windowId:t.windowId}),e({size:ir(n),data:n,sessionId:t.sessionId,windowId:t.windowId})].flatMap(e=>e)}return[t]})(this.M).forEach(e=>{this.Ai({$snapshot_bytes:e.size,$snapshot_data:e.data,$session_id:e.sessionId,$window_id:e.windowId,$lib:"web",$lib_version:v.LIB_VERSION})}),this.ai())}Oi(e){var t,i=2+((null==(t=this.M)?void 0:t.data.length)||0);!this.Wt&&(this.M.size+e.$snapshot_bytes+i>943718.4||this.M.sessionId!==this.kt)&&(this.M=this.Zt()),this.M.size+=e.$snapshot_bytes,this.M.data.push(e.$snapshot_data),this.Fi||this.Wt||(this.Fi=setTimeout(()=>{this.Zt()},2e3))}Ai(e){this._instance.capture("$snapshot",e,{_url:this._instance.requestRouter.endpointFor("api",this.si),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}Ci(e){var t;this.Rt.triggerStatus(this.sessionId)===i7&&(null==(t=this._instance)||null==(t=t.persistence)||t.register({["url"===e?eT:eO]:this.kt}),this.Zt(),this.pi(e+"_trigger_matched"))}Ti(){this.Ut.urlBlocked||(this.Ut.urlBlocked=!0,clearInterval(this.vi),rh.info("recording paused due to URL blocker"),this.ii("recording paused",{reason:"url blocker"}))}Mi(){this.Ut.urlBlocked&&(this.Ut.urlBlocked=!1,this.ki(),this.Si(),this.ii("recording resumed",{reason:"left blocked url"}),rh.info("recording resumed"))}hi(){0!==this.qt.St.length&&F(this.Xt)&&(this.Xt=this._instance.on("eventCaptured",e=>{try{this.qt.St.includes(e.event)&&this.Ci("event")}catch(e){rh.error("Could not activate event trigger",e)}}))}overrideLinkedFlag(){this.Bt.linkedFlagSeen=!0,this.ki(),this.pi("linked_flag_overridden")}overrideSampling(){var e;null==(e=this._instance.persistence)||e.register({[ex]:!0}),this.ki(),this.pi("sampling_overridden")}overrideTrigger(e){this.Ci(e)}pi(e,t){this._instance.register_for_session({$session_recording_start_reason:e}),rh.info(e.replace("_"," "),t),w(["recording_initialized","session_id_changed"],e)||this.ii(e,t)}get sdkDebugProperties(){var{sessionStartTimestamp:e}=this.It.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this.M.data.length,$sdk_debug_replay_internal_buffer_size:this.M.size,$sdk_debug_current_session_duration:this.Mt,$sdk_debug_session_start:e}}}var rm=H("[SegmentIntegration]"),ry="posthog-js";function rb(e,t){var{organization:i,projectId:r,prefix:s,severityAllowList:n=["error"]}=void 0===t?{}:t;return t=>{if(!("*"===n||n.includes(t.level))||!e.__loaded)return t;t.tags||(t.tags={});var o,a,l,c,u,h=e.requestRouter.endpointFor("ui","/project/"+e.config.token+"/person/"+e.get_distinct_id());t.tags["PostHog Person URL"]=h,e.sessionRecordingStarted()&&(t.tags["PostHog Recording URL"]=e.get_session_replay_url({withTimestamp:!0}));var d=(null==(o=t.exception)?void 0:o.values)||[],f=d.map(e=>W({},e,{stacktrace:e.stacktrace?W({},e.stacktrace,{type:"raw",frames:(e.stacktrace.frames||[]).map(e=>W({},e,{platform:"web:javascript"}))}):void 0})),p={$exception_message:(null==(a=d[0])?void 0:a.value)||t.message,$exception_type:null==(l=d[0])?void 0:l.type,$exception_personURL:h,$exception_level:t.level,$exception_list:f,$sentry_event_id:t.event_id,$sentry_exception:t.exception,$sentry_exception_message:(null==(c=d[0])?void 0:c.value)||t.message,$sentry_exception_type:null==(u=d[0])?void 0:u.type,$sentry_tags:t.tags};return i&&r&&(p.$sentry_url=(s||"https://sentry.io/organizations/")+i+"/issues/?project="+r+"&query="+t.event_id),e.exceptions.sendExceptionEvent(p),t}}class rw{constructor(e,t,i,r,s){this.name=ry,this.setupOnce=function(n){n(rb(e,{organization:t,projectId:i,prefix:r,severityAllowList:s}))}}}var rk=null!=r&&r.location?td(r.location.hash,"__posthog")||td(location.hash,"state"):null,rS="_postHogToolbarParams",rE=H("[Toolbar]"),rx=function(e){return e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e}(rx||{});class rT{constructor(e){this.instance=e}Di(e){g.ph_toolbar_state=e}Li(){var e;return null!=(e=g.ph_toolbar_state)?e:rx.UNINITIALIZED}maybeLoadToolbar(e,t,i){if(void 0===e&&(e=void 0),void 0===t&&(t=void 0),void 0===i&&(i=void 0),!r||!c)return!1;e=null!=e?e:r.location,i=null!=i?i:r.history;try{if(!t){try{r.localStorage.setItem("test","test"),r.localStorage.removeItem("test")}catch(e){return!1}t=null==r?void 0:r.localStorage}var s,n=rk||td(e.hash,"__posthog")||td(e.hash,"state"),o=n?ee(()=>JSON.parse(atob(decodeURIComponent(n))))||ee(()=>JSON.parse(decodeURIComponent(n))):null;return o&&"ph_authorize"===o.action?((s=o).source="url",s&&Object.keys(s).length>0&&(o.desiredHash?e.hash=o.desiredHash:i?i.replaceState(i.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(t.getItem(rS)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch(e){return!1}}Ni(e){var t=g.ph_load_toolbar||g.ph_load_editor;!F(t)&&I(t)?t(e,this.instance):rE.warn("No toolbar load function found")}loadToolbar(e){var t,i=!(null==c||!c.getElementById(eH));if(!r||i)return!1;var s="custom"===this.instance.requestRouter.region&&this.instance.config.advanced_disable_toolbar_metrics,n=W({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},s?{instrument:!1}:{});return(r.localStorage.setItem(rS,JSON.stringify(W({},n,{source:void 0}))),this.Li()===rx.LOADED)?this.Ni(n):this.Li()===rx.UNINITIALIZED&&(this.Di(rx.LOADING),null==(t=g.__PosthogExtensions__)||null==t.loadExternalDependency||t.loadExternalDependency(this.instance,"toolbar",e=>{if(e)return rE.error("[Toolbar] Failed to load",e),void this.Di(rx.UNINITIALIZED);this.Di(rx.LOADED),this.Ni(n)}),en(r,"turbolinks:load",()=>{this.Di(rx.UNINITIALIZED),this.loadToolbar(n)})),!0}ji(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,i){return void 0===e&&(e=void 0),void 0===t&&(t=void 0),void 0===i&&(i=void 0),this.maybeLoadToolbar(e,t,i)}}var rO=H("[TracingHeaders]");class rP{constructor(e){this.zi=void 0,this.Ui=void 0,this.V=()=>{var e,t;$(this.zi)&&(null==(e=g.__PosthogExtensions__)||null==(e=e.tracingHeadersPatchFns)||e._patchXHR(this._instance.sessionManager)),$(this.Ui)&&(null==(t=g.__PosthogExtensions__)||null==(t=t.tracingHeadersPatchFns)||t._patchFetch(this._instance.sessionManager))},this._instance=e}G(e){var t,i;null!=(t=g.__PosthogExtensions__)&&t.tracingHeadersPatchFns&&e(),null==(i=g.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"tracing-headers",t=>{if(t)return rO.error("failed to load script",t);e()})}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.G(this.V):(null==(e=this.zi)||e.call(this),null==(t=this.Ui)||t.call(this),this.zi=void 0,this.Ui=void 0)}}var rI=H("[Web Vitals]");class rC{constructor(e){var t;this.qi=!1,this.i=!1,this.M={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Bi=()=>{clearTimeout(this.Hi),0!==this.M.metrics.length&&(this._instance.capture("$web_vitals",this.M.metrics.reduce((e,t)=>W({},e,{["$web_vitals_"+t.name+"_event"]:W({},t),["$web_vitals_"+t.name+"_value"]:t.value}),{})),this.M={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.Wi=e=>{var t,i=null==(t=this._instance.sessionManager)?void 0:t.checkAndGetSessionAndWindowId(!0);if($(i))rI.error("Could not read session ID. Dropping metrics!");else{this.M=this.M||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var r=this.Gi();$(r)||(F(null==e?void 0:e.name)||F(null==e?void 0:e.value)?rI.error("Invalid metric received",e):this.Ji&&e.value>=this.Ji?rI.error("Ignoring metric with value >= "+this.Ji,e):(this.M.url!==r&&(this.Bi(),this.Hi=setTimeout(this.Bi,this.flushToCaptureTimeoutMs)),$(this.M.url)&&(this.M.url=r),this.M.firstMetricTimestamp=$(this.M.firstMetricTimestamp)?Date.now():this.M.firstMetricTimestamp,e.attribution&&e.attribution.interactionTargetElement&&(e.attribution.interactionTargetElement=void 0),this.M.metrics.push(W({},e,{$current_url:r,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this.M.metrics.length===this.allowedMetrics.length&&this.Bi()))}},this.V=()=>{var e,t,i,r,s=g.__PosthogExtensions__;$(s)||$(s.postHogWebVitalsCallbacks)||({onLCP:e,onCLS:t,onFCP:i,onINP:r}=s.postHogWebVitalsCallbacks),e&&t&&i&&r?(this.allowedMetrics.indexOf("LCP")>-1&&e(this.Wi.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&t(this.Wi.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this.Wi.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&r(this.Wi.bind(this)),this.i=!0):rI.error("web vitals callbacks not loaded - not starting")},this._instance=e,this.qi=!(null==(t=this._instance.persistence)||!t.props[ef]),this.startIfEnabled()}get allowedMetrics(){var e,t,i=C(this._instance.config.capture_performance)?null==(e=this._instance.config.capture_performance)?void 0:e.web_vitals_allowed_metrics:void 0;return $(i)?(null==(t=this._instance.persistence)?void 0:t.props[eg])||["CLS","FCP","INP","LCP"]:i}get flushToCaptureTimeoutMs(){return(C(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get Ji(){var e=C(this._instance.config.capture_performance)&&M(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:9e5;return 0<e&&e<=6e4?9e5:e}get isEnabled(){var e=null==u?void 0:u.protocol;if("http:"!==e&&"https:"!==e)return rI.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=C(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:N(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return N(t)?t:this.qi}startIfEnabled(){this.isEnabled&&!this.i&&(rI.info("enabled, starting..."),this.G(this.V))}onRemoteConfig(e){var t=C(e.capturePerformance)&&!!e.capturePerformance.web_vitals,i=C(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[ef]:t}),this._instance.persistence.register({[eg]:i})),this.qi=t,this.startIfEnabled()}G(e){var t,i;null!=(t=g.__PosthogExtensions__)&&t.postHogWebVitalsCallbacks&&e(),null==(i=g.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"web-vitals",t=>{t?rI.error("failed to load script",t):e()})}Gi(){var e=r?r.location.href:void 0;return e||rI.error("Could not determine current URL"),e}}var rA=H("[Heatmaps]");function r$(e){return C(e)&&"clientX"in e&&"clientY"in e&&M(e.clientX)&&M(e.clientY)}class rR{constructor(e){var t;this.rageclicks=new to,this.qi=!1,this.i=!1,this.Vi=null,this.instance=e,this.qi=!(null==(t=this.instance.persistence)||!t.props[eu])}get flushIntervalMilliseconds(){var e=5e3;return C(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return $(this.instance.config.capture_heatmaps)?$(this.instance.config.enable_heatmaps)?this.qi:this.instance.config.enable_heatmaps:!1!==this.instance.config.capture_heatmaps}startIfEnabled(){if(this.isEnabled)this.i||(rA.info("starting..."),this.Ki(),this.Vi=setInterval(this.Yi.bind(this),this.flushIntervalMilliseconds));else{var e,t;clearInterval(null!=(e=this.Vi)?e:void 0),null==(t=this.Xi)||t.stop(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[eu]:t}),this.qi=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.M;return this.M=void 0,e}Qi(e){this.Zi(e.originalEvent,"deadclick")}Ki(){r&&c&&(en(r,"beforeunload",this.Yi.bind(this)),en(c,"click",e=>this.Zi(e||(null==r?void 0:r.event)),{capture:!0}),en(c,"mousemove",e=>this.te(e||(null==r?void 0:r.event)),{capture:!0}),this.Xi=new tU(this.instance,tN,this.Qi.bind(this)),this.Xi.startIfEnabled(),this.i=!0)}ie(e,t){var i=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),n=this.instance.scrollManager.scrollElement(),o=function(e,t,i){for(var s=e;s&&eJ(s)&&!eK(s,"body")&&s!==i;){if(w(t,null==r?void 0:r.getComputedStyle(s).position))return!0;s=e3(s)}return!1}(e2(e),["fixed","sticky"],n);return{x:e.clientX+(o?0:s),y:e.clientY+(o?0:i),target_fixed:o,type:t}}Zi(e,t){var i;if(void 0===t&&(t="click"),!eW(e.target)&&r$(e)){var r=this.ie(e,t);null!=(i=this.rageclicks)&&i.isRageClick(e.clientX,e.clientY,(new Date).getTime())&&this.ee(W({},r,{type:"rageclick"})),this.ee(r)}}te(e){!eW(e.target)&&r$(e)&&(clearTimeout(this.re),this.re=setTimeout(()=>{this.ee(this.ie(e,"mousemove"))},500))}ee(e){if(r){var t=r.location.href;this.M=this.M||{},this.M[t]||(this.M[t]=[]),this.M[t].push(e)}}Yi(){this.M&&!A(this.M)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class rj{constructor(e){this._instance=e}doPageView(e,t){var i,s=this.se(e,t);return this.ne={pathname:null!=(i=null==r?void 0:r.location.pathname)?i:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(e){var t;return this.se(e,null==(t=this.ne)?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:null==(e=this.ne)?void 0:e.pageViewId}}se(e,t){var i=this.ne;if(!i)return{$pageview_id:t};var r={$pageview_id:t,$prev_pageview_id:i.pageViewId},s=this._instance.scrollManager.getContext();if(s&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:n,lastScrollY:o,maxScrollY:a,maxContentHeight:l,lastContentY:c,maxContentY:u}=s;if(!($(n)||$(o)||$(a)||$(l)||$(c)||$(u))){n=Math.ceil(n),o=Math.ceil(o),a=Math.ceil(a),l=Math.ceil(l),c=Math.ceil(c),u=Math.ceil(u);var h=n<=1?1:i_(o/n,0,1),d=n<=1?1:i_(a/n,0,1),f=l<=1?1:i_(c/l,0,1),p=l<=1?1:i_(u/l,0,1);r=Y(r,{$prev_pageview_last_scroll:o,$prev_pageview_last_scroll_percentage:h,$prev_pageview_max_scroll:a,$prev_pageview_max_scroll_percentage:d,$prev_pageview_last_content:c,$prev_pageview_last_content_percentage:f,$prev_pageview_max_content:u,$prev_pageview_max_content_percentage:p})}}return i.pathname&&(r.$prev_pageview_pathname=i.pathname),i.timestamp&&(r.$prev_pageview_duration=(e.getTime()-i.timestamp.getTime())/1e3),r}}var rL=function(e){var t,i,r,s,n="";for(t=i=0,r=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,s=0;s<r;s++){var o=e.charCodeAt(s),a=null;o<128?i++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),L(a)||(i>t&&(n+=e.substring(t,i)),n+=a,t=i=s+1)}return i>t&&(n+=e.substring(t,e.length)),n},rF=!!d||!!h,rM="text/plain",rN=(e,t)=>{var[i,r]=e.split("?"),s=W({},t);null==r||r.split("&").forEach(e=>{var[t]=e.split("=");delete s[t]});var n=tc(s);return i+"?"+(n=n?(r?r+"&":"")+n:r)},rB=(e,t)=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString():t,t),rU=e=>{var{data:t,compression:i}=e;if(t){if(i===y.GZipJS){var r=new Blob([iQ(i0(rB(t)),{mtime:0})],{type:rM});return{contentType:rM,body:r,estimatedSize:r.size}}if(i===y.Base64){var s=(e=>"data="+encodeURIComponent("string"==typeof e?e:rB(e)))(function(e){var t,i,r,s,n,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,l=0,c="",u=[];if(!e)return e;e=rL(e);do t=(n=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>18&63,i=n>>12&63,r=n>>6&63,s=63&n,u[l++]=o.charAt(t)+o.charAt(i)+o.charAt(r)+o.charAt(s);while(a<e.length);switch(c=u.join(""),e.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}(rB(t)));return{contentType:"application/x-www-form-urlencoded",body:s,estimatedSize:new Blob([s]).size}}var n=rB(t);return{contentType:"application/json",body:n,estimatedSize:new Blob([n]).size}}},rD=[];h&&rD.push({transport:"fetch",method:e=>{var t,i,{contentType:r,body:s,estimatedSize:n}=null!=(t=rU(e))?t:{},o=new Headers;X(e.headers,function(e,t){o.append(t,e)}),r&&o.append("Content-Type",r);var a=e.url,l=null;if(f){var c=new f;l={signal:c.signal,timeout:setTimeout(()=>c.abort(),e.timeout)}}h(a,W({method:(null==e?void 0:e.method)||"GET",headers:o,keepalive:"POST"===e.method&&52428.8>(n||0),body:s,signal:null==(i=l)?void 0:i.signal},e.fetchOptions)).then(t=>t.text().then(i=>{var r={statusCode:t.status,text:i};if(200===t.status)try{r.json=JSON.parse(i)}catch(e){q.error(e)}null==e.callback||e.callback(r)})).catch(t=>{q.error(t),null==e.callback||e.callback({statusCode:0,text:t})}).finally(()=>l?clearTimeout(l.timeout):null)}}),d&&rD.push({transport:"XHR",method:e=>{var t,i=new d;i.open(e.method||"GET",e.url,!0);var{contentType:r,body:s}=null!=(t=rU(e))?t:{};X(e.headers,function(e,t){i.setRequestHeader(t,e)}),r&&i.setRequestHeader("Content-Type",r),e.timeout&&(i.timeout=e.timeout),i.withCredentials=!0,i.onreadystatechange=()=>{if(4===i.readyState){var t={statusCode:i.status,text:i.responseText};if(200===i.status)try{t.json=JSON.parse(i.responseText)}catch(e){}null==e.callback||e.callback(t)}},i.send(s)}}),null!=l&&l.sendBeacon&&rD.push({transport:"sendBeacon",method:e=>{var t=rN(e.url,{beacon:"1"});try{var i,{contentType:r,body:s}=null!=(i=rU(e))?i:{},n="string"==typeof s?new Blob([s],{type:r}):s;l.sendBeacon(t,n)}catch(e){}}});var rq=function(e,t){if(!function(e){try{new RegExp(e)}catch(e){return!1}return!0}(t))return!1;try{return new RegExp(t).test(e)}catch(e){return!1}};function rH(e,t,i){return rB({distinct_id:e,userPropertiesToSet:t,userPropertiesToSetOnce:i})}var rz={exact:(e,t)=>t.some(t=>e.some(e=>t===e)),is_not:(e,t)=>t.every(t=>e.every(e=>t!==e)),regex:(e,t)=>t.some(t=>e.some(e=>rq(t,e))),not_regex:(e,t)=>t.every(t=>e.every(e=>!rq(t,e))),icontains:(e,t)=>t.map(rG).some(t=>e.map(rG).some(e=>t.includes(e))),not_icontains:(e,t)=>t.map(rG).every(t=>e.map(rG).every(e=>!t.includes(e)))},rG=e=>e.toLowerCase(),rW=H("[Error tracking]");class rJ{constructor(e){var t,i;this.oe=[],this._instance=e,this.oe=null!=(t=null==(i=this._instance.persistence)?void 0:i.get_property(ed))?t:[]}onRemoteConfig(e){var t,i,r=null!=(t=null==(i=e.errorTracking)?void 0:i.suppressionRules)?t:[];this.oe=r,this._instance.persistence&&this._instance.persistence.register({[ed]:this.oe})}sendExceptionEvent(e){this.ae(e)?rW.info("Skipping exception capture because a suppression rule matched"):this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}ae(e){var t=e.$exception_list;if(!t||!P(t)||0===t.length)return!1;var i=t.reduce((e,t)=>{var{type:i,value:r}=t;return R(i)&&i.length>0&&e.$exception_types.push(i),R(r)&&r.length>0&&e.$exception_messages.push(r),e},{$exception_types:[],$exception_messages:[]});return this.oe.some(e=>{var t=e.values.map(e=>{var t=rz[e.operator],r=P(e.value)?e.value:[e.value],s=i[e.key];return r.length>0&&t(r,s)});return"OR"===e.type?t.some(Boolean):t.every(Boolean)})}}var rK="Mobile",rV="Android",rX="Tablet",rY=rV+" "+rX,rZ="iPad",rQ="Apple",r0=rQ+" Watch",r1="Safari",r2="BlackBerry",r5="Samsung",r3=r5+"Browser",r6=r5+" Internet",r8="Chrome",r4=r8+" OS",r7=r8+" iOS",r9="Internet Explorer",se=r9+" "+rK,st="Opera",si=st+" Mini",sr="Edge",ss="Microsoft "+sr,sn="Firefox",so=sn+" iOS",sa="Nintendo",sl="PlayStation",sc="Xbox",su=rV+" "+rK,sh=rK+" "+r1,sd="Windows",sf=sd+" Phone",sp="Nokia",sg="Ouya",sv="Generic",s_=sv+" "+rK.toLowerCase(),sm=sv+" "+rX.toLowerCase(),sy="Konqueror",sb="(\\d+(\\.\\d+)?)",sw=RegExp("Version/"+sb),sk=RegExp(sc,"i"),sS=RegExp(sl+" \\w+","i"),sE=RegExp(sa+" \\w+","i"),sx=RegExp(r2+"|PlayBook|BB10","i"),sT={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},sO=(e,t)=>t&&w(t,rQ)||function(e){return w(e,r1)&&!w(e,r8)&&!w(e,rV)}(e),sP=function(e,t){return t=t||"",w(e," OPR/")&&w(e,"Mini")?si:w(e," OPR/")?st:sx.test(e)?r2:w(e,"IE"+rK)||w(e,"WPDesktop")?se:w(e,r3)?r6:w(e,sr)||w(e,"Edg/")?ss:w(e,"FBIOS")?"Facebook "+rK:w(e,"UCWEB")||w(e,"UCBrowser")?"UC Browser":w(e,"CriOS")?r7:w(e,"CrMo")||w(e,r8)?r8:w(e,rV)&&w(e,r1)?su:w(e,"FxiOS")?so:w(e.toLowerCase(),sy.toLowerCase())?sy:sO(e,t)?w(e,rK)?sh:r1:w(e,sn)?sn:w(e,"MSIE")||w(e,"Trident/")?r9:w(e,"Gecko")?sn:""},sI={[se]:[RegExp("rv:"+sb)],[ss]:[RegExp(sr+"?\\/"+sb)],[r8]:[RegExp("("+r8+"|CrMo)\\/"+sb)],[r7]:[RegExp("CriOS\\/"+sb)],"UC Browser":[RegExp("(UCBrowser|UCWEB)\\/"+sb)],[r1]:[sw],[sh]:[sw],[st]:[RegExp("(Opera|OPR)\\/"+sb)],[sn]:[RegExp(sn+"\\/"+sb)],[so]:[RegExp("FxiOS\\/"+sb)],[sy]:[RegExp("Konqueror[:/]?"+sb,"i")],[r2]:[RegExp(r2+" "+sb),sw],[su]:[RegExp("android\\s"+sb,"i")],[r6]:[RegExp(r3+"\\/"+sb)],[r9]:[RegExp("(rv:|MSIE )"+sb)],Mozilla:[RegExp("rv:"+sb)]},sC=function(e,t){var i=sI[sP(e,t)];if($(i))return null;for(var r=0;r<i.length;r++){var s=i[r],n=e.match(s);if(n)return parseFloat(n[n.length-2])}return null},sA=[[RegExp(sc+"; "+sc+" (.*?)[);]","i"),e=>[sc,e&&e[1]||""]],[RegExp(sa,"i"),[sa,""]],[RegExp(sl,"i"),[sl,""]],[sx,[r2,""]],[RegExp(sd,"i"),(e,t)=>{if(/Phone/.test(t)||/WPDesktop/.test(t))return[sf,""];if(new RegExp(rK).test(t)&&!/IEMobile\b/.test(t))return[sd+" "+rK,""];var i=/Windows NT ([0-9.]+)/i.exec(t);if(i&&i[1]){var r=sT[i[1]]||"";return/arm/i.test(t)&&(r="RT"),[sd,r]}return[sd,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,e=>e&&e[3]?["iOS",[e[3],e[4],e[5]||"0"].join(".")]:["iOS",""]],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,e=>{var t="";return e&&e.length>=3&&(t=$(e[2])?e[3]:e[2]),["watchOS",t]}],[RegExp("("+rV+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+rV+")","i"),e=>e&&e[2]?[rV,[e[2],e[3],e[4]||"0"].join(".")]:[rV,""]],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,e=>{var t=["Mac OS X",""];if(e&&e[1]){var i=[e[1],e[2],e[3]||"0"];t[1]=i.join(".")}return t}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[r4,""]],[/Linux|debian/i,["Linux",""]]],s$=function(e){return sE.test(e)?sa:sS.test(e)?sl:sk.test(e)?sc:RegExp(sg,"i").test(e)?sg:RegExp("("+sf+"|WPDesktop)","i").test(e)?sf:/iPad/.test(e)?rZ:/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(e)?r0:sx.test(e)?r2:/(kobo)\s(ereader|touch)/i.test(e)?"Kobo":RegExp(sp,"i").test(e)?sp:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(e)||/(kf[a-z]+)( bui|\)).+silk\//i.test(e)?"Kindle Fire":/(Android|ZTE)/i.test(e)?!new RegExp(rK).test(e)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(e)?/pixel[\daxl ]{1,6}/i.test(e)&&!/pixel c/i.test(e)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(e)||/lmy47v/i.test(e)&&!/QTAQZ3/i.test(e)?rV:rY:rV:RegExp("(pda|"+rK+")","i").test(e)?s_:RegExp(rX,"i").test(e)&&!RegExp(rX+" pc","i").test(e)?sm:""},sR="https?://(.*)",sj=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],sL=Z(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],sj),sF="<masked>";function sM(e,t,i){if(!c)return{};var r=t?Z([],sj,i||[]):[];return sN(th(c.URL,r,sF),e)}function sN(e,t){var i=sL.concat(t||[]),r={};return X(i,function(t){var i=tu(e,t);r[t]=i||null}),r}function sB(e){var t=e?0===e.search(sR+"google.([^/?]*)")?"google":0===e.search(sR+"bing.com")?"bing":0===e.search(sR+"yahoo.com")?"yahoo":0===e.search(sR+"duckduckgo.com")?"duckduckgo":null:null,i={};if(!L(t)){i.$search_engine=t;var r=c?tu(c.referrer,"yahoo"!=t?"q":"p"):"";r.length&&(i.ph_keyword=r)}return i}function sU(){return navigator.language||navigator.userLanguage}function sD(){return(null==c?void 0:c.referrer)||"$direct"}function sq(e,t){var i=e?Z([],sj,t||[]):[],r=null==u?void 0:u.href.substring(0,1e3);return{r:sD().substring(0,1e3),u:r?th(r,i,sF):void 0}}function sH(e){var t,{r:i,u:r}=e,s={$referrer:i,$referring_domain:null==i?void 0:"$direct"==i?"$direct":null==(t=tl(i))?void 0:t.host};if(r){s.$current_url=r;var n=tl(r);s.$host=null==n?void 0:n.host,s.$pathname=null==n?void 0:n.pathname,Y(s,sN(r))}return i&&Y(s,sB(i)),s}function sz(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return}}var sG=H("[FeatureFlags]"),sW="$active_feature_flags",sJ="$override_feature_flags",sK="$feature_flag_payloads",sV="$override_feature_flag_payloads",sX="$feature_flag_request_id",sY=e=>{var t={};for(var[i,r]of Q(e||{}))r&&(t[i]=r);return t},sZ=e=>{var t=e.flags;return t?(e.featureFlags=Object.fromEntries(Object.keys(t).map(e=>{var i;return[e,null!=(i=t[e].variant)?i:t[e].enabled]})),e.featureFlagPayloads=Object.fromEntries(Object.keys(t).filter(e=>t[e].enabled).filter(e=>{var i;return null==(i=t[e].metadata)?void 0:i.payload}).map(e=>{var i;return[e,null==(i=t[e].metadata)?void 0:i.payload]}))):sG.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),e},sQ=function(e){return e.FeatureFlags="feature_flags",e.Recordings="recordings",e}({});class s0{constructor(e){this.le=!1,this.ue=!1,this.he=!1,this.de=!1,this.ve=!1,this.ce=!1,this.fe=!1,this._instance=e,this.featureFlagEventHandlers=[]}decide(){if(this._instance.config.__preview_remote_config)this.ce=!0;else{var e=!this.pe&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.ge({disableFlags:e})}}get hasLoadedFlags(){return this.ue}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(eC),t=this._instance.get_property(sJ),i=this._instance.get_property(sV);if(!i&&!t)return e||{};var r=Y({},e||{});for(var s of[...new Set([...Object.keys(i||{}),...Object.keys(t||{})])]){var n,o,a=r[s],l=null==t?void 0:t[s],c=$(l)?null!=(n=null==a?void 0:a.enabled)&&n:!!l,u=$(l)?a.variant:"string"==typeof l?l:void 0,h=null==i?void 0:i[s],d=W({},a,{enabled:c,variant:c?null!=u?u:null==a?void 0:a.variant:void 0});c!==(null==a?void 0:a.enabled)&&(d.original_enabled=null==a?void 0:a.enabled),u!==(null==a?void 0:a.variant)&&(d.original_variant=null==a?void 0:a.variant),h&&(d.metadata=W({},null==a?void 0:a.metadata,{payload:h,original_payload:null==a||null==(o=a.metadata)?void 0:o.payload})),r[s]=d}return this.le||(sG.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:i,finalDetails:r}),this.le=!0),r}getFlagVariants(){var e=this._instance.get_property(eP),t=this._instance.get_property(sJ);if(!t)return e||{};for(var i=Y({},e),r=Object.keys(t),s=0;s<r.length;s++)i[r[s]]=t[r[s]];return this.le||(sG.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:i}),this.le=!0),i}getFlagPayloads(){var e=this._instance.get_property(sK),t=this._instance.get_property(sV);if(!t)return e||{};for(var i=Y({},e||{}),r=Object.keys(t),s=0;s<r.length;s++)i[r[s]]=t[r[s]];return this.le||(sG.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:i}),this.le=!0),i}reloadFeatureFlags(){this.de||this._instance.config.advanced_disable_feature_flags||this.pe||(this.pe=setTimeout(()=>{this.ge()},5))}_e(){clearTimeout(this.pe),this.pe=void 0}ensureFlagsLoaded(){this.ue||this.he||this.pe||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.de=e}ge(e){var t;if(this._e(),!this._instance.config.advanced_disable_decide)if(this.he)this.ve=!0;else{var i={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:W({},(null==(t=this._instance.persistence)?void 0:t.get_initial_props())||{},this._instance.get_property(eA)||{}),group_properties:this._instance.get_property(e$)};(null!=e&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0);var r=this._instance.config.__preview_flags_v2&&this._instance.config.__preview_remote_config;r&&(i.timezone=sz()),this.he=!0,this._instance.me({method:"POST",url:this._instance.requestRouter.endpointFor("api",r?"/flags/?v=2":"/decide/?v=4"),data:i,compression:this._instance.config.disable_compression?void 0:y.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:e=>{var t,r,s,n=!0;200===e.statusCode&&(this.ve||(this.$anon_distinct_id=void 0),n=!1),this.he=!1,this.ce||(this.ce=!0,this._instance.be(null!=(s=e.json)?s:{})),(!i.disable_flags||this.ve)&&((this.fe=!n,e.json&&null!=(r=e.json.quotaLimited)&&r.includes(sQ.FeatureFlags))?sG.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more."):(i.disable_flags||this.receivedFeatureFlags(null!=(t=e.json)?t:{},n),this.ve&&(this.ve=!1,this.ge())))}})}}getFeatureFlag(e,t){if(void 0===t&&(t={}),this.ue||this.getFlags()&&this.getFlags().length>0){var i=this.getFlagVariants()[e],r=""+i,s=this._instance.get_property(sX)||void 0,n=this._instance.get_property(eL)||{};if((t.send_event||!("send_event"in t))&&(!(e in n)||!n[e].includes(r))){P(n[e])?n[e].push(r):n[e]=[r],null==(l=this._instance.persistence)||l.register({[eL]:n});var o=this.getFeatureFlagDetails(e),a={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:s,$feature_flag_bootstrapped_response:(null==(c=this._instance.config.bootstrap)||null==(c=c.featureFlags)?void 0:c[e])||null,$feature_flag_bootstrapped_payload:(null==(u=this._instance.config.bootstrap)||null==(u=u.featureFlagPayloads)?void 0:u[e])||null,$used_bootstrap_value:!this.fe};$(null==o||null==(h=o.metadata)?void 0:h.version)||(a.$feature_flag_version=o.metadata.version);var l,c,u,h,d,f,p,g,v,_,m=null!=(d=null==o||null==(f=o.reason)?void 0:f.description)?d:null==o||null==(p=o.reason)?void 0:p.code;m&&(a.$feature_flag_reason=m),null!=o&&null!=(g=o.metadata)&&g.id&&(a.$feature_flag_id=o.metadata.id),$(null==o?void 0:o.original_variant)&&$(null==o?void 0:o.original_enabled)||(a.$feature_flag_original_response=$(o.original_variant)?o.original_enabled:o.original_variant),null!=o&&null!=(v=o.metadata)&&v.original_payload&&(a.$feature_flag_original_payload=null==o||null==(_=o.metadata)?void 0:_.original_payload),this._instance.capture("$feature_flag_called",a)}return i}sG.warn('getFeatureFlag for key "'+e+"\" failed. Feature flags didn't load in time.")}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,t){var i=this._instance.config.token;this._instance.me({method:"POST",url:this._instance.requestRouter.endpointFor("api","/decide/?v=4"),data:{distinct_id:this._instance.get_distinct_id(),token:i},compression:this._instance.config.disable_compression?void 0:y.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var r,s=null==(r=i.json)?void 0:r.featureFlagPayloads;t((null==s?void 0:s[e])||void 0)}})}isFeatureEnabled(e,t){if(void 0===t&&(t={}),this.ue||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,t);sG.warn('isFeatureEnabled for key "'+e+"\" failed. Feature flags didn't load in time.")}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(t=>t!==e)}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ue=!0;var i=this.getFlagVariants(),r=this.getFlagPayloads(),s=this.getFlagsWithDetails();!function(e,t,i,r,s){void 0===i&&(i={}),void 0===r&&(r={}),void 0===s&&(s={});var n=sZ(e),o=n.flags,a=n.featureFlags,l=n.featureFlagPayloads;if(a){var c=e.requestId;if(P(a)){sG.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var u={};if(a)for(var h=0;h<a.length;h++)u[a[h]]=!0;t&&t.register({[sW]:a,[eP]:u})}else{var d=a,f=l,p=o;e.errorsWhileComputingFlags&&(d=W({},i,d),f=W({},r,f),p=W({},s,p)),t&&t.register(W({[sW]:Object.keys(sY(d)),[eP]:d||{},[sK]:f||{},[eC]:p||{}},c?{[sX]:c}:{}))}}}(e,this._instance.persistence,i,r,s),this.we(t)}}override(e,t){void 0===t&&(t=!1),sG.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return sG.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(!1===e)return this._instance.persistence.unregister(sJ),this._instance.persistence.unregister(sV),void this.we();if(e&&"object"==typeof e&&("flags"in e||"payloads"in e)){var t;if(this.le=!!(null!=(t=e.suppressWarning)&&t),"flags"in e){if(!1===e.flags)this._instance.persistence.unregister(sJ);else if(e.flags)if(P(e.flags)){for(var i={},r=0;r<e.flags.length;r++)i[e.flags[r]]=!0;this._instance.persistence.register({[sJ]:i})}else this._instance.persistence.register({[sJ]:e.flags})}return"payloads"in e&&(!1===e.payloads?this._instance.persistence.unregister(sV):e.payloads&&this._instance.persistence.register({[sV]:e.payloads})),void this.we()}this.we()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ue){var{flags:t,flagVariants:i}=this.ye();e(t,i)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t){var i,r=(this._instance.get_property(eI)||[]).find(t=>t.flagKey===e),s={["$feature_enrollment/"+e]:t},n={$feature_flag:e,$feature_enrollment:t,$set:s};r&&(n.$early_access_feature_name=r.name),this._instance.capture("$feature_enrollment_update",n),this.setPersonPropertiesForFlags(s,!1);var o=W({},this.getFlagVariants(),{[e]:t});null==(i=this._instance.persistence)||i.register({[sW]:Object.keys(sY(o)),[eP]:o}),this.we()}getEarlyAccessFeatures(e,t,i){void 0===t&&(t=!1);var r=this._instance.get_property(eI),s=i?"&"+i.map(e=>"stage="+e).join("&"):"";if(r&&!t)return e(r);this._instance.me({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+s),method:"GET",callback:t=>{var i;if(t.json){var r=t.json.earlyAccessFeatures;return null==(i=this._instance.persistence)||i.register({[eI]:r}),e(r)}}})}ye(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter(e=>t[e]),flagVariants:Object.keys(t).filter(e=>t[e]).reduce((e,i)=>(e[i]=t[i],e),{})}}we(e){var{flags:t,flagVariants:i}=this.ye();this.featureFlagEventHandlers.forEach(r=>r(t,i,{errorsLoading:e}))}setPersonPropertiesForFlags(e,t){void 0===t&&(t=!0);var i=this._instance.get_property(eA)||{};this._instance.register({[eA]:W({},i,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(eA)}setGroupPropertiesForFlags(e,t){void 0===t&&(t=!0);var i=this._instance.get_property(e$)||{};0!==Object.keys(i).length&&Object.keys(i).forEach(t=>{i[t]=W({},i[t],e[t]),delete e[t]}),this._instance.register({[e$]:W({},i,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(e$)||{};this._instance.register({[e$]:W({},t,{[e]:{}})})}else this._instance.unregister(e$)}}var s1=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class s2{constructor(e){this.S=e,this.props={},this.Se=!1,this.$e=(e=>{var t="";return e.token&&(t=e.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),e.persistence_name?"ph_"+e.persistence_name:"ph_"+t+"_posthog"})(e),this.q=this.ke(e),this.load(),e.debug&&q.info("Persistence loaded",e.persistence,W({},this.props)),this.update_config(e,e),this.save()}ke(e){-1===s1.indexOf(e.persistence.toLowerCase())&&(q.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return"localstorage"===t&&tP.O()?tP:"localstorage+cookie"===t&&tC.O()?tC:"sessionstorage"===t&&tj.O()?tj:"memory"===t?t$:"cookie"===t?tT:tC.O()?tC:tT}properties(){var e={};return X(this.props,function(t,i){if(i===eP&&C(t))for(var r,s=Object.keys(t),n=0;n<s.length;n++)e["$feature/"+s[n]]=t[s[n]];else r=!1,(L(eG)?r:a&&eG.indexOf===a?-1!=eG.indexOf(i):(X(eG,function(e){if(r||(r=e===i))return K}),r))||(e[i]=t)}),e}load(){if(!this.xe){var e=this.q.D(this.$e);e&&(this.props=Y({},e))}}save(){this.xe||this.q.L(this.$e,this.props,this.Ee,this.Ie,this.Pe,this.S.debug)}remove(){this.q.N(this.$e,!1),this.q.N(this.$e,!0)}clear(){this.remove(),this.props={}}register_once(e,t,i){if(C(e)){$(t)&&(t="None"),this.Ee=$(i)?this.Re:i;var r=!1;if(X(e,(e,i)=>{this.props.hasOwnProperty(i)&&this.props[i]!==t||(this.props[i]=e,r=!0)}),r)return this.save(),!0}return!1}register(e,t){if(C(e)){this.Ee=$(t)?this.Re:t;var i=!1;if(X(e,(t,r)=>{e.hasOwnProperty(r)&&this.props[r]!==t&&(this.props[r]=t,i=!0)}),i)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.Se){var e=sM(this.S.custom_campaign_params,this.S.mask_personal_data_properties,this.S.custom_personal_data_properties);A(ei(e))||this.register(e),this.Se=!0}}update_search_keyword(){var e;this.register((e=null==c?void 0:c.referrer)?sB(e):{})}update_referrer_info(){var e;this.register_once({$referrer:sD(),$referring_domain:null!=c&&c.referrer&&(null==(e=tl(c.referrer))?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[eB]||this.props[eU]||this.register_once({[eD]:sq(this.S.mask_personal_data_properties,this.S.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};X([eU,eB],t=>{var i=this.props[t];i&&X(i,function(t,i){e["$initial_"+S(i)]=t})});var t,i,r=this.props[eD];return r&&Y(e,(t=sH(r),i={},X(t,function(e,t){i["$initial_"+S(t)]=e}),i)),e}safe_merge(e){return X(this.props,function(t,i){i in e||(e[i]=t)}),e}update_config(e,t){if(this.Re=this.Ee=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var i=this.ke(e),r=this.props;this.clear(),this.q=i,this.props=r,this.save()}}set_disabled(e){this.xe=e,this.xe?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ie&&(this.Ie=e,this.remove(),this.save())}set_secure(e){e!==this.Pe&&(this.Pe=e,this.remove(),this.save())}set_event_timer(e,t){var i=this.props[el]||{};i[e]=t,this.props[el]=i,this.save()}remove_event_timer(e){var t=(this.props[el]||{})[e];return $(t)||(delete this.props[el][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}class s5{constructor(){this.Te={},this.Te={}}on(e,t){return this.Te[e]||(this.Te[e]=[]),this.Te[e].push(t),()=>{this.Te[e]=this.Te[e].filter(e=>e!==t)}}emit(e,t){for(var i of this.Te[e]||[])i(t);for(var r of this.Te["*"]||[])r(e,t)}}class s3{constructor(e){this.Me=new s5,this.Ce=(e,t)=>this.Oe(e,t)&&this.Fe(e,t)&&this.Ae(e,t),this.Oe=(e,t)=>null==t||!t.event||(null==e?void 0:e.event)===(null==t?void 0:t.event),this._instance=e,this.De=new Set,this.Le=new Set}init(){var e,t;$(null==(e=this._instance)?void 0:e.Ne)||null==(t=this._instance)||t.Ne((e,t)=>{this.on(e,t)})}register(e){var t,i;if(!$(null==(t=this._instance)?void 0:t.Ne)&&(e.forEach(e=>{var t,i;null==(t=this.Le)||t.add(e),null==(i=e.steps)||i.forEach(e=>{var t;null==(t=this.De)||t.add((null==e?void 0:e.event)||"")})}),null!=(i=this._instance)&&i.autocapture)){var r,s=new Set;e.forEach(e=>{var t;null==(t=e.steps)||t.forEach(e=>{null!=e&&e.selector&&s.add(null==e?void 0:e.selector)})}),null==(r=this._instance)||r.autocapture.setElementSelectors(s)}}on(e,t){var i;null!=t&&0!=e.length&&(this.De.has(e)||this.De.has(null==t?void 0:t.event))&&this.Le&&(null==(i=this.Le)?void 0:i.size)>0&&this.Le.forEach(e=>{this.je(t,e)&&this.Me.emit("actionCaptured",e.name)})}ze(e){this.onAction("actionCaptured",t=>e(t))}je(e,t){if(null==(null==t?void 0:t.steps))return!1;for(var i of t.steps)if(this.Ce(e,i))return!0;return!1}onAction(e,t){return this.Me.on(e,t)}Fe(e,t){if(null!=t&&t.url){var i,r=null==e||null==(i=e.properties)?void 0:i.$current_url;if(!r||"string"!=typeof r||!s3.Ue(r,null==t?void 0:t.url,(null==t?void 0:t.url_matching)||"contains"))return!1}return!0}static Ue(e,t,i){switch(i){case"regex":return!!r&&rq(e,t);case"exact":return t===e;case"contains":return rq(e,s3.qe(t).replace(/_/g,".").replace(/%/g,".*"));default:return!1}}static qe(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}Ae(e,t){if((null!=t&&t.href||null!=t&&t.tag_name||null!=t&&t.text)&&!this.Be(e).some(e=>!(null!=t&&t.href&&!s3.Ue(e.href||"",null==t?void 0:t.href,(null==t?void 0:t.href_matching)||"exact"))&&(null==t||!t.tag_name||e.tag_name===(null==t?void 0:t.tag_name))&&!(null!=t&&t.text&&!s3.Ue(e.text||"",null==t?void 0:t.text,(null==t?void 0:t.text_matching)||"exact")&&!s3.Ue(e.$el_text||"",null==t?void 0:t.text,(null==t?void 0:t.text_matching)||"exact"))))return!1;if(null!=t&&t.selector){var i,r=null==e||null==(i=e.properties)?void 0:i.$element_selectors;if(!r||!r.includes(null==t?void 0:t.selector))return!1}return!0}Be(e){return null==(null==e?void 0:e.properties.$elements)?[]:null==e?void 0:e.properties.$elements}}var s6=H("[Surveys]");class s8{constructor(e){this._instance=e,this.He=new Map,this.We=new Map}register(e){var t;$(null==(t=this._instance)?void 0:t.Ne)||(this.Ge(e),this.Je(e))}Je(e){var t=e.filter(e=>{var t,i;return(null==(t=e.conditions)?void 0:t.actions)&&(null==(i=e.conditions)||null==(i=i.actions)||null==(i=i.values)?void 0:i.length)>0});0!==t.length&&(null==this.Ve&&(this.Ve=new s3(this._instance),this.Ve.init(),this.Ve.ze(e=>{this.onAction(e)})),t.forEach(e=>{var t,i,r,s,n;e.conditions&&null!=(t=e.conditions)&&t.actions&&null!=(i=e.conditions)&&null!=(i=i.actions)&&i.values&&(null==(r=e.conditions)||null==(r=r.actions)||null==(r=r.values)?void 0:r.length)>0&&(null==(s=this.Ve)||s.register(e.conditions.actions.values),null==(n=e.conditions)||null==(n=n.actions)||null==(n=n.values)||n.forEach(t=>{if(t&&t.name){var i=this.We.get(t.name);i&&i.push(e.id),this.We.set(t.name,i||[e.id])}}))}))}Ge(e){var t;0!==e.filter(e=>{var t,i;return(null==(t=e.conditions)?void 0:t.events)&&(null==(i=e.conditions)||null==(i=i.events)||null==(i=i.values)?void 0:i.length)>0}).length&&(null==(t=this._instance)||t.Ne((e,t)=>{this.onEvent(e,t)}),e.forEach(e=>{var t;null==(t=e.conditions)||null==(t=t.events)||null==(t=t.values)||t.forEach(t=>{if(t&&t.name){var i=this.He.get(t.name);i&&i.push(e.id),this.He.set(t.name,i||[e.id])}})}))}onEvent(e,t){var i,r=(null==(i=this._instance)||null==(i=i.persistence)?void 0:i.props[ej])||[];if("survey shown"===e&&t&&r.length>0){s6.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:t,existingActivatedSurveys:r});var s,n=null==t||null==(s=t.properties)?void 0:s.$survey_id;if(n){var o=r.indexOf(n);o>=0&&(r.splice(o,1),this.Ke(r))}}else this.He.has(e)&&(s6.info("survey event matched, updating activated surveys",{event:e,surveys:this.He.get(e)}),this.Ke(r.concat(this.He.get(e)||[])))}onAction(e){var t,i=(null==(t=this._instance)||null==(t=t.persistence)?void 0:t.props[ej])||[];this.We.has(e)&&this.Ke(i.concat(this.We.get(e)||[]))}Ke(e){var t;null==(t=this._instance)||null==(t=t.persistence)||t.register({[ej]:[...new Set(e)]})}getSurveys(){var e;return(null==(e=this._instance)||null==(e=e.persistence)?void 0:e.props[ej])||[]}getEventToSurveys(){return this.He}Ye(){return this.Ve}}class s4{constructor(e){this.Xe=null,this.Qe=!1,this.Ze=!1,this.tr=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){var t=e.surveys;if(F(t))return s6.warn("Decide not loaded yet. Not loading surveys.");var i=P(t);this.ir=i?t.length>0:t,s6.info("decide response received, hasSurveys: "+this.ir),this.ir&&this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var i=localStorage.key(t);(null!=i&&i.startsWith("seenSurvey_")||null!=i&&i.startsWith("inProgressSurvey_"))&&e.push(i)}e.forEach(e=>localStorage.removeItem(e))}loadIfEnabled(){if(!this.Xe)if(this.Ze)s6.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)s6.info("Disabled. Not loading surveys.");else if(this.ir){var e=null==g?void 0:g.__PosthogExtensions__;if(e){this.Ze=!0;try{var t=e.generateSurveys;if(t)return void this.er(t);var i=e.loadExternalDependency;if(!i)return void this.rr("PostHog loadExternalDependency extension not found.");i(this._instance,"surveys",t=>{t||!e.generateSurveys?this.rr("Could not load surveys script",t):this.er(e.generateSurveys)})}catch(e){throw this.rr("Error initializing surveys",e),e}finally{this.Ze=!1}}else s6.error("PostHog Extensions not found.")}else s6.info("No surveys to load.")}er(e){this.Xe=e(this._instance),this._surveyEventReceiver=new s8(this._instance),s6.info("Surveys loaded successfully"),this.sr({isLoaded:!0})}rr(e,t){s6.error(e,t),this.sr({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.tr.push(e),this.Xe&&this.sr({isLoaded:!0}),()=>{this.tr=this.tr.filter(t=>t!==e)}}getSurveys(e,t){if(void 0===t&&(t=!1),this._instance.config.disable_surveys)return s6.info("Disabled. Not loading surveys."),e([]);var i=this._instance.get_property(eR);if(i&&!t)return e(i,{isLoaded:!0});if(this.Qe)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.Qe=!0,this._instance.me({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:t=>{this.Qe=!1;var i=t.statusCode;if(200!==i||!t.json){var r="Surveys API could not be loaded, status: "+i;return s6.error(r),e([],{isLoaded:!1,error:r})}var s,n,o=t.json.surveys||[],a=o.filter(e=>{var t,i;return!(!e.start_date||e.end_date)&&(!(null==(t=e.conditions)||null==(t=t.events)||null==(t=t.values)||!t.length)||!(null==(i=e.conditions)||null==(i=i.actions)||null==(i=i.values)||!i.length))});return a.length>0&&(null==(n=this._surveyEventReceiver)||n.register(a)),null==(s=this._instance.persistence)||s.register({[eR]:o}),e(o,{isLoaded:!0})}})}catch(e){throw this.Qe=!1,e}}sr(e){for(var t of this.tr)try{e.isLoaded?this.getSurveys(t):t([],e)}catch(e){s6.error("Error in survey callback",e)}}getActiveMatchingSurveys(e,t){if(void 0===t&&(t=!1),!F(this.Xe))return this.Xe.getActiveMatchingSurveys(e,t);s6.warn("init was not called")}nr(e){var t=null;return this.getSurveys(i=>{var r;t=null!=(r=i.find(t=>t.id===e))?r:null}),t}ar(e){if(F(this.Xe))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t="string"==typeof e?this.nr(e):e;return t?this.Xe.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(F(this.Xe))return s6.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.ar(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return F(this.Xe)?(s6.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise(i=>{this.getSurveys(t=>{var r,s=null!=(r=t.find(t=>t.id===e))?r:null;if(s){var n=this.ar(s);i({visible:n.eligible,disabledReason:n.reason})}else i({visible:!1,disabledReason:"Survey not found"})},t)})}renderSurvey(e,t){if(F(this.Xe))s6.warn("init was not called");else{var i=this.nr(e),r=null==c?void 0:c.querySelector(t);i?r?this.Xe.renderSurvey(i,r):s6.warn("Survey element not found"):s6.warn("Survey not found")}}}var s7=H("[RateLimiter]");class s9{constructor(e){var t,i;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=e=>{var t=e.text;if(t&&t.length)try{(JSON.parse(t).quota_limited||[]).forEach(e=>{s7.info((e||"events")+" is quota limited."),this.serverLimits[e]=(new Date).getTime()+6e4})}catch(e){return void s7.warn('could not rate limit - continuing. Error: "'+(null==e?void 0:e.message)+'"',{text:t})}},this.instance=e,this.captureEventsPerSecond=(null==(t=e.config.rate_limiting)?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null==(i=e.config.rate_limiting)?void 0:i.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){void 0===e&&(e=!1);var t,i,r,s=(new Date).getTime(),n=null!=(t=null==(i=this.instance.persistence)?void 0:i.get_property(eN))?t:{tokens:this.captureEventsBurstLimit,last:s};n.tokens+=(s-n.last)/1e3*this.captureEventsPerSecond,n.last=s,n.tokens>this.captureEventsBurstLimit&&(n.tokens=this.captureEventsBurstLimit);var o=n.tokens<1;return o||e||(n.tokens=Math.max(0,n.tokens-1)),!o||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=o,null==(r=this.instance.persistence)||r.set_property(eN,n),{isRateLimited:o,remainingTokens:n.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return!1!==t&&(new Date).getTime()<t}}var ne=H("[RemoteConfig]");class nt{constructor(e){this._instance=e}get remoteConfig(){var e;return null==(e=g._POSTHOG_REMOTE_CONFIG)||null==(e=e[this._instance.config.token])?void 0:e.config}lr(e){var t,i;null!=(t=g.__PosthogExtensions__)&&t.loadExternalDependency?null==(i=g.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"remote-config",()=>e(this.remoteConfig)):(ne.error("PostHog Extensions not found. Cannot load remote config."),e())}ur(e){this._instance.me({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return ne.info("Using preloaded remote config",this.remoteConfig),void this.be(this.remoteConfig);if(this._instance.config.advanced_disable_decide)return void ne.warn("Remote config is disabled. Falling back to local config.");this.lr(e=>{if(!e)return ne.info("No config found after loading remote JS config. Falling back to JSON."),void this.ur(e=>{this.be(e)});this.be(e)})}catch(e){ne.error("Error loading remote config",e)}}be(e){e?this._instance.config.__preview_remote_config?(this._instance.be(e),!1!==e.hasFeatureFlags&&this._instance.featureFlags.ensureFlagsLoaded()):ne.info("__preview_remote_config is disabled. Logging config instead",e):ne.error("Failed to fetch remote config from PostHog.")}}class ni{constructor(e,t){this.hr=!0,this.dr=[],this.vr=i_((null==t?void 0:t.flush_interval_ms)||3e3,250,5e3,"flush interval",3e3),this.cr=e}enqueue(e){this.dr.push(e),this.pr||this.gr()}unload(){this._r();var e=Object.values(this.dr.length>0?this.mr():{});[...e.filter(e=>0===e.url.indexOf("/e")),...e.filter(e=>0!==e.url.indexOf("/e"))].map(e=>{this.cr(W({},e,{transport:"sendBeacon"}))})}enable(){this.hr=!1,this.gr()}gr(){var e=this;this.hr||(this.pr=setTimeout(()=>{if(this._r(),this.dr.length>0){var t=this.mr();for(var i in t)!function(){var r=t[i],s=(new Date).getTime();r.data&&P(r.data)&&X(r.data,e=>{e.offset=Math.abs(e.timestamp-s),delete e.timestamp}),e.cr(r)}()}},this.vr))}_r(){clearTimeout(this.pr),this.pr=void 0}mr(){var e={};return X(this.dr,t=>{var i,r=(t?t.batchKey:null)||t.url;$(e[r])&&(e[r]=W({},t,{data:[]})),null==(i=e[r].data)||i.push(t.data)}),this.dr=[],e}}var nr=["retriesPerformedSoFar"];class ns{constructor(e){this.br=!1,this.wr=3e3,this.dr=[],this._instance=e,this.dr=[],this.yr=!0,!$(r)&&"onLine"in r.navigator&&(this.yr=r.navigator.onLine,en(r,"online",()=>{this.yr=!0,this.Yi()}),en(r,"offline",()=>{this.yr=!1}))}get length(){return this.dr.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,i=J(e,nr);M(t)&&t>0&&(i.url=rN(i.url,{retry_count:t})),this._instance.me(W({},i,{callback:e=>{200!==e.statusCode&&(e.statusCode<400||e.statusCode>=500)&&(null!=t?t:0)<10?this.Sr(W({retriesPerformedSoFar:t},i)):null==i.callback||i.callback(e)}}))}Sr(e){var t,i,r,s=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=s+1;var n=(r=(Math.random()-.5)*((i=Math.min(18e5,t=3e3*Math.pow(2,s)))-t/2),Math.ceil(i+r)),o=Date.now()+n;this.dr.push({retryAt:o,requestOptions:e});var a="Enqueued failed request for retry in "+n;navigator.onLine||(a+=" (Browser is offline)"),q.warn(a),this.br||(this.br=!0,this.$r())}$r(){this.kr&&clearTimeout(this.kr),this.kr=setTimeout(()=>{this.yr&&this.dr.length>0&&this.Yi(),this.$r()},this.wr)}Yi(){var e=Date.now(),t=[],i=this.dr.filter(i=>i.retryAt<e||(t.push(i),!1));if(this.dr=t,i.length>0)for(var{requestOptions:r}of i)this.retriableRequest(r)}unload(){for(var{requestOptions:e}of(this.kr&&(clearTimeout(this.kr),this.kr=void 0),this.dr))try{this._instance.me(W({},e,{transport:"sendBeacon"}))}catch(e){q.error(e)}this.dr=[]}}class nn{constructor(e){this.Er=()=>{this.Ir||(this.Ir={});var e,t,i,r,s=this.scrollElement(),n=this.scrollY(),o=s?Math.max(0,s.scrollHeight-s.clientHeight):0,a=n+((null==s?void 0:s.clientHeight)||0),l=(null==s?void 0:s.scrollHeight)||0;this.Ir.lastScrollY=Math.ceil(n),this.Ir.maxScrollY=Math.max(n,null!=(e=this.Ir.maxScrollY)?e:0),this.Ir.maxScrollHeight=Math.max(o,null!=(t=this.Ir.maxScrollHeight)?t:0),this.Ir.lastContentY=a,this.Ir.maxContentY=Math.max(a,null!=(i=this.Ir.maxContentY)?i:0),this.Ir.maxContentHeight=Math.max(l,null!=(r=this.Ir.maxContentHeight)?r:0)},this._instance=e}getContext(){return this.Ir}resetContext(){var e=this.Ir;return setTimeout(this.Er,0),e}startMeasuringScrollPosition(){en(r,"scroll",this.Er,{capture:!0}),en(r,"scrollend",this.Er,{capture:!0}),en(r,"resize",this.Er)}scrollElement(){if(!this._instance.config.scroll_root_selector)return null==r?void 0:r.document.documentElement;for(var e of P(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector]){var t=null==r?void 0:r.document.querySelector(e);if(t)return t}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return r&&(r.scrollY||r.pageYOffset||r.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return r&&(r.scrollX||r.pageXOffset||r.document.documentElement.scrollLeft)||0}}var no=e=>sq(null==e?void 0:e.config.mask_personal_data_properties,null==e?void 0:e.config.custom_personal_data_properties);class na{constructor(e,t,i,r){this.Pr=e=>{var t=this.Rr();if(!t||t.sessionId!==e){var i={sessionId:e,props:this.Tr(this._instance)};this.Mr.register({[eM]:i})}},this._instance=e,this.Cr=t,this.Mr=i,this.Tr=r||no,this.Cr.onSessionId(this.Pr)}Rr(){return this.Mr.props[eM]}getSetOnceProps(){var e,t=null==(e=this.Rr())?void 0:e.props;return t?"r"in t?sH(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return X(ei(this.getSetOnceProps()),(t,i)=>{"$current_url"===i&&(i="url"),e["$session_entry_"+S(i)]=t}),e}}var nl=H("[SessionId]");class nc{constructor(e,t,i){if(this.Or=[],!e.persistence)throw Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.__preview_experimental_cookieless_mode)throw Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.S=e.config,this.Mr=e.persistence,this.oi=void 0,this.kt=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.Fr=t||tk,this.Ar=i||tk;var r,s=this.S.persistence_name||this.S.token,n=this.S.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*i_(n,60,36e3,"session_idle_timeout_seconds",1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Dr(),this.Lr="ph_"+s+"_window_id",this.Nr="ph_"+s+"_primary_window_exists",this.jr()){var o=tj.D(this.Lr),a=tj.D(this.Nr);o&&!a?this.oi=o:tj.N(this.Lr),tj.L(this.Nr,!0)}if(null!=(r=this.S.bootstrap)&&r.sessionID)try{var l=(e=>{var t=e.replace(/-/g,"");if(32!==t.length)throw Error("Not a valid UUID");if("7"!==t[12])throw Error("Not a UUIDv7");return parseInt(t.substring(0,12),16)})(this.S.bootstrap.sessionID);this.zr(this.S.bootstrap.sessionID,(new Date).getTime(),l)}catch(e){nl.error("Invalid sessionID in bootstrap",e)}this.Ur()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return $(this.Or)&&(this.Or=[]),this.Or.push(e),this.kt&&e(this.kt,this.oi),()=>{this.Or=this.Or.filter(t=>t!==e)}}jr(){return"memory"!==this.S.persistence&&!this.Mr.xe&&tj.O()}qr(e){e!==this.oi&&(this.oi=e,this.jr()&&tj.L(this.Lr,e))}Br(){return this.oi?this.oi:this.jr()?tj.D(this.Lr):null}zr(e,t,i){e===this.kt&&t===this._sessionActivityTimestamp&&i===this._sessionStartTimestamp||(this._sessionStartTimestamp=i,this._sessionActivityTimestamp=t,this.kt=e,this.Mr.register({[eE]:[t,e,i]}))}Hr(){if(this.kt&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this.kt,this._sessionStartTimestamp];var e=this.Mr.props[eE];return P(e)&&2===e.length&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.zr(null,null,null)}Ur(){en(r,"beforeunload",()=>{this.jr()&&tj.N(this.Nr)},{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=null),this.S.__preview_experimental_cookieless_mode)throw Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var i=t||(new Date).getTime(),[r,s,n]=this.Hr(),o=this.Br(),a=M(n)&&n>0&&Math.abs(i-n)>864e5,l=!1,c=!s,u=!e&&Math.abs(i-r)>this.sessionTimeoutMs;c||u||a?(s=this.Fr(),o=this.Ar(),nl.info("new session ID generated",{sessionId:s,windowId:o,changeReason:{noSessionId:c,activityTimeout:u,sessionPastMaximumLength:a}}),n=i,l=!0):o||(o=this.Ar(),l=!0);var h=0===r||!e||a?i:r,d=0===n?(new Date).getTime():n;return this.qr(o),this.zr(s,h,d),e||this.Dr(),l&&this.Or.forEach(e=>e(s,o,l?{noSessionId:c,activityTimeout:u,sessionPastMaximumLength:a}:void 0)),{sessionId:s,windowId:o,sessionStartTimestamp:d,changeReason:l?{noSessionId:c,activityTimeout:u,sessionPastMaximumLength:a}:void 0,lastActivityTimestamp:r}}Dr(){clearTimeout(this.Wr),this.Wr=setTimeout(()=>{this.resetSessionId()},1.1*this.sessionTimeoutMs)}}var nu=["$set_once","$set"],nh=H("[SiteApps]");class nd{constructor(e){this._instance=e,this.Gr=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}Jr(e,t){if(t){var i=this.globalsForEvent(t);this.Gr.push(i),this.Gr.length>1e3&&(this.Gr=this.Gr.slice(10))}}get siteAppLoaders(){var e;return null==(e=g._POSTHOG_REMOTE_CONFIG)||null==(e=e[this._instance.config.token])?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance.Ne(this.Jr.bind(this));this.Vr=()=>{e(),this.Gr=[],this.Vr=void 0}}}globalsForEvent(e){if(!e)throw Error("Event payload is required");var t,i,r,s,n,o,a,l={},c=this._instance.get_property("$groups")||[];for(var[u,h]of Object.entries(this._instance.get_property("$stored_group_properties")||{}))l[u]={id:c[u],type:u,properties:h};var{$set_once:d,$set:f}=e;return{event:W({},J(e,nu),{properties:W({},e.properties,f?{$set:W({},null!=(t=null==(i=e.properties)?void 0:i.$set)?t:{},f)}:{},d?{$set_once:W({},null!=(r=null==(s=e.properties)?void 0:s.$set_once)?r:{},d)}:{}),elements_chain:null!=(n=null==(o=e.properties)?void 0:o.$elements_chain)?n:"",distinct_id:null==(a=e.properties)?void 0:a.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:l}}setupSiteApp(e){var t=this.apps[e.id],i=()=>{var i;!t.errored&&this.Gr.length&&(nh.info("Processing "+this.Gr.length+" events for site app with id "+e.id),this.Gr.forEach(e=>null==t.processEvent?void 0:t.processEvent(e)),t.processedBuffer=!0),Object.values(this.apps).every(e=>e.processedBuffer||e.errored)&&(null==(i=this.Vr)||i.call(this))},r=!1,s=s=>{t.errored=!s,t.loaded=!0,nh.info("Site app with id "+e.id+" "+(s?"loaded":"errored")),r&&i()};try{var{processEvent:n}=e.init({posthog:this._instance,callback:e=>{s(e)}});n&&(t.processEvent=n),r=!0}catch(t){nh.error("Error while initializing PostHog app with config id "+e.id,t),s(!1)}if(r&&t.loaded)try{i()}catch(i){nh.error("Error while processing buffered events PostHog app with config id "+e.id,i),t.errored=!0}}Kr(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var i of e)this.setupSiteApp(i)}Yr(e){if(0!==Object.keys(this.apps).length){var t=this.globalsForEvent(e);for(var i of Object.values(this.apps))try{null==i.processEvent||i.processEvent(t)}catch(t){nh.error("Error while processing event "+e.event+" for site app "+i.id,t)}}}onRemoteConfig(e){var t,i,r,s=this;if(null!=(t=this.siteAppLoaders)&&t.length)return this.isEnabled?(this.Kr(),void this._instance.on("eventCaptured",e=>this.Yr(e))):void nh.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if(null==(i=this.Vr)||i.call(this),null!=(r=e.siteApps)&&r.length)if(this.isEnabled){var n=function(e){var t;g["__$$ph_site_app_"+e]=s._instance,null==(t=g.__PosthogExtensions__)||null==t.loadSiteApp||t.loadSiteApp(s._instance,a,t=>{if(t)return nh.error("Error while initializing PostHog app with config id "+e,t)})};for(var{id:o,url:a}of e.siteApps)n(o)}else nh.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var nf=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],np=function(e,t){if(!e)return!1;var i=e.toLowerCase();return nf.concat(t||[]).some(e=>{var t=e.toLowerCase();return -1!==i.indexOf(t)})},ng=function(e,t){if(!e)return!1;var i=e.userAgent;if(i&&np(i,t))return!0;try{var r=null==e?void 0:e.userAgentData;if(null!=r&&r.brands&&r.brands.some(e=>np(null==e?void 0:e.brand,t)))return!0}catch(e){}return!!e.webdriver},nv=function(e){return e.US="us",e.EU="eu",e.CUSTOM="custom",e}({}),n_="i.posthog.com";class nm{constructor(e){this.Xr={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return"https://app.posthog.com"===e?"https://us.i.posthog.com":e}get uiHost(){var e,t=null==(e=this.instance.config.ui_host)?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+n_,".posthog.com")),"https://app.posthog.com"===t?"https://us.posthog.com":t}get region(){return this.Xr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.Xr[this.apiHost]=nv.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.Xr[this.apiHost]=nv.EU:this.Xr[this.apiHost]=nv.CUSTOM),this.Xr[this.apiHost]}endpointFor(e,t){if(void 0===t&&(t=""),t&&(t="/"===t[0]?t:"/"+t),"ui"===e)return this.uiHost+t;if(this.region===nv.CUSTOM)return this.apiHost+t;var i=n_+t;switch(e){case"assets":return"https://"+this.region+"-assets."+i;case"api":return"https://"+this.region+"."+i}}}var ny={icontains:(e,t)=>!!r&&t.href.toLowerCase().indexOf(e.toLowerCase())>-1,not_icontains:(e,t)=>!!r&&-1===t.href.toLowerCase().indexOf(e.toLowerCase()),regex:(e,t)=>!!r&&rq(t.href,e),not_regex:(e,t)=>!!r&&!rq(t.href,e),exact:(e,t)=>t.href===e,is_not:(e,t)=>t.href!==e};class nb{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(e){void 0===e&&(e=!1),t.getWebExperiments(e=>{nb.Qr("retrieved web experiments from the server"),t.Zr=new Map,e.forEach(e=>{if(e.feature_flag_key){t.Zr&&(nb.Qr("setting flag key ",e.feature_flag_key," to web experiment ",e),null==(i=t.Zr)||i.set(e.feature_flag_key,e));var i,r=t._instance.getFeatureFlag(e.feature_flag_key);R(r)&&e.variants[r]&&t.ts(e.name,r,e.variants[r].transforms)}else if(e.variants)for(var s in e.variants){var n=e.variants[s];nb.es(n)&&t.ts(e.name,s,n.transforms)}})},e)},this._instance=e,this._instance.onFeatureFlags(e=>{this.onFeatureFlags(e)})}onFeatureFlags(e){if(this._is_bot())nb.Qr("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(F(this.Zr))return this.Zr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();nb.Qr("applying feature flags",e),e.forEach(e=>{var t;if(this.Zr&&null!=(t=this.Zr)&&t.has(e)){var i,r=this._instance.getFeatureFlag(e),s=null==(i=this.Zr)?void 0:i.get(e);r&&null!=s&&s.variants[r]&&this.ts(s.name,r,s.variants[r].transforms)}})}}previewWebExperiment(){var e=nb.getWindowLocation();if(null!=e&&e.search){var t=tu(null==e?void 0:e.search,"__experiment_id"),i=tu(null==e?void 0:e.search,"__experiment_variant");t&&i&&(nb.Qr("previewing web experiments "+t+" && "+i),this.getWebExperiments(e=>{this.rs(parseInt(t),i,e)},!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,i){if(this._instance.config.disable_web_experiments&&!i)return e([]);var r=this._instance.get_property("$web_experiments");if(r&&!t)return e(r);this._instance.me({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:t=>200===t.statusCode&&t.json?e(t.json.experiments||[]):e([])})}rs(e,t,i){var r=i.filter(t=>t.id===e);r&&r.length>0&&(nb.Qr("Previewing web experiment ["+r[0].name+"] with variant ["+t+"]"),this.ts(r[0].name,t,r[0].variants[t].transforms))}static es(e){return!F(e.conditions)&&nb.ss(e)&&nb.ns(e)}static ss(e){if(F(e.conditions)||F(null==(t=e.conditions)?void 0:t.url))return!0;var t,i,r,s,n=nb.getWindowLocation();return!!n&&(null==(i=e.conditions)||!i.url||ny[null!=(r=null==(s=e.conditions)?void 0:s.urlMatchType)?r:"icontains"](e.conditions.url,n))}static getWindowLocation(){return null==r?void 0:r.location}static ns(e){if(F(e.conditions)||F(null==(i=e.conditions)?void 0:i.utm))return!0;var t=sM();if(t.utm_source){var i,r,s,n,o,a,l,c,u,h=null==(r=e.conditions)||null==(r=r.utm)||!r.utm_campaign||(null==(s=e.conditions)||null==(s=s.utm)?void 0:s.utm_campaign)==t.utm_campaign,d=null==(n=e.conditions)||null==(n=n.utm)||!n.utm_source||(null==(o=e.conditions)||null==(o=o.utm)?void 0:o.utm_source)==t.utm_source,f=null==(a=e.conditions)||null==(a=a.utm)||!a.utm_medium||(null==(l=e.conditions)||null==(l=l.utm)?void 0:l.utm_medium)==t.utm_medium,p=null==(c=e.conditions)||null==(c=c.utm)||!c.utm_term||(null==(u=e.conditions)||null==(u=u.utm)?void 0:u.utm_term)==t.utm_term;return h&&f&&p&&d}return!1}static Qr(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];q.info("[WebExperiments] "+e,i)}ts(e,t,i){this._is_bot()?nb.Qr("Refusing to render web experiment since the viewer is a likely bot"):"control"!==t?i.forEach(i=>{if(i.selector){nb.Qr("applying transform of variant "+t+" for experiment "+e+" ",i);var r,s=null==(r=document)?void 0:r.querySelectorAll(i.selector);null==s||s.forEach(e=>{i.html&&(e.innerHTML=i.html),i.css&&e.setAttribute("style",i.css)})}}):nb.Qr("Control variants leave the page unmodified.")}_is_bot(){return l&&this._instance?ng(l,this._instance.config.custom_blocked_useragents):void 0}}var nw={},nk=()=>{},nS="posthog",nE=!rF&&-1===(null==p?void 0:p.indexOf("MSIE"))&&-1===(null==p?void 0:p.indexOf("Mozilla")),nx=()=>{var e;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:function(e){var t=null==e?void 0:e.hostname;if(!R(t))return!1;var i=t.split(".").slice(-2).join(".");for(var r of er)if(i===r)return!1;return!0}(null==c?void 0:c.location),persistence:"localStorage+cookie",persistence_name:"",loaded:nk,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:"if_capture_pageview",debug:u&&R(null==u?void 0:u.search)&&-1!==u.search.indexOf("__posthog_debug=true")||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==r||null==(e=r.location)?void 0:e.protocol),ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:e=>{var t="Bad HTTP status: "+e.statusCode+" "+e.text;q.error(t)},get_device_id:e=>e,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:3e3},_onCapture:nk}},nT=e=>{var t={};$(e.process_person)||(t.person_profiles=e.process_person),$(e.xhr_headers)||(t.request_headers=e.xhr_headers),$(e.cookie_name)||(t.persistence_name=e.cookie_name),$(e.disable_cookie)||(t.disable_persistence=e.disable_cookie),$(e.store_google)||(t.save_campaign_params=e.store_google),$(e.verbose)||(t.debug=e.verbose);var i=Y({},t,e);return P(e.property_blacklist)&&($(e.property_denylist)?i.property_denylist=e.property_blacklist:P(e.property_denylist)?i.property_denylist=[...e.property_blacklist,...e.property_denylist]:q.error("Invalid value for property_denylist config: "+e.property_denylist)),i};class nO{constructor(){this.__forceAllowLocalhost=!1}get os(){return this.__forceAllowLocalhost}set os(e){q.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class nP{get decideEndpointWasHit(){var e,t;return null!=(e=null==(t=this.featureFlags)?void 0:t.hasLoadedFlags)&&e}constructor(){this.webPerformance=new nO,this.ls=!1,this.version=v.LIB_VERSION,this.us=new s5,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=nx(),this.SentryIntegration=rw,this.sentryIntegration=e=>(function(e,t){var i=rb(e,t);return{name:ry,processEvent:e=>i(e)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.hs=!1,this.ds=null,this.vs=null,this.cs=null,this.featureFlags=new s0(this),this.toolbar=new rT(this),this.scrollManager=new nn(this),this.pageViewManager=new rj(this),this.surveys=new s4(this),this.experiments=new nb(this),this.exceptions=new rJ(this),this.rateLimiter=new s9(this),this.requestRouter=new nm(this),this.consent=new tF(this),this.people={set:(e,t,i)=>{var r=R(e)?{[e]:t}:e;this.setPersonProperties(r),null==i||i({})},set_once:(e,t,i)=>{var r=R(e)?{[e]:t}:e;this.setPersonProperties(void 0,r),null==i||i({})}},this.on("eventCaptured",e=>q.info('send "'+(null==e?void 0:e.event)+'"',e))}init(e,t,i){if(i&&i!==nS){var r,s=null!=(r=nw[i])?r:new nP;return s._init(e,t,i),nw[i]=s,nw[nS][i]=s,s}return this._init(e,t,i)}_init(e,t,i){if(void 0===t&&(t={}),$(e)||j(e))return q.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return q.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this.fs=[],t.person_profiles&&(this.vs=t.person_profiles),this.set_config(Y({},nx(),nT(t),{name:i,token:e})),this.config.on_xhr_error&&q.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:y.GZipJS,this.persistence=new s2(this.config),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new s2(W({},this.config,{persistence:"sessionStorage"}));var s=W({},this.persistence.props),n=W({},this.sessionPersistence.props);if(this.ps=new ni(e=>this.gs(e),this.config.request_queue_config),this._s=new ns(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new nc(this),this.sessionPropsManager=new na(this,this.sessionManager,this.persistence)),new rP(this).startIfEnabledOrStop(),this.siteApps=new nd(this),null==(o=this.siteApps)||o.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new r_(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new tg(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new rR(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new rC(this),this.exceptionObserver=new tq(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new tU(this,tB),this.deadClicksAutocapture.startIfEnabled(),this.historyAutocapture=new ii(this),this.historyAutocapture.startIfEnabled(),v.DEBUG=v.DEBUG||this.config.debug,v.DEBUG&&q.info("Starting in debug mode",{this:this,config:t,thisC:W({},this.config),p:s,s:n}),this.bs(),void 0!==(null==(a=t.bootstrap)?void 0:a.distinctID)){var o,a,l,c,u=this.config.get_device_id(tk()),h=null!=(l=t.bootstrap)&&l.isIdentifiedID?u:t.bootstrap.distinctID;this.persistence.set_property(eF,null!=(c=t.bootstrap)&&c.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:h})}if(this.ws()){var d,f,p=Object.keys((null==(d=t.bootstrap)?void 0:d.featureFlags)||{}).filter(e=>{var i;return!(null==(i=t.bootstrap)||null==(i=i.featureFlags)||!i[e])}).reduce((e,i)=>{var r;return e[i]=(null==(r=t.bootstrap)||null==(r=r.featureFlags)?void 0:r[i])||!1,e},{}),g=Object.keys((null==(f=t.bootstrap)?void 0:f.featureFlagPayloads)||{}).filter(e=>p[e]).reduce((e,i)=>{var r,s;return null!=(r=t.bootstrap)&&null!=(r=r.featureFlagPayloads)&&r[i]&&(e[i]=null==(s=t.bootstrap)||null==(s=s.featureFlagPayloads)?void 0:s[i]),e},{});this.featureFlags.receivedFeatureFlags({featureFlags:p,featureFlagPayloads:g})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:ez,$device_id:null},"");else if(!this.get_distinct_id()){var _=this.config.get_device_id(tk());this.register_once({distinct_id:_,$device_id:_},""),this.persistence.set_property(eF,"anonymous")}return en(r,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?function(e,t){var i=e.config.segment;if(!i)return t();!function(e,t){var i=e.config.segment;if(!i)return t();var r=i=>{var r=()=>i.anonymousId()||tk();e.config.get_device_id=r,i.id()&&(e.register({distinct_id:i.id(),$device_id:r()}),e.persistence.set_property(eF,"identified")),t()},s=i.user();"then"in s&&I(s.then)?s.then(e=>r(e)):r(s)}(e,()=>{var r;i.register((Promise&&Promise.resolve||rm.warn("This browser does not have Promise support, and can not use the segment integration"),r=(t,i)=>{if(!i)return t;t.event.userId||t.event.anonymousId===e.get_distinct_id()||(rm.info("No userId set, resetting PostHog"),e.reset()),t.event.userId&&t.event.userId!==e.get_distinct_id()&&(rm.info("UserId set, identifying with PostHog"),e.identify(t.event.userId));var r=e.calculateEventProperties(i,t.event.properties);return t.event.properties=Object.assign({},r,t.event.properties),t},{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:e=>r(e,e.event.event),page:e=>r(e,"$pageview"),identify:e=>r(e,"$identify"),screen:e=>r(e,"$screen")})).then(()=>{t()})})}(this,()=>this.ys()):this.ys(),I(this.config._onCapture)&&this.config._onCapture!==nk&&(q.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",e=>this.config._onCapture(e.event,e))),this}be(e){var t,i,r,s,n,o,a,l;if(!c||!c.body)return q.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this.be(e)},500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=w(e.supportedCompression,y.GZipJS)?y.GZipJS:w(e.supportedCompression,y.Base64)?y.Base64:void 0),null!=(t=e.analytics)&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.vs?this.vs:"identified_only"}),null==(i=this.siteApps)||i.onRemoteConfig(e),null==(r=this.sessionRecording)||r.onRemoteConfig(e),null==(s=this.autocapture)||s.onRemoteConfig(e),null==(n=this.heatmaps)||n.onRemoteConfig(e),this.surveys.onRemoteConfig(e),null==(o=this.webVitalsAutocapture)||o.onRemoteConfig(e),null==(a=this.exceptionObserver)||a.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),null==(l=this.deadClicksAutocapture)||l.onRemoteConfig(e)}ys(){try{this.config.loaded(this)}catch(e){q.critical("`loaded` function failed",e)}this.Ss(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this.$s()},1),new nt(this).load(),this.featureFlags.decide()}Ss(){var e;this.has_opted_out_capturing()||this.config.request_batching&&(null==(e=this.ps)||e.enable())}_dom_loaded(){this.has_opted_out_capturing()||V(this.__request_queue,e=>this.gs(e)),this.__request_queue=[],this.Ss()}_handle_unload(){var e,t;this.config.request_batching?(this.ks()&&this.capture("$pageleave"),null==(e=this.ps)||e.unload(),null==(t=this._s)||t.unload()):this.ks()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}me(e){this.__loaded&&(nE?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=rN(e.url,{ip:+!!this.config.ip}),e.headers=W({},this.config.request_headers),e.compression="best-available"===e.compression?this.compression:e.compression,e.fetchOptions=e.fetchOptions||this.config.fetch_options,(e=>{var t,i,r,s=W({},e);s.timeout=s.timeout||6e4,s.url=rN(s.url,{_:(new Date).getTime().toString(),ver:v.LIB_VERSION,compression:s.compression});var n=null!=(t=s.transport)?t:"fetch",o=null!=(i=null==(r=es(rD,e=>e.transport===n))?void 0:r.method)?i:rD[0].method;if(!o)throw Error("No available transport method");o(s)})(W({},e,{callback:t=>{var i,r;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&(null==(i=(r=this.config).on_request_error)||i.call(r,t)),null==e.callback||e.callback(t)}}))))}gs(e){this._s?this._s.retriableRequest(e):this.me(e)}_execute_array(e){var t,i=[],r=[],s=[];V(e,e=>{e&&(P(t=e[0])?s.push(e):I(e)?e.call(this):P(e)&&"alias"===t?i.push(e):P(e)&&-1!==t.indexOf("capture")&&I(this[t])?s.push(e):r.push(e))});var n=function(e,t){V(e,function(e){if(P(e[0])){var i=t;X(e,function(e){i=i[e[0]].apply(i,e.slice(1))})}else this[e[0]].apply(this,e.slice(1))},t)};n(i,this),n(r,this),n(s,this)}ws(){var e,t;return(null==(e=this.config.bootstrap)?void 0:e.featureFlags)&&Object.keys(null==(t=this.config.bootstrap)?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,i){var r;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.ps){if(!this.consent.isOptedOut())if(!$(e)&&R(e)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var s=null!=i&&i.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==s||!s.isRateLimited){null!=t&&t.$current_url&&!R(null==t?void 0:t.$current_url)&&(q.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),null==t||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var n,o,a,l,c=new Date,u=(null==i?void 0:i.timestamp)||c,h=tk(),d={uuid:h,event:e,properties:this.calculateEventProperties(e,t||{},u,h)};s&&(d.properties.$lib_rate_limit_remaining_tokens=s.remainingTokens),(null==i?void 0:i.$set)&&(d.$set=null==i?void 0:i.$set);var f=this.xs(null==i?void 0:i.$set_once);f&&(d.$set_once=f),(n=d,o=null!=i&&i._noTruncate?null:this.config.properties_string_max_length,a=e=>R(e)&&!L(o)?e.slice(0,o):e,l=new Set,d=function e(t,i){var r;return t!==Object(t)?a?a(t,i):t:l.has(t)?void 0:(l.add(t),P(t)?(r=[],V(t,t=>{r.push(e(t))})):(r={},X(t,(t,i)=>{l.has(t)||(r[i]=e(t,i))})),r)}(n)).timestamp=u,$(null==i?void 0:i.timestamp)||(d.properties.$event_time_override_provided=!0,d.properties.$event_time_override_system_time=c);var p=W({},d.properties.$set,d.$set);if(A(p)||this.setPersonPropertiesForFlags(p),!F(this.config.before_send)){var g=this.Es(d);if(!g)return;d=g}this.us.emit("eventCaptured",d);var v={method:"POST",url:null!=(r=null==i?void 0:i._url)?r:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:d,compression:"best-available",batchKey:null==i?void 0:i._batchKey};return!this.config.request_batching||i&&(null==i||!i._batchKey)||null!=i&&i.send_instantly?this.gs(v):this.ps.enqueue(v),d}q.critical("This capture call is ignored due to client rate limiting.")}}else q.error("No event name provided to posthog.capture")}else q.uninitializedWarning("posthog.capture")}Ne(e){return this.on("eventCaptured",t=>e(t.event,t))}calculateEventProperties(e,t,i,s,n){if(i=i||new Date,!this.persistence||!this.sessionPersistence)return t;var o,a=n?void 0:this.persistence.remove_event_timer(e),l=W({},t);if(l.token=this.config.token,this.config.__preview_experimental_cookieless_mode&&(l.$cookieless_mode=!0),"$snapshot"===e){var h=W({},this.persistence.properties(),this.sessionPersistence.properties());return l.distinct_id=h.distinct_id,(!R(l.distinct_id)&&!M(l.distinct_id)||j(l.distinct_id))&&q.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),l}var d,f=function(e,t){if(!p)return{};var i,s,n=e?Z([],sj,t||[]):[],[o,a]=function(e){for(var t=0;t<sA.length;t++){var[i,r]=sA[t],s=i.exec(e),n=s&&(I(r)?r(s,e):r);if(n)return n}return["",""]}(p);return Y(ei({$os:o,$os_version:a,$browser:sP(p,navigator.vendor),$device:s$(p),$device_type:(s=s$(p))===rZ||s===rY||"Kobo"===s||"Kindle Fire"===s||s===sm?rX:s===sa||s===sc||s===sl||s===sg?"Console":s===r0?"Wearable":s?rK:"Desktop",$timezone:sz(),$timezone_offset:function(){try{return(new Date).getTimezoneOffset()}catch(e){return}}()}),{$current_url:th(null==u?void 0:u.href,n,sF),$host:null==u?void 0:u.host,$pathname:null==u?void 0:u.pathname,$raw_user_agent:p.length>1e3?p.substring(0,997)+"...":p,$browser_version:sC(p,navigator.vendor),$browser_language:sU(),$browser_language_prefix:"string"==typeof(i=sU())?i.split("-")[0]:void 0,$screen_height:null==r?void 0:r.screen.height,$screen_width:null==r?void 0:r.screen.width,$viewport_height:null==r?void 0:r.innerHeight,$viewport_width:null==r?void 0:r.innerWidth,$lib:"web",$lib_version:v.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:g,windowId:_}=this.sessionManager.checkAndGetSessionAndWindowId(n,i.getTime());l.$session_id=g,l.$window_id=_}this.sessionPropsManager&&Y(l,this.sessionPropsManager.getSessionProps());try{this.sessionRecording&&Y(l,this.sessionRecording.sdkDebugProperties),l.$sdk_debug_retry_queue_size=null==(o=this._s)?void 0:o.length}catch(e){l.$sdk_debug_error_capturing_properties=String(e)}if(this.requestRouter.region===nv.CUSTOM&&(l.$lib_custom_api_host=this.config.api_host),d="$pageview"!==e||n?"$pageleave"!==e||n?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(i):this.pageViewManager.doPageView(i,s),l=Y(l,d),"$pageview"===e&&c&&(l.title=c.title),!$(a)){var m=i.getTime()-a;l.$duration=parseFloat((m/1e3).toFixed(3))}p&&this.config.opt_out_useragent_filter&&(l.$browser_type=this._is_bot()?"bot":"browser"),(l=Y({},f,this.persistence.properties(),this.sessionPersistence.properties(),l)).$is_identified=this._isIdentified(),P(this.config.property_denylist)?X(this.config.property_denylist,function(e){delete l[e]}):q.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var y=this.config.sanitize_properties;y&&(q.error("sanitize_properties is deprecated. Use before_send instead"),l=y(l,e));var b=this.Is();return l.$process_person_profile=b,b&&!n&&this.Ps("_calculate_event_properties"),l}xs(e){if(!this.persistence||!this.Is()||this.ls)return e;var t,i=Y({},this.persistence.get_initial_props(),(null==(t=this.sessionPropsManager)?void 0:t.getSetOnceProps())||{},e||{}),r=this.config.sanitize_properties;return r&&(q.error("sanitize_properties is deprecated. Use before_send instead"),i=r(i,"$set_once")),this.ls=!0,A(i)?void 0:i}register(e,t){var i;null==(i=this.persistence)||i.register(e,t)}register_once(e,t,i){var r;null==(r=this.persistence)||r.register_once(e,t,i)}register_for_session(e){var t;null==(t=this.sessionPersistence)||t.register(e)}unregister(e){var t;null==(t=this.persistence)||t.unregister(e)}unregister_for_session(e){var t;null==(t=this.sessionPersistence)||t.unregister(e)}Rs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch(e){return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t)}getEarlyAccessFeatures(e,t,i){return void 0===t&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,i)}on(e,t){return this.us.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,i;return null!=(t=null==(i=this.sessionManager)?void 0:i.onSessionId(e))?t:()=>{}}getSurveys(e,t){void 0===t&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){void 0===t&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return void 0===t&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,i){if(!this.__loaded||!this.persistence)return q.uninitializedWarning("posthog.identify");if(M(e)&&(e=e.toString(),q.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e){if(["distinct_id","distinctid"].includes(e.toLowerCase()))q.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(this.Ps("posthog.identify")){var r=this.get_distinct_id();this.register({$user_id:e}),this.get_property("$device_id")||this.register_once({$had_persisted_distinct_id:!0,$device_id:r},""),e!==r&&e!==this.get_property(ea)&&(this.unregister(ea),this.register({distinct_id:e}));var s="anonymous"===(this.persistence.get_property(eF)||"anonymous");e!==r&&s?(this.persistence.set_property(eF,"identified"),this.setPersonPropertiesForFlags(W({},i||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:r},{$set:t||{},$set_once:i||{}}),this.cs=rH(e,t,i),this.featureFlags.setAnonymousDistinctId(r)):(t||i)&&this.setPersonProperties(t,i),e!==r&&(this.reloadFeatureFlags(),this.unregister(eL))}}else q.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.Ps("posthog.setPersonProperties")){var i=rH(this.get_distinct_id(),e,t);this.cs!==i?(this.setPersonPropertiesForFlags(W({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.cs=i):q.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,i){if(e&&t){if(this.Ps("posthog.group")){var r=this.getGroups();r[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:W({},r,{[e]:t})}),i&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:i}),this.setGroupPropertiesForFlags({[e]:i})),r[e]===t||i||this.reloadFeatureFlags()}}else q.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){void 0===t&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){void 0===t&&(t=!0),this.Ps("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){if(q.info("reset"),!this.__loaded)return q.uninitializedWarning("posthog.reset");var t,i,r,s,n=this.get_property("$device_id");if(this.consent.reset(),null==(t=this.persistence)||t.clear(),null==(i=this.sessionPersistence)||i.clear(),this.surveys.reset(),null==(r=this.persistence)||r.set_property(eF,"anonymous"),null==(s=this.sessionManager)||s.resetSessionId(),this.cs=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:ez,$device_id:null},"");else{var o=this.config.get_device_id(tk());this.register_once({distinct_id:o,$device_id:e?o:n},"")}this.register({$last_posthog_reset:(new Date).toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return null!=(e=null==(t=this.sessionManager)?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:i}=this.sessionManager.checkAndGetSessionAndWindowId(!0),r=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(null!=e&&e.withTimestamp&&i){var s,n=null!=(s=e.timestampLookBack)?s:10;if(!i)return r;r+="?t="+Math.max(Math.floor(((new Date).getTime()-i)/1e3)-n,0)}return r}alias(e,t){return e===this.get_property(eo)?(q.critical("Attempting to create alias for existing People user - aborting."),-2):this.Ps("posthog.alias")?($(t)&&(t=this.get_distinct_id()),e!==t?(this.Rs(ea,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(q.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t,i,r,s,n=W({},this.config);C(e)&&(Y(this.config,nT(e)),null==(t=this.persistence)||t.update_config(this.config,n),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new s2(W({},this.config,{persistence:"sessionStorage"})),tP.O()&&"true"===tP.A("ph_debug")&&(this.config.debug=!0),this.config.debug&&(v.DEBUG=!0,q.info("set_config",JSON.stringify({config:e,oldConfig:n,newConfig:W({},this.config)},null,2))),null==(i=this.sessionRecording)||i.startIfEnabledOrStop(),null==(r=this.autocapture)||r.startIfEnabled(),null==(s=this.heatmaps)||s.startIfEnabled(),this.surveys.loadIfEnabled(),this.bs())}startSessionRecording(e){var t,i,r,s,n,o=!0===e,a={sampling:o||!(null==e||!e.sampling),linked_flag:o||!(null==e||!e.linked_flag),url_trigger:o||!(null==e||!e.url_trigger),event_trigger:o||!(null==e||!e.event_trigger)};Object.values(a).some(Boolean)&&(null==(t=this.sessionManager)||t.checkAndGetSessionAndWindowId(),a.sampling&&(null==(i=this.sessionRecording)||i.overrideSampling()),a.linked_flag&&(null==(r=this.sessionRecording)||r.overrideLinkedFlag()),a.url_trigger&&(null==(s=this.sessionRecording)||s.overrideTrigger("url")),a.event_trigger&&(null==(n=this.sessionRecording)||n.overrideTrigger("event"))),this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!(null==(e=this.sessionRecording)||!e.started)}captureException(e,t){var i=Error("PostHog syntheticException");this.exceptions.sendExceptionEvent(W({},function(e,t){var{error:i,event:r}=e,s={$exception_list:[]},n=i||r;if(tJ(n)||tW(n,"DOMException")){if("stack"in n)s=t9(n,t);else{var o=n.name||(tJ(n)?"DOMError":"DOMException"),a=n.message?o+": "+n.message:o;s=ie(a,W({},t,{overrideExceptionType:tJ(n)?"DOMError":"DOMException",defaultExceptionMessage:a}))}return"code"in n&&(s.$exception_DOMException_code=""+n.code),s}if(tW(n,"ErrorEvent")&&n.error)return t9(n.error,t);if(tG(n))return t9(n,t);if(tW(n,"Object")||tH(n))return function(e,t){var i,r,s,n=null==(r=null==t?void 0:t.handled)||r,o=null==(s=null==t?void 0:t.synthetic)||s,a={type:null!=t&&t.overrideExceptionType?t.overrideExceptionType:tH(e)?e.constructor.name:"Error",value:"Non-Error 'exception' captured with keys: "+function(e,t){void 0===t&&(t=40);var i=Object.keys(e);if(i.sort(),!i.length)return"[object has no keys]";for(var r=i.length;r>0;r--){var s=i.slice(0,r).join(", ");if(!(s.length>t))return r===i.length||s.length<=t?s:s.slice(0,t)+"..."}return""}(e),mechanism:{handled:n,synthetic:o}};if(null!=t&&t.syntheticException){var l=t4(null==t?void 0:t.syntheticException,1);l.length&&(a.stacktrace={frames:l,type:"raw"})}return{$exception_list:[a],$exception_level:R(i=e.level)&&!j(i)&&b.indexOf(i)>=0?e.level:"error"}}(n,t);if($(i)&&R(r)){var l="Error",c=r,u=r.match(t8);return u&&(l=u[1],c=u[2]),ie(c,W({},t,{overrideExceptionType:l,defaultExceptionMessage:c}))}return ie(n,t)}(e instanceof Error?{error:e,event:e.message}:{event:e},{syntheticException:i}),t))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return null==(t=this.persistence)?void 0:t.props[e]}getSessionProperty(e){var t;return null==(t=this.sessionPersistence)?void 0:t.props[e]}toString(){var e,t=null!=(e=this.config.name)?e:nS;return t!==nS&&(t=nS+"."+t),t}_isIdentified(){var e,t;return"identified"===(null==(e=this.persistence)?void 0:e.get_property(eF))||"identified"===(null==(t=this.sessionPersistence)?void 0:t.get_property(eF))}Is(){var e,t;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&A(this.getGroups())&&(null==(e=this.persistence)||null==(e=e.props)||!e[ea])&&(null==(t=this.persistence)||null==(t=t.props)||!t[eq]))}ks(){return!0===this.config.capture_pageleave||"if_capture_pageview"===this.config.capture_pageleave&&(!0===this.config.capture_pageview||"history_change"===this.config.capture_pageview)}createPersonProfile(){this.Is()||this.Ps("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Ps(e){return"never"===this.config.person_profiles?(q.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.Rs(eq,!0),!0)}bs(){var e,t,i,r,s=this.consent.isOptedOut(),n=this.config.opt_out_persistence_by_default,o=this.config.disable_persistence||s&&!!n;(null==(e=this.persistence)?void 0:e.xe)!==o&&(null==(i=this.persistence)||i.set_disabled(o)),(null==(t=this.sessionPersistence)?void 0:t.xe)!==o&&(null==(r=this.sessionPersistence)||r.set_disabled(o))}opt_in_capturing(e){var t;this.consent.optInOut(!0),this.bs(),($(null==e?void 0:e.captureEventName)||null!=e&&e.captureEventName)&&this.capture(null!=(t=null==e?void 0:e.captureEventName)?t:"$opt_in",null==e?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.$s()}opt_out_capturing(){this.consent.optInOut(!1),this.bs()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this.bs()}_is_bot(){return l?ng(l,this.config.custom_blocked_useragents):void 0}$s(){c&&("visible"===c.visibilityState?this.hs||(this.hs=!0,this.capture("$pageview",{title:c.title},{send_instantly:!0}),this.ds&&(c.removeEventListener("visibilitychange",this.ds),this.ds=null)):this.ds||(this.ds=this.$s.bind(this),en(c,"visibilitychange",this.ds)))}debug(e){!1===e?(null==r||r.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(null==r||r.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}Es(e){if(F(this.config.before_send))return e;var t=P(this.config.before_send)?this.config.before_send:[this.config.before_send],i=e;for(var r of t){if(F(i=r(i))){var s="Event '"+e.event+"' was rejected in beforeSend function";return U(e.event)?q.warn(s+". This can cause unexpected behavior."):q.info(s),null}i.properties&&!A(i.properties)||q.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return i}getPageViewId(){var e;return null==(e=this.pageViewManager.ne)?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,i){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(i)})}}!function(e,t){for(var i=0;i<t.length;i++)e.prototype[t[i]]=et(e.prototype[t[i]])}(nP,["identify"]),function(e){e.Button="button",e.Tab="tab",e.Selector="selector"}({}),function(e){e.TopLeft="top_left",e.TopRight="top_right",e.TopCenter="top_center",e.MiddleLeft="middle_left",e.MiddleRight="middle_right",e.MiddleCenter="middle_center",e.Left="left",e.Center="center",e.Right="right",e.NextToTrigger="next_to_trigger"}({}),function(e){e.Popover="popover",e.API="api",e.Widget="widget"}({}),function(e){e.Open="open",e.MultipleChoice="multiple_choice",e.SingleChoice="single_choice",e.Rating="rating",e.Link="link"}({}),function(e){e.NextQuestion="next_question",e.End="end",e.ResponseBased="response_based",e.SpecificQuestion="specific_question"}({}),function(e){e.Once="once",e.Recurring="recurring",e.Always="always"}({});var nI,nC=(nI=nw[nS]=new nP,function(){function e(){e.done||(e.done=!0,nE=!1,X(nw,function(e){e._dom_loaded()}))}null!=c&&c.addEventListener?"complete"===c.readyState?e():en(c,"DOMContentLoaded",e,{capture:!1}):r&&q.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),nI)},21816:(e,t,i)=>{"use strict";i.d(t,{y:()=>_});var r=i(33736),s=i(17590),n=i(91844),o=(0,n.createContext)({client:s.Ay});function a(e){var t=e.children,i=e.client,r=e.apiKey,a=e.options,l=(0,n.useRef)(null),c=(0,n.useMemo)(function(){return i?(r&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),a&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),i):(r||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),s.Ay)},[i,r,JSON.stringify(a)]);return(0,n.useEffect)(function(){if(!i){var e=l.current;e?(r!==e.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),a&&!function e(t,i,r){if(void 0===r&&(r=new WeakMap),t===i)return!0;if("object"!=typeof t||null===t||"object"!=typeof i||null===i)return!1;if(r.has(t)&&r.get(t)===i)return!0;r.set(t,i);var s=Object.keys(t),n=Object.keys(i);if(s.length!==n.length)return!1;for(var o=0;o<s.length;o++){var a=s[o];if(!n.includes(a)||!e(t[a],i[a],r))return!1}return!0}(a,e.options)&&s.Ay.set_config(a)):(s.Ay.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),s.Ay.init(r,a)),l.current={apiKey:r,options:null!=a?a:{}}}},[i,r,JSON.stringify(a)]),n.createElement(o.Provider,{value:{client:c}},t)}var l=function(){return useContext(o).client},c=function(e,t){return(c=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},u=function(){return(u=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function h(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)0>t.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i}var d=function(e){return"function"==typeof e};function f(e){var t=e.flag,i=e.children,r=e.onIntersect,s=e.onClick,n=e.trackView,o=e.options,a=h(e,["flag","children","onIntersect","onClick","trackView","options"]),c=useRef(null);return useEffect(function(){if(null!==c.current&&n){var e=new IntersectionObserver(function(e){return r(e[0])},u({threshold:.1},o));return e.observe(c.current),function(){return e.disconnect()}}},[t,o,l(),c,n,r]),React.createElement("div",u({ref:c},a,{onClick:s}),i)}var p={componentStack:null,error:null},g={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};!function(e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=i}function i(t){var i=e.call(this,t)||this;return i.state=p,i}c(i,e),i.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t),i.prototype.componentDidCatch=function(e,t){var i,r=t.componentStack,s=this.props.additionalProperties;this.setState({error:e,componentStack:r}),d(s)?i=s(e):"object"==typeof s&&(i=s),this.context.client.captureException(e,i)},i.prototype.render=function(){var e=this.props,t=e.children,i=e.fallback,r=this.state;if(null==r.componentStack)return d(t)?t():t;var s=d(i)?n.createElement(i,{error:r.error,componentStack:r.componentStack}):i;return n.isValidElement(s)?s:(console.warn(g.INVALID_FALLBACK),n.createElement(n.Fragment,null))},i.contextType=o}(n.Component);var v=i(57643);v.env.NEXT_PUBLIC_POSTHOG_KEY&&(s.Ay.init(v.env.NEXT_PUBLIC_POSTHOG_KEY,{api_host:v.env.NEXT_PUBLIC_POSTHOG_HOST,person_profiles:"always"}),"true"===localStorage.getItem("readest-telemetry-opt-out")&&s.Ay.opt_out_capturing());let _=e=>{let{children:t}=e;return(0,r.jsx)(a,{client:s.Ay,children:t})}},22515:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(73589));class n{constructor(e,{headers:t={},schema:i,fetch:r}){this.url=e,this.headers=t,this.schema=i,this.fetch=r}select(e,{head:t=!1,count:i}={}){let r=!1,n=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!r?"":('"'===e&&(r=!r),e)).join("");return this.url.searchParams.set("select",n),i&&(this.headers.Prefer=`count=${i}`),new s.default({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:i=!0}={}){let r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),i||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:i=!1,count:r,defaultToNull:n=!0}={}){let o=[`resolution=${i?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),n||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new s.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new s.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}t.default=n},25467:(e,t)=>{"use strict";function i(e){let{ampFirst:t=!1,hybrid:i=!1,hasQuery:r=!1}=void 0===e?{}:e;return t||i&&r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return i}})},27876:(e,t,i)=>{"use strict";i.d(t,{A:()=>c,O:()=>l});var r=i(33736),s=i(91844),n=i(73548),o=i(17590);let a=(0,s.createContext)(void 0),l=e=>{let{children:t}=e,[i,l]=(0,s.useState)(()=>localStorage.getItem("token")),[c,u]=(0,s.useState)(()=>{{let e=localStorage.getItem("user");return e?JSON.parse(e):null}});(0,s.useEffect)(()=>{let e=e=>{if(e){console.log("Syncing session");let{access_token:t,refresh_token:i,user:r}=e;localStorage.setItem("token",t),localStorage.setItem("refresh_token",i),localStorage.setItem("user",JSON.stringify(r)),o.Ay.identify(r.id),l(t),u(r)}else console.log("Clearing session"),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),l(null),u(null)},t=async()=>{try{await n.ND.auth.refreshSession()}catch(t){e(null)}},{data:i}=n.ND.auth.onAuthStateChange((t,i)=>{e(i)});return t(),()=>{null==i||i.subscription.unsubscribe()}},[]);let h=async()=>{console.log("Logging out");try{await n.ND.auth.refreshSession()}catch(e){}finally{await n.ND.auth.signOut(),localStorage.removeItem("token"),localStorage.removeItem("user"),l(null),u(null)}};return(0,r.jsx)(a.Provider,{value:{token:i,user:c,login:(e,t)=>{console.log("Logging in"),l(e),u(t),localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t))},logout:h},children:t})},c=()=>{let e=(0,s.useContext)(a);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},28712:(e,t,i)=>{"use strict";var r=i(67525).Y,s="undefined"!=typeof window?window.matchMedia:null;function n(e,t,i){var n,o=this;function a(e){o.matches=e.matches,o.media=e.media}s&&!i&&(n=s.call(window,e)),n?(this.matches=n.matches,this.media=n.media,n.addListener(a)):(this.matches=r(e,t),this.media=e),this.addListener=function(e){n&&n.addListener(e)},this.removeListener=function(e){n&&n.removeListener(e)},this.dispose=function(){n&&n.removeListener(a)}}e.exports=function(e,t,i){return new n(e,t,i)}},29027:(e,t,i)=>{"use strict";var r=i(34544);function s(){}function n(){}n.resetWarningCache=s,e.exports=function(){function e(e,t,i,s,n,o){if(o!==r){var a=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:n,resetWarningCache:s};return i.PropTypes=i,i}},29803:(e,t,i)=>{"use strict";i.d(t,{Gg:()=>v,Gz:()=>g,JK:()=>l,NF:()=>s,Ox:()=>f,Xw:()=>a,YK:()=>d,aY:()=>o,em:()=>p,gl:()=>c,ii:()=>h,mj:()=>u,oq:()=>n});var r=i(97384);let s=()=>Math.random().toString(36).substring(2,9),n=()=>(0,r.md5)(Math.random().toString()),o=e=>(0,r.md5)(JSON.stringify(e)),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_",i=e.replace(/[<>:"\/\\|?*\x00-\x1F]/g,t);/^(con|prn|aux|nul|com[1-9]|lpt[1-9])$/i.test(i)&&(i="".concat(i).concat(t));let r=new TextEncoder,s=r.encode(i);for(;s.length>250;)i=i.slice(0,-1),s=r.encode(i);return i.trim()},l=()=>{var e,t;return(null==(e=localStorage)?void 0:e.getItem("i18nextLng"))||(null==(t=navigator)?void 0:t.language)||""},c=()=>l().split("-")[0]||"en",u=()=>{let e=l();return e.startsWith("zh")?"zh-Hant"===e||"zh-HK"===e||"zh-TW"===e?"zh-Hant":"zh-Hans":e.split("-")[0]||"en"},h=()=>{var e;let t=navigator.language||"",i=(null==(e=localStorage)?void 0:e.getItem("i18nextLng"))||"",r=["zh","ja","ko"].some(e=>i.startsWith(e));return["zh","ja","ko"].some(e=>t.startsWith(e))||r},d=e=>{let t=(navigator.languages&&navigator.languages.length>0?navigator.languages:[navigator.language]).filter(t=>t.startsWith(e));return t.length>0?t[0]:void 0},f=()=>{let e=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(e)?"ios":e.includes("android")?"android":e.includes("macintosh")||e.includes("mac os x")?"macos":e.includes("windows nt")?"windows":e.includes("linux")?"linux":"unknown"},p=e=>e.startsWith("content://"),g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["http","https"];try{let{protocol:i}=new URL(e);return t.some(e=>"".concat(e,":")===i)}catch(e){return!1}},v=e=>e},34544:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},34634:(e,t,i)=>{"use strict";i.d(t,{k5:()=>u,Vx:()=>n});var r=i(91844),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=r.createContext&&r.createContext(s),o=["attr","size","title"];function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach(function(t){var r,s,n;r=e,s=t,n=i[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in r?Object.defineProperty(r,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[s]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function u(e){return t=>r.createElement(h,a({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,i)=>r.createElement(t.tag,c({key:i},t.attr),e(t.child)))}(e.child))}function h(e){var t=t=>{var i,{attr:s,size:n,title:l}=e,u=function(e,t){if(null==e)return{};var i,r,s=function(e,t){if(null==e)return{};var i={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;i[r]=e[r]}return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)i=n[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}(e,o),h=n||t.size||"1em";return t.className&&(i=t.className),e.className&&(i=(i?i+" ":"")+e.className),r.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,u,{className:i,style:c(c({color:e.color||t.color},t.style),e.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),l&&r.createElement("title",null,l),e.children)};return void 0!==n?r.createElement(n.Consumer,null,e=>t(e)):t(s)}},35492:()=>{},49682:(e,t,i)=>{"use strict";i.d(t,{iD:()=>a,Fk:()=>l,l3:()=>o});class r extends Error{}r.prototype.name="InvalidTokenError";var s=i(73548);i(64371);var n=i(74615);i(57643);let o=e=>((function(e,t){let i;if("string"!=typeof e)throw new r("Invalid token specified: must be a string");t||(t={});let s=+(!0!==t.header),n=e.split(".")[s];if("string"!=typeof n)throw new r(`Invalid token specified: missing part #${s+1}`);try{i=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var i;return i=t,decodeURIComponent(atob(i).replace(/(.)/g,(e,t)=>{let i=t.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}catch(e){return atob(t)}}(n)}catch(e){throw new r(`Invalid token specified: invalid base64 for part #${s+1} (${e.message})`)}try{return JSON.parse(i)}catch(e){throw new r(`Invalid token specified: invalid json for part #${s+1} (${e.message})`)}})(e)||{}).plan||"free",a=async()=>{var e,t,i;if((0,n.hx)())return null!=(t=localStorage.getItem("token"))?t:null;let{data:r}=await s.ND.auth.getSession();return null!=(i=null==r||null==(e=r.session)?void 0:e.access_token)?i:null},l=async()=>{var e,t,i,r,o;if((0,n.hx)())return null!=(r=JSON.parse(null!=(i=localStorage.getItem("user"))?i:"{}").id)?r:null;let{data:a}=await s.ND.auth.getSession();return null!=(o=null==a||null==(t=a.session)||null==(e=t.user)?void 0:e.id)?o:null}},51782:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=i},60688:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Headers:()=>o,Request:()=>a,Response:()=>l,default:()=>n,fetch:()=>s});var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==i.g)return i.g;throw Error("unable to locate global object")}();let s=r.fetch,n=r.fetch.bind(r),o=r.Headers,a=r.Request,l=r.Response},62299:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return i(80070)}])},62807:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(60688)),n=r(i(51782));class o{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=s.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let i=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,i,r;let s=null,o=null,a=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(o="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let r=null==(t=this.headers.Prefer)?void 0:t.match(/count=(exact|planned|estimated)/),n=null==(i=e.headers.get("content-range"))?void 0:i.split("/");r&&n&&n.length>1&&(a=parseInt(n[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(s={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,l=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{let t=await e.text();try{s=JSON.parse(t),Array.isArray(s)&&404===e.status&&(o=[],s=null,l=200,c="OK")}catch(i){404===e.status&&""===t?(l=204,c="No Content"):s={message:t}}if(s&&this.isMaybeSingle&&(null==(r=null==s?void 0:s.details)?void 0:r.includes("0 rows"))&&(s=null,l=200,c="OK"),s&&this.shouldThrowOnError)throw new n.default(s)}return{error:s,data:o,count:a,status:l,statusText:c}});return this.shouldThrowOnError||(i=i.catch(e=>{var t,i,r;return{error:{message:`${null!=(t=null==e?void 0:e.name)?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!=(i=null==e?void 0:e.stack)?i:""}`,hint:"",code:`${null!=(r=null==e?void 0:e.code)?r:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}}t.default=o},64371:(e,t,i)=>{"use strict";i.d(t,{B5:()=>b,EZ:()=>R,Ff:()=>v,GM:()=>U,GT:()=>j,H0:()=>w,Hj:()=>Z,L7:()=>z,Lq:()=>ei,NR:()=>c,O9:()=>k,Ow:()=>d,Pf:()=>f,TJ:()=>$,Uy:()=>q,V6:()=>D,Vz:()=>K,W_:()=>_,Y6:()=>u,Yk:()=>E,Z$:()=>P,Z4:()=>x,ZH:()=>A,ZK:()=>g,Zk:()=>F,_1:()=>L,_C:()=>Q,_u:()=>N,az:()=>S,bF:()=>X,bL:()=>J,cA:()=>W,cP:()=>M,dU:()=>Y,e3:()=>y,e5:()=>m,ec:()=>G,g9:()=>C,hQ:()=>et,hU:()=>h,lt:()=>p,nh:()=>T,o6:()=>O,pP:()=>I,pU:()=>o,tr:()=>ee,u$:()=>l,u1:()=>H,u7:()=>a,wI:()=>V,zg:()=>n});var r=i(89081),s=i(29803);let n="Readest/Books",o="Readest/Books";["epub","mobi","azw","azw3","fb2","zip","cbz","pdf","txt"].map(e=>".".concat(e)).join(", ");let a={keepLogin:!1,autoUpload:!0,alwaysOnTop:!1,autoCheckUpdates:!0,screenWakeLock:!1,openLastBooks:!1,lastOpenBooks:[],autoImportBooksOnOpen:!1,telemetryEnabled:!0,libraryViewMode:"grid",librarySortBy:"updated",librarySortAscending:!1,lastSyncedAtBooks:0,lastSyncedAtConfigs:0,lastSyncedAtNotes:0},l={sideBarWidth:"15%",isSideBarPinned:!0,notebookWidth:"25%",isNotebookPinned:!1,autohideCursor:!0,translationProvider:"deepl",translateTargetLang:"EN",customThemes:[],highlightStyle:"highlight",highlightStyles:{highlight:"yellow",underline:"green",squiggly:"blue"}},c={sideBarWidth:"25%",isSideBarPinned:!1},u={serifFont:"Bitter",sansSerifFont:"Roboto",monospaceFont:"Consolas",defaultFont:"Serif",defaultCJKFont:"LXGW WenKai GB Screen",defaultFontSize:16,minimumFontSize:8,fontWeight:400},h={marginPx:44,gapPercent:5,compactMarginPx:0,compactGapPercent:5,scrolled:!1,disableClick:!1,swapClickArea:!1,volumeKeysToFlip:!1,continuousScroll:!1,maxColumnCount:2,maxInlineSize:(0,r.aL)(),maxBlockSize:(0,r.ij)(),animated:!1,writingMode:"auto",vertical:!1,rtl:!1,scrollingOverlap:0,allowScript:!1},d={zoomLevel:100,paragraphMargin:1,lineHeight:1.6,wordSpacing:0,letterSpacing:0,textIndent:0,fullJustification:!0,hyphenation:!0,invertImgColorInDark:!1,theme:"light",overrideFont:!1,overrideLayout:!1,overrideColor:!1,userStylesheet:""},f={fullJustification:!1,animated:!0,defaultFont:"Sans-serif"},p={fullJustification:!0,textIndent:2},g={sideBarTab:"toc",uiLanguage:"",sortedTOC:!1,doubleBorder:!1,borderColor:"red",showHeader:!0,showFooter:!0,showBarsOnScroll:!1,showRemainingTime:!1,showPageNumber:!0},v={ttsRate:1.3,ttsVoice:"",ttsLocation:""},_={translationEnabled:!1,translationProvider:"deepl",translateTargetLang:""},m={screenOrientation:"auto"},y={scope:"book",matchCase:!1,matchWholeWords:!1,matchDiacritics:!1},b=1,w=["Bitter","Literata","Merriweather","Vollkorn","Georgia","Times New Roman"],k=["Georgia","Times New Roman"],S=[(0,s.Gg)("LXGW WenKai GB Screen"),(0,s.Gg)("LXGW WenKai TC"),(0,s.Gg)("GuanKiapTsingKhai-T")],E=["Noto Sans SC","Noto Sans TC"],x=["Roboto","Noto Sans","Open Sans","Helvetica"],T=["Fira Code","Lucida Console","Consolas","Courier New"],O=["MiSans L3"],P=["Arial","Arial Black","Bahnschrift","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Ebrima","FangSong","Franklin Gothic Medium","Gabriola","Gadugi","Georgia","Heiti","HoloLens MDL2 Assets","Impact","Ink Free","Javanese Text","KaiTi","Leelawadee UI","Lucida Console","Lucida Sans Unicode","LXGW WenKai GB Screen","LXGW WenKai TC","Malgun Gothic","Marlett","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU-ExtB","Mongolian Baiti","MS Gothic","MS Mincho","MV Boli","Myanmar Text","Nirmala UI","Noto Serif JP","NSimSun","Palatino Linotype","PMingLiU","Segoe MDL2 Assets","Segoe Print","Segoe Script","Segoe UI","Segoe UI Historic","Segoe UI Emoji","Segoe UI Symbol","SimHei","SimSun","SimSun-ExtB","Sitka","Sylfaen","Tahoma","Times New Roman","Trebuchet MS","Verdana","XiHeiti","Yu Gothic","Yu Mincho"],I=["American Typewriter","Andale Mono","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Avenir","Avenir Next","Avenir Next Condensed","Baskerville","BiauKai","Big Caslon","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Cochin","Comic Sans MS","Copperplate","Courier","Courier New","Didot","DIN Alternate","DIN Condensed","FangSong","Futura","Geneva","Georgia","Gill Sans","Heiti SC","Heiti TC","Helvetica","Helvetica Neue","Herculanum","Hiragino Sans","Hiragino Mincho","Hoefler Text","Impact","Kaiti SC","Kaiti TC","Kozuka Gothic Pro","Kozuka Mincho Pro","Lucida Grande","Luminari","LXGW WenKai GB Screen","LXGW WenKai TC","Marker Felt","Menlo","Microsoft Sans Serif","Monaco","Noteworthy","Noto Serif JP","Optima","Palatino","Papyrus","PingFang HK","PingFang SC","PingFang TC","Phosphate","Rockwell","Savoye LET","SignPainter","Skia","Snell Roundhand","Songti SC","Songti TC","STFangsong","STKaiti","STSong","STXihei","Tahoma","Times","Times New Roman","Trattatello","Trebuchet MS","Verdana","XiHeiti","Yu Mincho","Zapfino"],C=["Arial","Cantarell","Comic Sans MS","Courier New","DejaVu Sans","DejaVu Sans Mono","DejaVu Serif","Droid Sans","Droid Sans Mono","FangSong","FreeMono","FreeSans","FreeSerif","Georgia","Heiti","Impact","Kaiti","Liberation Mono","Liberation Sans","Liberation Serif","LXGW WenKai GB Screen","LXGW WenKai TC","Noto Mono","Noto Sans","Noto Sans JP","Noto Sans CJK SC","Noto Sans CJK TC","Noto Serif","Noto Serif JP","Noto Serif CJK SC","Noto Serif CJK TC","Open Sans","Poppins","Sazanami Gothic","Sazanami Mincho","Source Han Sans","Source Han Serif","Times New Roman","Ubuntu","Ubuntu Mono","WenQuanYi Micro Hei","WenQuanYi Zen Hei","XiHeiti"],A=["Avenir","Avenir Next","Courier","Courier New","FangSong","Georgia","Heiti","Helvetica","Helvetica Neue","Hiragino Mincho","Hiragino Sans","Kaiti","LXGW WenKai GB Screen","LXGW WenKai TC","Palatino","PingFang SC","PingFang TC","San Francisco","SF Pro Display","SF Pro Rounded","SF Pro Text","Songti","Times New Roman","Verdana","XiHeiti"],$=["Arial","Droid Sans","Droid Serif","FangSong","FZLanTingHei","Georgia","Heiti","Kaiti","LXGW WenKai GB Screen","LXGW WenKai TC","Noto Sans","Noto Sans CJK","Noto Sans JP","Noto Serif","Noto Serif CJK","Noto Serif JP","PingFang SC","Roboto","Source Han Sans","Source Han Serif","STHeiti","STSong","Tahoma","Verdana","XiHeiti"],R=/[\u3040-\u30FF\u4E00-\u9FFF\uAC00-\uD7AF]/,j=RegExp("AlBayan|STIX|Kailasa|ITCTT|Luminari|Myanmar","i"),L=RegExp("CJK|TC$|SC$|HK|JP|TW|Sim|Kai|Hei|Yan|Min|Khai|Yuan|Song|Ming|FZ|FangZheng|WenQuanYi|PingFang|Hiragino|Meiryo|Source\\s?Han|Yu\\s?Gothic|Yu\\s?Mincho|Mincho|Nanum|Malgun|Gulim|Dotum|Batang|Gungsuh|OPPO sans|MiSans|Fallback","i"),F="+",M="https://readest.com?utm_source=readest_web",N="https://web.readest.com",B="https://github.com/readest/readest/releases/latest/download",U="".concat(B,"/latest.json"),D="".concat(B,"/release-notes.json"),q=3,H=5,z=86400,G=500,W=50,J=10,K={free:51200,plus:512e3,pro:1048576},V=250,X=!0,Y=500,Z={red:"#f87171",yellow:"#facc15",green:"#4ade80",blue:"#60a5fa",violet:"#a78bfa"},Q=[{light:{fg:"#2b2b2b",bg:"#f3f3f3",primary:"#3c5a72"},dark:{fg:"#d0d0d0",bg:"#1a1c1f",primary:"#486e8a"}},{light:{fg:"#3f2f3c",bg:"#f5ecf8",primary:"#7b5291"},dark:{fg:"#d6cadd",bg:"#3a2c3d",primary:"#bda0cc"}},{light:{fg:"#2b2b2b",bg:"#defcd9",primary:"#00796b"},dark:{fg:"#c8e6c9",bg:"#273c33",primary:"#26a69a"}}],ee=["zh","ja","ko","ar","he","fa","ur","dv","ps","sd","yi",""],et={en:"English",fr:"Fran\xe7ais",de:"Deutsch",nl:"Nederlands",it:"Italiano",ja:"",ko:"",es:"Espa\xf1ol",pt:"Portugu\xeas",ru:"",ar:"",el:"",uk:"",pl:"Polski",tr:"T\xfcrk\xe7e",hi:"",id:"Indonesia",vi:"Ting Vit","zh-CN":"","zh-TW":""},ei={...et,zh:""}},67523:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(22515)),n=r(i(73589)),o=i(11880);class a{constructor(e,{headers:t={},schema:i,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},o.DEFAULT_HEADERS),t),this.schemaName=i,this.fetch=r}from(e){let t=new URL(`${this.url}/${e}`);return new s.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new a(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:i=!1,get:r=!1,count:s}={}){let o,a,l=new URL(`${this.url}/rpc/${e}`);i||r?(o=i?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(o="POST",a=t);let c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new n.default({method:o,url:l,headers:c,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}t.default=a},67525:(e,t)=>{"use strict";t.Y=function(e,t){return(function(e){return e.split(",").map(function(e){var t=(e=e.trim()).match(i),n=t[1],o=t[2],a=t[3]||"",l={};return l.inverse=!!n&&"not"===n.toLowerCase(),l.type=o?o.toLowerCase():"all",l.expressions=(a=a.match(/\([^\)]+\)/g)||[]).map(function(e){var t=e.match(r),i=t[1].toLowerCase().match(s);return{modifier:i[1],feature:i[2],value:t[2]}}),l})})(e).some(function(e){var i=e.inverse,r="all"===e.type||t.type===e.type;if(r&&i||!(r||i))return!1;var s=e.expressions.every(function(e){var i=e.feature,r=e.modifier,s=e.value,n=t[i];if(!n)return!1;switch(i){case"orientation":case"scan":return n.toLowerCase()===s.toLowerCase();case"width":case"height":case"device-width":case"device-height":s=c(s),n=c(n);break;case"resolution":s=l(s),n=l(n);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":s=a(s),n=a(n);break;case"grid":case"color":case"color-index":case"monochrome":s=parseInt(s,10)||1,n=parseInt(n,10)||0}switch(r){case"min":return n>=s;case"max":return n<=s;default:return n===s}});return s&&!i||!s&&i})};var i=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,r=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,s=/^(?:(min|max)-)?(.+)/,n=/(em|rem|px|cm|mm|in|pt|pc)?$/,o=/(dpi|dpcm|dppx)?$/;function a(e){var t,i=Number(e);return i||(i=(t=e.match(/^(\d+)\s*\/\s*(\d+)$/))[1]/t[2]),i}function l(e){var t=parseFloat(e);switch(String(e).match(o)[1]){case"dpcm":return t/2.54;case"dppx":return 96*t;default:return t}}function c(e){var t=parseFloat(e);switch(String(e).match(n)[1]){case"em":case"rem":return 16*t;case"cm":return 96*t/2.54;case"mm":return 96*t/2.54/10;case"in":return 96*t;case"pt":return 72*t;case"pc":return 72*t/12;default:return t}}},71587:(e,t,i)=>{"use strict";var r=i(57643);Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{default:function(){return v},defaultHead:function(){return d}});let s=i(34007),n=i(26908),o=i(33736),a=n._(i(91844)),l=s._(i(91404)),c=i(79299),u=i(94411),h=i(25467);function d(e){void 0===e&&(e=!1);let t=[(0,o.jsx)("meta",{charSet:"utf-8"},"charset")];return e||t.push((0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),t}function f(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===a.default.Fragment?e.concat(a.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}i(73979);let p=["name","httpEquiv","charSet","itemProp"];function g(e,t){let{inAmpMode:i}=t;return e.reduce(f,[]).reverse().concat(d(i).reverse()).filter(function(){let e=new Set,t=new Set,i=new Set,r={};return s=>{let n=!0,o=!1;if(s.key&&"number"!=typeof s.key&&s.key.indexOf("$")>0){o=!0;let t=s.key.slice(s.key.indexOf("$")+1);e.has(t)?n=!1:e.add(t)}switch(s.type){case"title":case"base":t.has(s.type)?n=!1:t.add(s.type);break;case"meta":for(let e=0,t=p.length;e<t;e++){let t=p[e];if(s.props.hasOwnProperty(t))if("charSet"===t)i.has(t)?n=!1:i.add(t);else{let e=s.props[t],i=r[t]||new Set;("name"!==t||!o)&&i.has(e)?n=!1:(i.add(e),r[t]=i)}}}return n}}()).reverse().map((e,t)=>{let s=e.key||t;if(r.env.__NEXT_OPTIMIZE_FONTS&&!i&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(t=>e.props.href.startsWith(t))){let t={...e.props||{}};return t["data-href"]=t.href,t.href=void 0,t["data-optimized-fonts"]=!0,a.default.cloneElement(e,t)}return a.default.cloneElement(e,{key:s})})}let v=function(e){let{children:t}=e,i=(0,a.useContext)(c.AmpStateContext),r=(0,a.useContext)(u.HeadManagerContext);return(0,o.jsx)(l.default,{reduceComponentsToState:g,headManager:r,inAmpMode:(0,h.isInAmpMode)(i),children:t})};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},73475:(e,t,i)=>{e.exports=i(71587)},73548:(e,t,i)=>{"use strict";let r,s;i.d(t,{ND:()=>t$});let n=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(i.bind(i,60688)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)};class o extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class a extends o{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class l extends o{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class c extends o{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(G||(G={}));class u{constructor(e,{headers:t={},customFetch:i,region:r=G.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=n(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var i,r,s,n,o;return r=this,s=void 0,n=void 0,o=function*(){try{let r,s,{headers:n,method:o,body:u}=t,h={},{region:d}=t;d||(d=this.region),d&&"any"!==d&&(h["x-region"]=d),u&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",r=u):"string"==typeof u?(h["Content-Type"]="text/plain",r=u):"undefined"!=typeof FormData&&u instanceof FormData?r=u:(h["Content-Type"]="application/json",r=JSON.stringify(u)));let f=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),n),body:r}).catch(e=>{throw new a(e)}),p=f.headers.get("x-relay-error");if(p&&"true"===p)throw new l(f);if(!f.ok)throw new c(f);let g=(null!=(i=f.headers.get("Content-Type"))?i:"text/plain").split(";")[0].trim();return{data:"application/json"===g?yield f.json():"application/octet-stream"===g?yield f.blob():"text/event-stream"===g?f:"multipart/form-data"===g?yield f.formData():yield f.text(),error:null}}catch(e){return{data:null,error:e}}},new(n||(n=Promise))(function(e,t){function i(e){try{l(o.next(e))}catch(e){t(e)}}function a(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof n?r:new n(function(e){e(r)})).then(i,a)}l((o=o.apply(r,s||[])).next())})}}let{PostgrestClient:h,PostgrestQueryBuilder:d,PostgrestFilterBuilder:f,PostgrestTransformBuilder:p,PostgrestBuilder:g,PostgrestError:v}=i(94369),_="undefined"==typeof window?i(94589):window.WebSocket,m={"X-Client-Info":"realtime-js/2.11.10"};!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(W||(W={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(J||(J={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(K||(K={})),(V||(V={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(X||(X={}));class y{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,t,i)}_decodeBroadcast(e,t,i){let r=t.getUint8(1),s=t.getUint8(2),n=this.HEADER_LENGTH+2,o=i.decode(e.slice(n,n+r));n+=r;let a=i.decode(e.slice(n,n+s));return n+=s,{ref:null,topic:o,event:a,payload:JSON.parse(i.decode(e.slice(n,e.byteLength)))}}}class b{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Y||(Y={}));let w=(e,t,i={})=>{var r;let s=null!=(r=i.skipTypes)?r:[];return Object.keys(t).reduce((i,r)=>(i[r]=k(r,e,t,s),i),{})},k=(e,t,i,r)=>{let s=t.find(t=>t.name===e),n=null==s?void 0:s.type,o=i[e];return n&&!r.includes(n)?S(n,o):E(o)},S=(e,t)=>{if("_"===e.charAt(0))return P(t,e.slice(1,e.length));switch(e){case Y.bool:return x(t);case Y.float4:case Y.float8:case Y.int2:case Y.int4:case Y.int8:case Y.numeric:case Y.oid:return T(t);case Y.json:case Y.jsonb:return O(t);case Y.timestamp:return I(t);case Y.abstime:case Y.date:case Y.daterange:case Y.int4range:case Y.int8range:case Y.money:case Y.reltime:case Y.text:case Y.time:case Y.timestamptz:case Y.timetz:case Y.tsrange:case Y.tstzrange:default:return E(t)}},E=e=>e,x=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},T=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},O=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},P=(e,t)=>{if("string"!=typeof e)return e;let i=e.length-1,r=e[i];if("{"===e[0]&&"}"===r){let r,s=e.slice(1,i);try{r=JSON.parse("["+s+"]")}catch(e){r=s?s.split(","):[]}return r.map(e=>S(t,e))}return e},I=e=>"string"==typeof e?e.replace(" ","T"):e,C=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")};class A{constructor(e,t,i={},r=1e4){this.channel=e,this.event=t,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t(null==(i=this.receivedResp)?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(Z||(Z={}));class ${constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let i=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},e=>{let{onJoin:t,onLeave:i,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=$.syncState(this.state,e,t,i),this.pendingDiffs.forEach(e=>{this.state=$.syncDiff(this.state,e,t,i)}),this.pendingDiffs=[],r()}),this.channel._on(i.diff,{},e=>{let{onJoin:t,onLeave:i,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=$.syncDiff(this.state,e,t,i),r())}),this.onJoin((e,t,i)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:i})}),this.onLeave((e,t,i)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,r){let s=this.cloneDeep(e),n=this.transformState(t),o={},a={};return this.map(s,(e,t)=>{n[e]||(a[e]=t)}),this.map(n,(e,t)=>{let i=s[e];if(i){let r=t.map(e=>e.presence_ref),s=i.map(e=>e.presence_ref),n=t.filter(e=>0>s.indexOf(e.presence_ref)),l=i.filter(e=>0>r.indexOf(e.presence_ref));n.length>0&&(o[e]=n),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(s,{joins:o,leaves:a},i,r)}static syncDiff(e,t,i,r){let{joins:s,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(s,(t,r)=>{var s;let n=null!=(s=e[t])?s:[];if(e[t]=this.cloneDeep(r),n.length>0){let i=e[t].map(e=>e.presence_ref),r=n.filter(e=>0>i.indexOf(e.presence_ref));e[t].unshift(...r)}i(t,n,r)}),this.map(n,(t,i)=>{let s=e[t];if(!s)return;let n=i.map(e=>e.presence_ref);s=s.filter(e=>0>n.indexOf(e.presence_ref)),e[t]=s,r(t,s,i),0===s.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,i)=>{let r=e[i];return"metas"in r?t[i]=r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[i]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(Q||(Q={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(ee||(ee={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(et||(et={}));class R{constructor(e,t={config:{}},i){this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=J.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new A(this,K.join,this.params,this.timeout),this.rejoinTimer=new b(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=J.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=J.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=J.errored,this.rejoinTimer.scheduleTimeout())}),this._on(K.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new $(this),this.broadcastEndpointURL=C(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var i,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:s,presence:n,private:o}}=this.params;this._onError(t=>null==e?void 0:e(et.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(et.CLOSED));let a={},l={broadcast:s,presence:n,postgres_changes:null!=(r=null==(i=this.bindings.postgres_changes)?void 0:i.map(e=>e.filter))?r:[],private:o};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var i;if(this.socket.setAuth(),void 0===t){null==e||e(et.SUBSCRIBED);return}{let r=this.bindings.postgres_changes,s=null!=(i=null==r?void 0:r.length)?i:0,n=[];for(let i=0;i<s;i++){let s=r[i],{filter:{event:o,schema:a,table:l,filter:c}}=s,u=t&&t[i];if(u&&u.event===o&&u.schema===a&&u.table===l&&u.filter===c)n.push(Object.assign(Object.assign({},s),{id:u.id}));else{this.unsubscribe(),this.state=J.errored,null==e||e(et.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=n,e&&e(et.SUBSCRIBED);return}}).receive("error",t=>{this.state=J.errored,null==e||e(et.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(et.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this._on(e,t,i)}async send(e,t={}){var i,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(i=>{var r,s,n;let o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null==(n=null==(s=null==(r=this.params)?void 0:r.config)?void 0:s.broadcast)?void 0:n.ack)||i("ok"),o.receive("ok",()=>i("ok")),o.receive("error",()=>i("error")),o.receive("timeout",()=>i("timed out"))});{let{event:s,payload:n}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:n,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!=(i=t.timeout)?i:this.timeout);return await (null==(r=e.body)?void 0:r.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=J.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(K.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(i=>{let r=new A(this,K.leave,{},e);r.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,i){let r=new AbortController,s=setTimeout(()=>r.abort(),i),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(s),n}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new A(this,e,t,i);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var r,s;let n=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=K;if(i&&[o,a,l,c].indexOf(n)>=0&&i!==this._joinRef())return;let u=this._onMessage(n,t,i);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null==(r=this.bindings.postgres_changes)||r.filter(e=>{var t,i,r;return(null==(t=e.filter)?void 0:t.event)==="*"||(null==(r=null==(i=e.filter)?void 0:i.event)?void 0:r.toLocaleLowerCase())===n}).map(e=>e.callback(u,i)):null==(s=this.bindings[n])||s.filter(e=>{var i,r,s,o,a,l;if(!["broadcast","presence","postgres_changes"].includes(n))return e.type.toLocaleLowerCase()===n;if("id"in e){let n=e.id,o=null==(i=e.filter)?void 0:i.event;return n&&(null==(r=t.ids)?void 0:r.includes(n))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null==(s=t.data)?void 0:s.type.toLocaleLowerCase()))}{let i=null==(a=null==(o=null==e?void 0:e.filter)?void 0:o.event)?void 0:a.toLocaleLowerCase();return"*"===i||i===(null==(l=null==t?void 0:t.event)?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof u&&"ids"in u){let e=u.data,{schema:t,table:i,commit_timestamp:r,type:s,errors:n}=e;u=Object.assign(Object.assign({},{schema:t,table:i,commit_timestamp:r,eventType:s,new:{},old:{},errors:n}),this._getPayloadRecords(e))}e.callback(u,i)})}_isClosed(){return this.state===J.closed}_isJoined(){return this.state===J.joined}_isJoining(){return this.state===J.joining}_isLeaving(){return this.state===J.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){let r=e.toLocaleLowerCase(),s={type:r,filter:t,callback:i};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,t){let i=e.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(e=>{var r;return!((null==(r=e.type)?void 0:r.toLocaleLowerCase())===i&&R.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let i in e)if(e[i]!==t[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(K.close,{},e)}_onError(e){this._on(K.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=J.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=w(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=w(e.columns,e.old_record)),t}}let j=()=>{},L=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class F{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=m,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=j,this.ref=0,this.logger=j,this.conn=null,this.sendBuffer=[],this.serializer=new y,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(i.bind(i,60688)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${V.websocket}`,this.httpEndpoint=C(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),((null==t?void 0:t.logLevel)||(null==t?void 0:t.log_level))&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let s=null==(r=null==t?void 0:t.params)?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new b(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=_),this.transport){"undefined"!=typeof window&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new M(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(e=>e.teardown()))}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return this.channels=this.channels.filter(t=>t._joinRef!==e._joinRef),0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case W.connecting:return X.Connecting;case W.open:return X.Open;case W.closing:return X.Closing;default:return X.Closed}}isConnected(){return this.connectionState()===X.Open}channel(e,t={config:{}}){let i=`realtime:${e}`,r=this.getChannels().find(e=>e.topic===i);if(r)return r;{let i=new R(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){let{topic:t,event:i,payload:r,ref:s}=e,n=()=>{this.encode(e,e=>{var t;null==(t=this.conn)||t.send(e)})};this.log("push",`${t} ${i} (${s})`,r),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),e.joinedOnce&&e._isJoined()&&e._push(K.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected())return void this.heartbeatCallback("disconnected");if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),null==(e=this.conn)||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:i,payload:r,ref:s}=e;"phoenix"===t&&"phx_reply"===i&&this.heartbeatCallback("ok"==e.payload.status?"ok":"error"),s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${i} ${s&&"("+s+")"||""}`,r),Array.from(this.channels).filter(e=>e._isMember(t)).forEach(e=>e._trigger(i,r,s)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(K.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let i=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${i}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([L],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class M{constructor(e,t,i){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=W.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=i.close}}class N extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function B(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class U extends N{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class D extends N{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let q=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(i.bind(i,60688)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},H=()=>(function(e,t,i,r){return new(i||(i=Promise))(function(s,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(i.bind(i,60688))).Response:Response}),z=e=>{if(Array.isArray(e))return e.map(e=>z(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,i])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=z(i)}),t};var G,W,J,K,V,X,Y,Z,Q,ee,et,ei=function(e,t,i,r){return new(i||(i=Promise))(function(s,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};let er=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),es=(e,t,i)=>ei(void 0,void 0,void 0,function*(){e instanceof(yield H())&&!(null==i?void 0:i.noResolveJson)?e.json().then(i=>{t(new U(er(i),e.status||500))}).catch(e=>{t(new D(er(e),e))}):t(new D(er(e),e))}),en=(e,t,i,r)=>{let s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),i))};function eo(e,t,i,r,s,n){return ei(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(i,en(t,r,s,n)).then(e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(e=>es(e,a,r))})})}function ea(e,t,i,r){return ei(this,void 0,void 0,function*(){return eo(e,"GET",t,i,r)})}function el(e,t,i,r,s){return ei(this,void 0,void 0,function*(){return eo(e,"POST",t,r,s,i)})}function ec(e,t,i,r,s){return ei(this,void 0,void 0,function*(){return eo(e,"DELETE",t,r,s,i)})}var eu=i(15599).hp,eh=function(e,t,i,r){return new(i||(i=Promise))(function(s,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};let ed={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ef={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ep{constructor(e,t={},i,r){this.url=e,this.headers=t,this.bucketId=i,this.fetch=q(r)}uploadOrUpdate(e,t,i,r){return eh(this,void 0,void 0,function*(){try{let s,n=Object.assign(Object.assign({},ef),r),o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)}),a=n.metadata;"undefined"!=typeof Blob&&i instanceof Blob?((s=new FormData).append("cacheControl",n.cacheControl),a&&s.append("metadata",this.encodeMetadata(a)),s.append("",i)):"undefined"!=typeof FormData&&i instanceof FormData?((s=i).append("cacheControl",n.cacheControl),a&&s.append("metadata",this.encodeMetadata(a))):(s=i,o["cache-control"]=`max-age=${n.cacheControl}`,o["content-type"]=n.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==r?void 0:r.headers)&&(o=Object.assign(Object.assign({},o),r.headers));let l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:o},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{})),h=yield u.json();if(u.ok)return{data:{path:l,id:h.Id,fullPath:h.Key},error:null};return{data:null,error:h}}catch(e){if(B(e))return{data:null,error:e};throw e}})}upload(e,t,i){return eh(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}uploadToSignedUrl(e,t,i,r){return eh(this,void 0,void 0,function*(){let s=this._removeEmptyFolders(e),n=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${n}`);o.searchParams.set("token",t);try{let e,t=Object.assign({upsert:ef.upsert},r),n=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&i instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",i)):"undefined"!=typeof FormData&&i instanceof FormData?(e=i).append("cacheControl",t.cacheControl):(e=i,n["cache-control"]=`max-age=${t.cacheControl}`,n["content-type"]=t.contentType);let a=yield this.fetch(o.toString(),{method:"PUT",body:e,headers:n}),l=yield a.json();if(a.ok)return{data:{path:s,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(B(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return eh(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");let s=yield el(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),n=new URL(this.url+s.url),o=n.searchParams.get("token");if(!o)throw new N("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:o},error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}update(e,t,i){return eh(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t,i){return eh(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==i?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}copy(e,t,i){return eh(this,void 0,void 0,function*(){try{return{data:{path:(yield el(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==i?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,i){return eh(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=yield el(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==i?void 0:i.transform)?{transform:i.transform}:{}),{headers:this.headers}),n=(null==i?void 0:i.download)?`&download=${!0===i.download?"":i.download}`:"";return{data:s={signedUrl:encodeURI(`${this.url}${s.signedURL}${n}`)},error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,i){return eh(this,void 0,void 0,function*(){try{let r=yield el(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=(null==i?void 0:i.download)?`&download=${!0===i.download?"":i.download}`:"";return{data:r.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${s}`):null})),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}download(e,t){return eh(this,void 0,void 0,function*(){let i=void 0!==(null==t?void 0:t.transform),r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),s=r?`?${r}`:"";try{let t=this._getFinalPath(e),r=yield ea(this.fetch,`${this.url}/${i?"render/image/authenticated":"object"}/${t}${s}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}info(e){return eh(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield ea(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:z(e),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}exists(e){return eh(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,i,r){return ei(this,void 0,void 0,function*(){return eo(e,"HEAD",t,Object.assign(Object.assign({},i),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(B(e)&&e instanceof D){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let i=this._getFinalPath(e),r=[],s=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==s&&r.push(s);let n=void 0!==(null==t?void 0:t.transform),o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&r.push(o);let a=r.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${n?"render/image":"object"}/public/${i}${a}`)}}}remove(e){return eh(this,void 0,void 0,function*(){try{return{data:yield ec(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}list(e,t,i){return eh(this,void 0,void 0,function*(){try{let r=Object.assign(Object.assign(Object.assign({},ed),t),{prefix:e||""});return{data:yield el(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==eu?eu.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let eg={"X-Client-Info":"storage-js/2.7.1"};var ev=function(e,t,i,r){return new(i||(i=Promise))(function(s,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};class e_{constructor(e,t={},i){this.url=e,this.headers=Object.assign(Object.assign({},eg),t),this.fetch=q(i)}listBuckets(){return ev(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}getBucket(e){return ev(this,void 0,void 0,function*(){try{return{data:yield ea(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return ev(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return ev(this,void 0,void 0,function*(){try{return{data:yield function(e,t,i,r,s){return ei(this,void 0,void 0,function*(){return eo(e,"PUT",t,r,void 0,i)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}emptyBucket(e){return ev(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}deleteBucket(e){return ev(this,void 0,void 0,function*(){try{return{data:yield ec(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(B(e))return{data:null,error:e};throw e}})}}class em extends e_{constructor(e,t={},i){super(e,t,i)}from(e){return new ep(this.url,this.headers,e,this.fetch)}}let ey="";ey="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let eb={headers:{"X-Client-Info":`supabase-js-${ey}/2.49.10`}},ew={schema:"public"},ek={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},eS={};var eE=i(60688);let ex=e=>{let t;return t=e||("undefined"==typeof fetch?eE.default:fetch),(...e)=>t(...e)},eT=()=>"undefined"==typeof Headers?eE.Headers:Headers,eO=(e,t,i)=>{let r=ex(i),s=eT();return(i,n)=>(function(e,t,i,r){return new(i||(i=Promise))(function(s,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){var o;let a=null!=(o=yield t())?o:e,l=new s(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),r(i,Object.assign(Object.assign({},n),{headers:l}))})},eP="2.69.1",eI={"X-Client-Info":`gotrue-js/${eP}`},eC="X-Supabase-Api-Version",eA={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},e$=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class eR extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function ej(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class eL extends eR{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}class eF extends eR{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class eM extends eR{constructor(e,t,i,r){super(e,i,r),this.name=t,this.status=i}}class eN extends eM{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class eB extends eM{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class eU extends eM{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class eD extends eM{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eq extends eM{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eH extends eM{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ez(e){return ej(e)&&"AuthRetryableFetchError"===e.name}class eG extends eM{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class eW extends eM{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let eJ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),eK=" 	\n\r=".split(""),eV=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<eK.length;t+=1)e[eK[t].charCodeAt(0)]=-2;for(let t=0;t<eJ.length;t+=1)e[eJ[t].charCodeAt(0)]=t;return e})();function eX(e,t,i){let r=eV[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)i(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===r)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function eY(e){let t=[],i=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},n=e=>{!function(e,t,i){if(0===t.utf8seq){if(e<=127)return i(e);for(let i=1;i<6;i+=1)if((e>>7-i&1)==0){t.utf8seq=i;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&i(t.codepoint)}}(e,r,i)};for(let t=0;t<e.length;t+=1)eX(e.charCodeAt(t),s,n);return t.join("")}let eZ=()=>"undefined"!=typeof window&&"undefined"!=typeof document,eQ={tested:!1,writable:!1},e0=()=>{if(!eZ())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(eQ.tested)return eQ.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),eQ.tested=!0,eQ.writable=!0}catch(e){eQ.tested=!0,eQ.writable=!1}return eQ.writable},e1=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(i.bind(i,60688)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},e2=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,e5=async(e,t,i)=>{await e.setItem(t,JSON.stringify(i))},e3=async(e,t)=>{let i=await e.getItem(t);if(!i)return null;try{return JSON.parse(i)}catch(e){return i}},e6=async(e,t)=>{await e.removeItem(t)};class e8{constructor(){this.promise=new e8.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function e4(e){let t=e.split(".");if(3!==t.length)throw new eW("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!e$.test(t[e]))throw new eW("JWT not in base64url format");return{header:JSON.parse(eY(t[0])),payload:JSON.parse(eY(t[1])),signature:function(e){let t=[],i={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)eX(e.charCodeAt(t),i,r);return new Uint8Array(t)}(t[2]),raw:{header:t[0],payload:t[1]}}}async function e7(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function e9(e){return("0"+e.toString(16)).substr(-2)}async function te(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function tt(e){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e):btoa(await te(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ti(e,t,i=!1){let r=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,i="";for(let r=0;r<56;r++)i+=e.charAt(Math.floor(Math.random()*t));return i}return crypto.getRandomValues(e),Array.from(e,e9).join("")}(),s=r;i&&(s+="/PASSWORD_RECOVERY"),await e5(e,`${t}-code-verifier`,s);let n=await tt(r),o=r===n?"plain":"s256";return[n,o]}e8.promiseConstructor=Promise;let tr=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;var ts=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)0>t.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};let tn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),to=[502,503,504];async function ta(e){var t;let i,r;if(!e2(e))throw new eH(tn(e),0);if(to.includes(e.status))throw new eH(tn(e),e.status);try{i=await e.json()}catch(e){throw new eF(tn(e),e)}let s=function(e){let t=e.headers.get(eC);if(!t||!t.match(tr))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(s&&s.getTime()>=eA["2024-01-01"].timestamp&&"object"==typeof i&&i&&"string"==typeof i.code?r=i.code:"object"==typeof i&&i&&"string"==typeof i.error_code&&(r=i.error_code),r){if("weak_password"===r)throw new eG(tn(i),e.status,(null==(t=i.weak_password)?void 0:t.reasons)||[]);else if("session_not_found"===r)throw new eN}else if("object"==typeof i&&i&&"object"==typeof i.weak_password&&i.weak_password&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new eG(tn(i),e.status,i.weak_password.reasons);throw new eL(tn(i),e.status||500,r)}let tl=(e,t,i,r)=>{let s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),i))};async function tc(e,t,i,r){var s;let n=Object.assign({},null==r?void 0:r.headers);n[eC]||(n[eC]=eA["2024-01-01"].name),(null==r?void 0:r.jwt)&&(n.Authorization=`Bearer ${r.jwt}`);let o=null!=(s=null==r?void 0:r.query)?s:{};(null==r?void 0:r.redirectTo)&&(o.redirect_to=r.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await tu(e,t,i+a,{headers:n,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function tu(e,t,i,r,s,n){let o,a=tl(t,r,s,n);try{o=await e(i,Object.assign({},a))}catch(e){throw console.error(e),new eH(tn(e),0)}if(o.ok||await ta(o),null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(e){await ta(e)}}function th(e){var t,i,r;let s=null;(r=e).access_token&&r.refresh_token&&r.expires_in&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(i=e.expires_in,Math.round(Date.now()/1e3)+i)));return{data:{session:s,user:null!=(t=e.user)?t:e},error:null}}function td(e){let t=th(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function tf(e){var t;return{data:{user:null!=(t=e.user)?t:e},error:null}}function tp(e){return{data:e,error:null}}function tg(e){let{action_link:t,email_otp:i,hashed_token:r,redirect_to:s,verification_type:n}=e;return{data:{properties:{action_link:t,email_otp:i,hashed_token:r,redirect_to:s,verification_type:n},user:Object.assign({},ts(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function tv(e){return e}var t_=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)0>t.indexOf(r[s])&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i};class tm{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=e1(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await tc(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(ej(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await tc(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tf})}catch(e){if(ej(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,i=t_(e,["options"]),r=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(r.new_email=null==i?void 0:i.newEmail,delete r.newEmail),await tc(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:tg,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(ej(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await tc(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tf})}catch(e){if(ej(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,i,r,s,n,o,a;try{let l={nextPage:null,lastPage:0,total:0},c=await tc(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(i=null==(t=null==e?void 0:e.page)?void 0:t.toString())?i:"",per_page:null!=(s=null==(r=null==e?void 0:e.perPage)?void 0:r.toString())?s:""},xform:tv});if(c.error)throw c.error;let u=await c.json(),h=null!=(n=c.headers.get("x-total-count"))?n:0,d=null!=(a=null==(o=c.headers.get("link"))?void 0:o.split(","))?a:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),i=JSON.parse(e.split(";")[1].split("=")[1]);l[`${i}Page`]=t}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(e){if(ej(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await tc(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tf})}catch(e){if(ej(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await tc(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tf})}catch(e){if(ej(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await tc(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tf})}catch(e){if(ej(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{let{data:t,error:i}=await tc(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:i}}catch(e){if(ej(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await tc(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(ej(e))return{data:null,error:e};throw e}}}let ty={getItem:e=>e0()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{e0()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{e0()&&globalThis.localStorage.removeItem(e)}};function tb(e={}){return{getItem:t=>e[t]||null,setItem:(t,i)=>{e[t]=i},removeItem:t=>{delete e[t]}}}let tw={debug:!!(globalThis&&e0()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class tk extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tS extends tk{}async function tE(e,t,i){tw.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),tw.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(r){tw.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await i()}finally{tw.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}if(0===t)throw tw.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tS(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(tw.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await i()}))}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}let tx={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function tT(e,t,i){return await i()}class tO{constructor(e){var t,i;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=tO.nextInstanceID,tO.nextInstanceID+=1,this.instanceID>0&&eZ()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let r=Object.assign(Object.assign({},tx),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new tm({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=e1(r.fetch),this.lock=r.lock||tT,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:eZ()&&(null==(t=null==globalThis?void 0:globalThis.navigator)?void 0:t.locks)?this.lock=tE:this.lock=tT,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:e0()?this.storage=ty:(this.memoryStorage={},this.storage=tb(this.memoryStorage)):(this.memoryStorage={},this.storage=tb(this.memoryStorage)),eZ()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null==(i=this.broadcastChannel)||i.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${eP}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t=function(e){let t={},i=new URL(e);if(i.hash&&"#"===i.hash[0])try{new URLSearchParams(i.hash.substring(1)).forEach((e,i)=>{t[i]=e})}catch(e){}return i.searchParams.forEach((e,i)=>{t[i]=e}),t}(window.location.href),i="none";if(this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce"),eZ()&&this.detectSessionInUrl&&"none"!==i){let{data:r,error:s}=await this._getSessionFromURL(t,i);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),ej(s)&&"AuthImplicitGrantRedirectError"===s.name){let t=null==(e=s.details)?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:s}}return await this._removeSession(),{error:s}}let{session:n,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",o),await this._saveSession(n),setTimeout(async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(ej(e))return{error:e};return{error:new eF("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,r;try{let{data:s,error:n}=await tc(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(i=null==(t=null==e?void 0:e.options)?void 0:t.data)?i:{},gotrue_meta_security:{captcha_token:null==(r=null==e?void 0:e.options)?void 0:r.captchaToken}},xform:th});if(n||!s)return{data:{user:null,session:null},error:n};let o=s.session,a=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:a,session:o},error:null}}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,i,r;try{let s;if("email"in e){let{email:i,password:r,options:n}=e,o=null,a=null;"pkce"===this.flowType&&([o,a]=await ti(this.storage,this.storageKey)),s=await tc(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:i,password:r,data:null!=(t=null==n?void 0:n.data)?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:o,code_challenge_method:a},xform:th})}else if("phone"in e){let{phone:t,password:n,options:o}=e;s=await tc(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!=(i=null==o?void 0:o.data)?i:{},channel:null!=(r=null==o?void 0:o.channel)?r:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:th})}else throw new eU("You must provide either an email or phone number and a password");let{data:n,error:o}=s;if(o||!n)return{data:{user:null,session:null},error:o};let a=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:i,password:r,options:s}=e;t=await tc(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:td})}else if("phone"in e){let{phone:i,password:r,options:s}=e;t=await tc(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:td})}else throw new eU("You must provide either an email or phone number and a password");let{data:i,error:r}=t;if(r)return{data:{user:null,session:null},error:r};if(!i||!i.session||!i.user)return{data:{user:null,session:null},error:new eB};return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:r}}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,i,r,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null==(t=e.options)?void 0:t.redirectTo,scopes:null==(i=e.options)?void 0:i.scopes,queryParams:null==(r=e.options)?void 0:r.queryParams,skipBrowserRedirect:null==(s=e.options)?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await e3(this.storage,`${this.storageKey}-code-verifier`),[i,r]=(null!=t?t:"").split("/");try{let{data:t,error:s}=await tc(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:th});if(await e6(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new eB};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:s}}catch(e){if(ej(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:i,token:r,access_token:s,nonce:n}=e,{data:o,error:a}=await tc(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:r,access_token:s,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:th});if(a)return{data:{user:null,session:null},error:a};if(!o||!o.session||!o.user)return{data:{user:null,session:null},error:new eB};return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:a}}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,i,r,s,n;try{if("email"in e){let{email:r,options:s}=e,n=null,o=null;"pkce"===this.flowType&&([n,o]=await ti(this.storage,this.storageKey));let{error:a}=await tc(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!=(t=null==s?void 0:s.data)?t:{},create_user:null==(i=null==s?void 0:s.shouldCreateUser)||i,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:n,code_challenge_method:o},redirectTo:null==s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){let{phone:t,options:i}=e,{data:o,error:a}=await tc(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!=(r=null==i?void 0:i.data)?r:{},create_user:null==(s=null==i?void 0:i.shouldCreateUser)||s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},channel:null!=(n=null==i?void 0:i.channel)?n:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new eU("You must provide either an email or phone number.")}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,i;try{let r,s;"options"in e&&(r=null==(t=e.options)?void 0:t.redirectTo,s=null==(i=e.options)?void 0:i.captchaToken);let{data:n,error:o}=await tc(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:th});if(o)throw o;if(!n)throw Error("An error occurred on token verification.");let a=n.session,l=n.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,i,r;try{let s=null,n=null;return"pkce"===this.flowType&&([s,n]=await ti(this.storage,this.storageKey)),await tc(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!=(i=null==(t=e.options)?void 0:t.redirectTo)?i:void 0}),(null==(r=null==e?void 0:e.options)?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:n}),headers:this.headers,xform:tp})}catch(e){if(ej(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new eN;let{error:r}=await tc(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:i,type:r,options:s}=e,{error:n}=await tc(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},redirectTo:null==s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){let{phone:i,type:r,options:s}=e,{data:n,error:o}=await tc(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:o}}throw new eU("You must provide either an email or phone number and a type")}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch(e){}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await e3(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let i=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,i,r)=>(t||"user"!==i||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,i,r))})}return{data:{session:e},error:null}}let{session:r,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{session:null},error:s};return{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await tc(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tf});return await this._useSession(async e=>{var t,i,r;let{data:s,error:n}=e;if(n)throw n;return(null==(t=s.session)?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await tc(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(r=null==(i=s.session)?void 0:i.access_token)?r:void 0,xform:tf}):{data:{user:null},error:new eN}})}catch(e){if(ej(e))return ej(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await e6(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{let{data:r,error:s}=i;if(s)throw s;if(!r.session)throw new eN;let n=r.session,o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await ti(this.storage,this.storageKey));let{data:l,error:c}=await tc(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:n.access_token,xform:tf});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}})}catch(e){if(ej(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new eN;let t=Date.now()/1e3,i=t,r=!0,s=null,{payload:n}=e4(e.access_token);if(n.exp&&(r=(i=n.exp)<=t),r){let{session:t,error:i}=await this._callRefreshToken(e.refresh_token);if(i)return{data:{user:null,session:null},error:i};if(!t)return{data:{user:null,session:null},error:null};s=t}else{let{data:r,error:n}=await this._getUser(e.access_token);if(n)throw n;s={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(e){if(ej(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){let{data:r,error:s}=t;if(s)throw s;e=null!=(i=r.session)?i:void 0}if(!(null==e?void 0:e.refresh_token))throw new eN;let{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(ej(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!eZ())throw new eD("No browser detected.");if(e.error||e.error_description||e.error_code)throw new eD(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new eq("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new eD("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new eq("No code detected.");let{data:t,error:i}=await this._exchangeCodeForSession(e.code);if(i)throw i;let r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:i,provider_refresh_token:r,access_token:s,refresh_token:n,expires_in:o,expires_at:a,token_type:l}=e;if(!s||!o||!n||!l)throw new eD("No session defined in URL");let c=Math.round(Date.now()/1e3),u=parseInt(o),h=c+u;a&&(h=parseInt(a));let d=h-c;1e3*d<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${u}s`);let f=h-u;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,h,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,h,c);let{data:p,error:g}=await this._getUser(s);if(g)throw g;let v={provider_token:i,provider_refresh_token:r,access_token:s,expires_in:u,expires_at:h,refresh_token:n,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(e){if(ej(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await e3(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;let{data:r,error:s}=t;if(s)return{error:s};let n=null==(i=r.session)?void 0:i.access_token;if(n){let{error:t}=await this.admin.signOut(n,e);if(t&&!(ej(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await e6(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,r;try{let{data:{session:r},error:s}=t;if(s)throw s;await (null==(i=this.stateChangeEmitters.get(e))?void 0:i.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(t){await (null==(r=this.stateChangeEmitters.get(e))?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let i=null,r=null;"pkce"===this.flowType&&([i,r]=await ti(this.storage,this.storageKey,!0));try{return await tc(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(ej(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:i}=await this.getUser();if(i)throw i;return{data:{identities:null!=(e=t.user.identities)?e:[]},error:null}}catch(e){if(ej(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:i,error:r}=await this._useSession(async t=>{var i,r,s,n,o;let{data:a,error:l}=t;if(l)throw l;let c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null==(i=e.options)?void 0:i.redirectTo,scopes:null==(r=e.options)?void 0:r.scopes,queryParams:null==(s=e.options)?void 0:s.queryParams,skipBrowserRedirect:!0});return await tc(this.fetch,"GET",c,{headers:this.headers,jwt:null!=(o=null==(n=a.session)?void 0:n.access_token)?o:void 0})});if(r)throw r;return!eZ()||(null==(t=e.options)?void 0:t.skipBrowserRedirect)||window.location.assign(null==i?void 0:i.url),{data:{provider:e.provider,url:null==i?void 0:i.url},error:null}}catch(t){if(ej(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,r;let{data:s,error:n}=t;if(n)throw n;return await tc(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!=(r=null==(i=s.session)?void 0:i.access_token)?r:void 0})})}catch(e){if(ej(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var i,r;let s=Date.now();return await (i=async i=>(i>0&&await e7(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await tc(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:th})),r=(e,t)=>{let i=200*Math.pow(2,e);return t&&ez(t)&&Date.now()+i-s<3e4},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{let t=await i(s);if(!r(s,null,t))return void e(t)}catch(e){if(!r(s,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),ej(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),eZ()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let i=await e3(this.storage,this.storageKey);if(this._debug(t,"session from storage",i),!this._isValidSession(i)){this._debug(t,"session is not valid"),null!==i&&await this._removeSession();return}let r=(null!=(e=i.expires_at)?e:1/0)*1e3-Date.now()<9e4;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&i.refresh_token){let{error:e}=await this._callRefreshToken(i.refresh_token);e&&(console.error(e),ez(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(e){this._debug(t,"error",e),console.error(e);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new eN;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new e8;let{data:t,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!t.session)throw new eN;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(e){if(this._debug(r,"error",e),ej(e)){let i={session:null,error:e};return ez(e)||await this._removeSession(),null==(t=this.refreshingDeferred)||t.resolve(i),i}throw null==(i=this.refreshingDeferred)||i.reject(e),e}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,i=!0){let r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});let r=[],s=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(e,t)}catch(e){r.push(e)}});if(await Promise.all(s),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await e5(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await e6(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&eZ()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let r=Math.floor((1e3*i.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(i.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tk)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!eZ()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState)return void this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){let r=[`provider=${encodeURIComponent(t)}`];if((null==i?void 0:i.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),(null==i?void 0:i.scopes)&&r.push(`scopes=${encodeURIComponent(i.scopes)}`),"pkce"===this.flowType){let[e,t]=await ti(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(i.toString())}if(null==i?void 0:i.queryParams){let e=new URLSearchParams(i.queryParams);r.push(e.toString())}return(null==i?void 0:i.skipBrowserRedirect)&&r.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;let{data:r,error:s}=t;return s?{data:null,error:s}:await tc(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null==(i=null==r?void 0:r.session)?void 0:i.access_token})})}catch(e){if(ej(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var i,r;let{data:s,error:n}=t;if(n)return{data:null,error:n};let o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:l}=await tc(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null==(i=null==s?void 0:s.session)?void 0:i.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null==(r=null==a?void 0:a.totp)?void 0:r.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(e){if(ej(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;let{data:r,error:s}=t;if(s)return{data:null,error:s};let{data:n,error:o}=await tc(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null==(i=null==r?void 0:r.session)?void 0:i.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:o})})}catch(e){if(ej(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var i;let{data:r,error:s}=t;return s?{data:null,error:s}:await tc(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null==(i=null==r?void 0:r.session)?void 0:i.access_token})})}catch(e){if(ej(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?{data:null,error:i}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let i=(null==e?void 0:e.factors)||[],r=i.filter(e=>"totp"===e.factor_type&&"verified"===e.status),s=i.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:i,totp:r,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,i;let{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:n}=e4(r.access_token),o=null;n.aal&&(o=n.aal);let a=o;return(null!=(i=null==(t=r.user.factors)?void 0:t.filter(e=>"verified"===e.status))?i:[]).length>0&&(a="aal2"),{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:n.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(t=>t.kid===e);if(i||(i=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>Date.now())return i;let{data:r,error:s}=await tc(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!r.keys||0===r.keys.length)throw new eW("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),!(i=r.keys.find(t=>t.kid===e)))throw new eW("No matching signing key found in JWKS");return i}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){let{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}let{header:s,payload:n,signature:o,raw:{header:a,payload:l}}=e4(r);var i=n.exp;if(!i)throw Error("Missing exp claim");if(i<=Math.floor(Date.now()/1e3))throw Error("JWT has expired");if(!s.kid||"HS256"===s.alg||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){let{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:n,header:s,signature:o},error:null}}let c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(s.alg),u=await this.fetchJwk(s.kid,t),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,o,function(e){let t=[];return function(e,t){for(let i=0;i<e.length;i+=1){let r=e.charCodeAt(i);if(r>55295&&r<=56319){let t=(r-55296)*1024&65535;r=(e.charCodeAt(i+1)-56320&65535|t)+65536,i+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(r,t)}}(e,e=>t.push(e)),new Uint8Array(t)}(`${a}.${l}`)))throw new eW("Invalid JWT signature");return{data:{claims:n,header:s,signature:o},error:null}}catch(e){if(ej(e))return{data:null,error:e};throw e}}}tO.nextInstanceID=0;let tP=tO;class tI extends tP{constructor(e){super(e)}}class tC{constructor(e,t,i){var r,s,n;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let o=new URL(function(e){return e.endsWith("/")?e:e+"/"}(e));this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);let a=`sb-${o.hostname.split(".")[0]}-auth-token`,l=function(e,t){var i,r;let{db:s,auth:n,realtime:o,global:a}=e,{db:l,auth:c,realtime:u,global:h}=t,d={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},null!=(i=null==h?void 0:h.headers)?i:{}),null!=(r=null==a?void 0:a.headers)?r:{})}),accessToken:()=>{var e,t,i,r;return e=this,t=void 0,r=function*(){return""},new(i=void 0,i=Promise)(function(s,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})}};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=i?i:{},{db:ew,realtime:eS,auth:Object.assign(Object.assign({},ek),{storageKey:a}),global:eb});this.storageKey=null!=(r=l.auth.storageKey)?r:"",this.headers=null!=(s=l.global.headers)?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(n=l.auth)?n:{},this.headers,l.global.fetch),this.fetch=eO(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new h(new URL("rest/v1",o).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new u(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new em(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},i={}){return this.rest.rpc(e,t,i)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,i,r,s,n;return i=this,r=void 0,s=void 0,n=function*(){if(this.accessToken)return yield this.accessToken();let{data:i}=yield this.auth.getSession();return null!=(t=null==(e=i.session)?void 0:e.access_token)?t:null},new(s||(s=Promise))(function(e,t){function o(e){try{l(n.next(e))}catch(e){t(e)}}function a(e){try{l(n.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):((i=t.value)instanceof s?i:new s(function(e){e(i)})).then(o,a)}l((n=n.apply(i,r||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,storageKey:s,flowType:n,lock:o,debug:a},l,c){let u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new tI({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),l),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,storage:r,flowType:n,lock:o,debug:a,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new F(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,i){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==i?this.changedAccessToken=i:"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}var tA=i(57643);let t$=new tC(tA.env.NEXT_PUBLIC_SUPABASE_URL||"https://gxkhxxxeapexynpouyjz.supabase.co",tA.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd4a2h4eHhlYXBleHlucG91eWp6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ0MzAwNTksImV4cCI6MjA1MDAwNjA1OX0.jhinkQsimQoidsg_U59YD5ROw4PmMJQNKuyXbr4TiQA",s)},73589:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(i(7343));class n extends s.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let i=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${i})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:i,type:r}={}){let s="";"plain"===r?s="pl":"phrase"===r?s="ph":"websearch"===r&&(s="w");let n=void 0===i?"":`(${i})`;return this.url.searchParams.append(e,`${s}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,i){return this.url.searchParams.append(e,`not.${t}.${i}`),this}or(e,{foreignTable:t,referencedTable:i=t}={}){let r=i?`${i}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,i){return this.url.searchParams.append(e,`${t}.${i}`),this}}t.default=n},73799:()=>{},73979:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return i}});let i=e=>{}},74615:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>p,Jd:()=>a,L1:()=>c,hx:()=>o,uO:()=>n,xx:()=>l});var r=i(64371),s=i(57643);let n=()=>!1,o=()=>!1,a=()=>!0===window.__READEST_CLI_ACCESS,l=()=>window.matchMedia("(display-mode: standalone)").matches,c=()=>{var e;return"".concat(null!=(e=s.env.NEXT_PUBLIC_API_BASE_URL)?e:r._u,"/api")},u=null,h=async()=>{if(!u){let{NativeAppService:e}=await Promise.all([i.e(2115),i.e(9359),i.e(6090),i.e(8815),i.e(4504),i.e(4105)]).then(i.bind(i,34105));u=new e,await u.loadSettings()}return u},d=null,f=async()=>{if(!d){let{WebAppService:e}=await Promise.all([i.e(2115),i.e(9359),i.e(6090),i.e(8815),i.e(4504),i.e(7190)]).then(i.bind(i,27190));d=new e,await d.loadSettings()}return d},p={getAppService:async()=>n()?h():f()}},75975:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),i=t[0],r=t[1];return(i+r)*3/4-r},t.toByteArray=function(e){var t,i,n=l(e),o=n[0],a=n[1],c=new s((o+a)*3/4-a),u=0,h=a>0?o-4:o;for(i=0;i<h;i+=4)t=r[e.charCodeAt(i)]<<18|r[e.charCodeAt(i+1)]<<12|r[e.charCodeAt(i+2)]<<6|r[e.charCodeAt(i+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===a&&(t=r[e.charCodeAt(i)]<<2|r[e.charCodeAt(i+1)]>>4,c[u++]=255&t),1===a&&(t=r[e.charCodeAt(i)]<<10|r[e.charCodeAt(i+1)]<<4|r[e.charCodeAt(i+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,s=r%3,n=[],o=0,a=r-s;o<a;o+=16383)n.push(function(e,t,r){for(var s,n=[],o=t;o<r;o+=3)s=(e[o]<<16&0xff0000)+(e[o+1]<<8&65280)+(255&e[o+2]),n.push(i[s>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return n.join("")}(e,o,o+16383>a?a:o+16383));return 1===s?n.push(i[(t=e[r-1])>>2]+i[t<<4&63]+"=="):2===s&&n.push(i[(t=(e[r-2]<<8)+e[r-1])>>10]+i[t>>4&63]+i[t<<2&63]+"="),n.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)i[o]=n[o],r[n.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");-1===i&&(i=t);var r=i===t?0:4-i%4;return[i,r]}r[45]=62,r[95]=63},76171:(e,t,i)=>{"use strict";i.d(t,{D:()=>l,L:()=>a});var r=i(33736),s=i(91844),n=i(74615);let o=(0,s.createContext)(void 0),a=e=>{let{children:t}=e,[i]=(0,s.useState)(n.Ay),[a,l]=(0,s.useState)(null);return s.useEffect(()=>{i.getAppService().then(e=>l(e)),window.addEventListener("error",e=>"ResizeObserver loop limit exceeded"===e.message&&(e.stopImmediatePropagation(),e.preventDefault(),!0))},[i]),(0,r.jsx)(o.Provider,{value:{envConfig:i,appService:a},children:t})},l=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useEnv must be used within EnvProvider");return e}},77117:(e,t,i)=>{e.exports=i(29027)()},79299:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AmpStateContext",{enumerable:!0,get:function(){return r}});let r=i(34007)._(i(91844)).default.createContext({})},80070:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>g});var r=i(33736),s=i(73475),n=i.n(s),o=i(91844),a=i(34634),l=i(27876),c=i(76171),u=i(21816),h=i(11733),d=i(96672),f=i(74615);let p=e=>{let{children:t}=e,i=(0,d.n)(),[s,n]=(0,o.useState)(!1);return(0,o.useEffect)(()=>n(!0),[]),s||(0,f.hx)()?(0,r.jsx)(u.y,{children:(0,r.jsx)(c.L,{children:(0,r.jsx)(l.O,{children:(0,r.jsx)(a.Vx.Provider,{value:{size:"".concat(i,"px")},children:(0,r.jsx)(h.n,{children:t})})})})}):null};i(35492);let g=function(e){let{Component:t,pageProps:i}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n(),{children:[(0,r.jsx)("meta",{name:"viewport",content:"minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no, user-scalable=no, viewport-fit=cover"}),(0,r.jsx)("meta",{name:"application-name",content:"Readest"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-title",content:"Readest"}),(0,r.jsx)("meta",{name:"description",content:"Readest is an open-source eBook reader supporting EPUB, PDF, and sync across devices."}),(0,r.jsx)("meta",{name:"format-detection",content:"telephone=no"}),(0,r.jsx)("meta",{name:"mobile-web-app-capable",content:"yes"}),(0,r.jsx)("meta",{name:"theme-color",content:"white"}),(0,r.jsx)("link",{rel:"manifest",href:"/manifest.json"})]}),(0,r.jsx)(p,{children:(0,r.jsx)(t,{...i})})]})}},84109:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},89081:(e,t,i)=>{"use strict";i.d(t,{Jt:()=>r,aL:()=>s,ij:()=>n});let r=e=>{let t=e.scrolled,i=e.vertical,r=e.maxColumnCount,s=window.innerWidth,n=window.innerHeight;return 1===r||t||i?Math.max(s,n,720):e.maxInlineSize},s=()=>{let e=window.innerWidth;return e<window.innerHeight?Math.max(e,720):720},n=()=>Math.max(window.innerWidth,window.innerHeight,1440)},91404:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let r=i(91844),s=r.useLayoutEffect,n=r.useEffect;function o(e){let{headManager:t,reduceComponentsToState:i}=e;function o(){if(t&&t.mountedInstances){let s=r.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(i(s,e))}}return s(()=>{var i;return null==t||null==(i=t.mountedInstances)||i.add(e.children),()=>{var i;null==t||null==(i=t.mountedInstances)||i.delete(e.children)}}),s(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),n(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},93438:(e,t)=>{t.read=function(e,t,i,r,s){var n,o,a=8*s-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=i?s-1:0,d=i?-1:1,f=e[t+h];for(h+=d,n=f&(1<<-u)-1,f>>=-u,u+=a;u>0;n=256*n+e[t+h],h+=d,u-=8);for(o=n&(1<<-u)-1,n>>=-u,u+=r;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===n)n=1-c;else{if(n===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),n-=c}return(f?-1:1)*o*Math.pow(2,n-r)},t.write=function(e,t,i,r,s,n){var o,a,l,c=8*n-s-1,u=(1<<c)-1,h=u>>1,d=5960464477539062e-23*(23===s),f=r?0:n-1,p=r?1:-1,g=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?t+=d/l:t+=d*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*l-1)*Math.pow(2,s),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;e[i+f]=255&a,f+=p,a/=256,s-=8);for(o=o<<s|a,c+=s;c>0;e[i+f]=255&o,f+=p,o/=256,c-=8);e[i+f-p]|=128*g}},94369:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;let s=r(i(67523));t.PostgrestClient=s.default;let n=r(i(22515));t.PostgrestQueryBuilder=n.default;let o=r(i(73589));t.PostgrestFilterBuilder=o.default;let a=r(i(7343));t.PostgrestTransformBuilder=a.default;let l=r(i(62807));t.PostgrestBuilder=l.default;let c=r(i(51782));t.PostgrestError=c.default,t.default={PostgrestClient:s.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:o.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default}},94589:e=>{"use strict";e.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},96672:(e,t,i)=>{"use strict";i.d(t,{n:()=>R,D:()=>$});var r=i(91844),s=i(28712),n=i.n(s),o=/[A-Z]/g,a=/^ms-/,l={};function c(e){return"-"+e.toLowerCase()}let u=function(e){if(l.hasOwnProperty(e))return l[e];var t=e.replace(o,c);return l[e]=a.test(t)?"-"+t:t};var h=i(77117),d=i.n(h);let f=d().oneOfType([d().string,d().number]),p={all:d().bool,grid:d().bool,aural:d().bool,braille:d().bool,handheld:d().bool,print:d().bool,projection:d().bool,screen:d().bool,tty:d().bool,tv:d().bool,embossed:d().bool},{type:g,...v}={orientation:d().oneOf(["portrait","landscape"]),scan:d().oneOf(["progressive","interlace"]),aspectRatio:d().string,deviceAspectRatio:d().string,height:f,deviceHeight:f,width:f,deviceWidth:f,color:d().bool,colorIndex:d().bool,monochrome:d().bool,resolution:f,type:Object.keys(p)},_={minAspectRatio:d().string,maxAspectRatio:d().string,minDeviceAspectRatio:d().string,maxDeviceAspectRatio:d().string,minHeight:f,maxHeight:f,minDeviceHeight:f,maxDeviceHeight:f,minWidth:f,maxWidth:f,minDeviceWidth:f,maxDeviceWidth:f,minColor:d().number,maxColor:d().number,minColorIndex:d().number,maxColorIndex:d().number,minMonochrome:d().number,maxMonochrome:d().number,minResolution:f,maxResolution:f,...v};var m={all:{...p,..._}};let y=e=>`not ${e}`,b=(e,t)=>{let i=u(e);return("number"==typeof t&&(t=`${t}px`),!0===t)?i:!1===t?y(i):`(${i}: ${t})`},w=e=>e.join(" and "),k=e=>{let t=[];return Object.keys(m.all).forEach(i=>{let r=e[i];null!=r&&t.push(b(i,r))}),w(t)},S=(0,r.createContext)(void 0),E=e=>e.query||k(e),x=e=>{if(e)return Object.keys(e).reduce((t,i)=>(t[u(i)]=e[i],t),{})},T=()=>{let e=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{e.current=!0},[]),e.current},O=e=>{let t=(0,r.useContext)(S),i=()=>x(e)||x(t),[s,n]=(0,r.useState)(i);return(0,r.useEffect)(()=>{let e=i();(function(e,t){if(e===t)return!0;if(!e||!t)return!1;let i=Object.keys(e),r=Object.keys(t),s=i.length;if(r.length!==s)return!1;for(let r=0;r<s;r++){let s=i[r];if(e[s]!==t[s]||!Object.prototype.hasOwnProperty.call(t,s))return!1}return!0})(s,e)||n(e)},[e,t]),s},P=e=>{let t=()=>E(e),[i,s]=(0,r.useState)(t);return(0,r.useEffect)(()=>{let e=t();i!==e&&s(e)},[e]),i},I=(e,t)=>{let i=()=>n()(e,t||{},!!t),[s,o]=(0,r.useState)(i),a=T();return(0,r.useEffect)(()=>{if(a){let e=i();return o(e),()=>{e&&e.dispose()}}},[e,t]),s},C=e=>{let[t,i]=(0,r.useState)(e.matches);return(0,r.useEffect)(()=>{let t=e=>{i(e.matches)};return e.addListener(t),i(e.matches),()=>{e.removeListener(t)}},[e]),t},A=(e,t,i)=>{let s=O(t),n=P(e);if(!n)throw Error("Invalid or missing MediaQuery!");let o=I(n,s),a=C(o),l=T();return(0,r.useEffect)(()=>{l&&i&&i(a)},[a]),(0,r.useEffect)(()=>()=>{o&&o.dispose()},[]),a},$=e=>{let t=A({maxWidth:480}),i=A({minWidth:481,maxWidth:1024});return t||i?1.25*e:e},R=()=>$(20)},97384:(e,t,i)=>{var r,s=i(57643);!function(){"use strict";var t="input is invalid type",n="object"==typeof window,o=n?window:{};o.JS_MD5_NO_WINDOW&&(n=!1);var a=!n&&"object"==typeof self,l=!o.JS_MD5_NO_NODE_JS&&"object"==typeof s&&s.versions&&s.versions.node;l?o=i.g:a&&(o=self);var c,u=!o.JS_MD5_NO_COMMON_JS&&e.exports,h=i.amdO,d=!o.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,f="0123456789abcdef".split(""),p=[128,32768,8388608,-0x80000000],g=[0,8,16,24],v=["hex","array","digest","buffer","arrayBuffer","base64"],_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),m=[];if(d){var y=new ArrayBuffer(68);c=new Uint8Array(y),m=new Uint32Array(y)}var b=Array.isArray;(o.JS_MD5_NO_NODE_JS||!b)&&(b=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var w=ArrayBuffer.isView;d&&(o.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!w)&&(w=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var k=function(e){var i=typeof e;if("string"===i)return[e,!0];if("object"!==i||null===e)throw Error(t);if(d&&e.constructor===ArrayBuffer)return[new Uint8Array(e),!1];if(!b(e)&&!w(e))throw Error(t);return[e,!1]},S=function(e){return function(t){return new T(!0).update(t)[e]()}},E=function(e){var r,s=i(73799),n=i(1714).Buffer;return r=n.from&&!o.JS_MD5_NO_BUFFER_FROM?n.from:function(e){return new n(e)},function(i){if("string"==typeof i)return s.createHash("md5").update(i,"utf8").digest("hex");if(null==i)throw Error(t);return i.constructor===ArrayBuffer&&(i=new Uint8Array(i)),b(i)||w(i)||i.constructor===n?s.createHash("md5").update(r(i)).digest("hex"):e(i)}},x=function(e){return function(t,i){return new O(t,!0).update(i)[e]()}};function T(e){if(e)m[0]=m[16]=m[1]=m[2]=m[3]=m[4]=m[5]=m[6]=m[7]=m[8]=m[9]=m[10]=m[11]=m[12]=m[13]=m[14]=m[15]=0,this.blocks=m,this.buffer8=c;else if(d){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}function O(e,t){var i,r=k(e);if(e=r[0],r[1]){var s,n=[],o=e.length,a=0;for(i=0;i<o;++i)(s=e.charCodeAt(i))<128?n[a++]=s:(s<2048?n[a++]=192|s>>>6:(s<55296||s>=57344?n[a++]=224|s>>>12:(s=65536+((1023&s)<<10|1023&e.charCodeAt(++i)),n[a++]=240|s>>>18,n[a++]=128|s>>>12&63),n[a++]=128|s>>>6&63),n[a++]=128|63&s);e=n}e.length>64&&(e=new T(!0).update(e).array());var l=[],c=[];for(i=0;i<64;++i){var u=e[i]||0;l[i]=92^u,c[i]=54^u}T.call(this,t),this.update(c),this.oKeyPad=l,this.inner=!0,this.sharedMemory=t}T.prototype.update=function(e){if(this.finalized)throw Error("finalize already called");var t=k(e);e=t[0];for(var i,r,s=t[1],n=0,o=e.length,a=this.blocks,l=this.buffer8;n<o;){if(this.hashed&&(this.hashed=!1,a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),s)if(d)for(r=this.start;n<o&&r<64;++n)(i=e.charCodeAt(n))<128?l[r++]=i:(i<2048?l[r++]=192|i>>>6:(i<55296||i>=57344?l[r++]=224|i>>>12:(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),l[r++]=240|i>>>18,l[r++]=128|i>>>12&63),l[r++]=128|i>>>6&63),l[r++]=128|63&i);else for(r=this.start;n<o&&r<64;++n)(i=e.charCodeAt(n))<128?a[r>>>2]|=i<<g[3&r++]:(i<2048?a[r>>>2]|=(192|i>>>6)<<g[3&r++]:(i<55296||i>=57344?a[r>>>2]|=(224|i>>>12)<<g[3&r++]:(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),a[r>>>2]|=(240|i>>>18)<<g[3&r++],a[r>>>2]|=(128|i>>>12&63)<<g[3&r++]),a[r>>>2]|=(128|i>>>6&63)<<g[3&r++]),a[r>>>2]|=(128|63&i)<<g[3&r++]);else if(d)for(r=this.start;n<o&&r<64;++n)l[r++]=e[n];else for(r=this.start;n<o&&r<64;++n)a[r>>>2]|=e[n]<<g[3&r++];this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>0xffffffff&&(this.hBytes+=this.bytes/0x100000000|0,this.bytes=this.bytes%0x100000000),this},T.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[t>>>2]|=p[3&t],t>=56&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},T.prototype.hash=function(){var e,t,i,r,s,n,o=this.blocks;this.first?(i=((i=(-0x10325477^(r=((r=(-0x67452302^0x77777777&(e=((e=o[0]-0x28955b89)<<7|e>>>25)-0x10325477|0))+o[1]-0x705f434)<<12|r>>>20)+e|0)&(-0x10325477^e))+o[2]-0x4324b227)<<17|i>>>15)+r|0,t=((t=(e^i&(r^e))+o[3]-0x4e748589)<<22|t>>>10)+i|0):(e=this.h0,t=this.h1,i=this.h2,e+=((r=this.h3)^t&(i^r))+o[0]-0x28955b88,r+=(i^(e=(e<<7|e>>>25)+t|0)&(t^i))+o[1]-0x173848aa,i+=(t^(r=(r<<12|r>>>20)+e|0)&(e^t))+o[2]+0x242070db,t+=(e^(i=(i<<17|i>>>15)+r|0)&(r^e))+o[3]-0x3e423112,t=(t<<22|t>>>10)+i|0),e+=(r^t&(i^r))+o[4]-0xa83f051,r+=(i^(e=(e<<7|e>>>25)+t|0)&(t^i))+o[5]+0x4787c62a,i+=(t^(r=(r<<12|r>>>20)+e|0)&(e^t))+o[6]-0x57cfb9ed,t+=(e^(i=(i<<17|i>>>15)+r|0)&(r^e))+o[7]-0x2b96aff,e+=(r^(t=(t<<22|t>>>10)+i|0)&(i^r))+o[8]+0x698098d8,r+=(i^(e=(e<<7|e>>>25)+t|0)&(t^i))+o[9]-0x74bb0851,i+=(t^(r=(r<<12|r>>>20)+e|0)&(e^t))+o[10]-42063,t+=(e^(i=(i<<17|i>>>15)+r|0)&(r^e))+o[11]-0x76a32842,e+=(r^(t=(t<<22|t>>>10)+i|0)&(i^r))+o[12]+0x6b901122,r+=(i^(e=(e<<7|e>>>25)+t|0)&(t^i))+o[13]-0x2678e6d,i+=(t^(r=(r<<12|r>>>20)+e|0)&(e^t))+o[14]-0x5986bc72,t+=(e^(i=(i<<17|i>>>15)+r|0)&(r^e))+o[15]+0x49b40821,t=(t<<22|t>>>10)+i|0,e+=(i^r&(t^i))+o[1]-0x9e1da9e,e=(e<<5|e>>>27)+t|0,r+=(t^i&(e^t))+o[6]-0x3fbf4cc0,r=(r<<9|r>>>23)+e|0,i+=(e^t&(r^e))+o[11]+0x265e5a51,i=(i<<14|i>>>18)+r|0,t+=(r^e&(i^r))+o[0]-0x16493856,t=(t<<20|t>>>12)+i|0,e+=(i^r&(t^i))+o[5]-0x29d0efa3,e=(e<<5|e>>>27)+t|0,r+=(t^i&(e^t))+o[10]+0x2441453,r=(r<<9|r>>>23)+e|0,i+=(e^t&(r^e))+o[15]-0x275e197f,i=(i<<14|i>>>18)+r|0,t+=(r^e&(i^r))+o[4]-0x182c0438,t=(t<<20|t>>>12)+i|0,e+=(i^r&(t^i))+o[9]+0x21e1cde6,e=(e<<5|e>>>27)+t|0,r+=(t^i&(e^t))+o[14]-0x3cc8f82a,r=(r<<9|r>>>23)+e|0,i+=(e^t&(r^e))+o[3]-0xb2af279,i=(i<<14|i>>>18)+r|0,t+=(r^e&(i^r))+o[8]+0x455a14ed,t=(t<<20|t>>>12)+i|0,e+=(i^r&(t^i))+o[13]-0x561c16fb,e=(e<<5|e>>>27)+t|0,r+=(t^i&(e^t))+o[2]-0x3105c08,r=(r<<9|r>>>23)+e|0,i+=(e^t&(r^e))+o[7]+0x676f02d9,i=(i<<14|i>>>18)+r|0,t+=(r^e&(i^r))+o[12]-0x72d5b376,e+=((s=(t=(t<<20|t>>>12)+i|0)^i)^r)+o[5]-378558,r+=(s^(e=(e<<4|e>>>28)+t|0))+o[8]-0x788e097f,i+=((n=(r=(r<<11|r>>>21)+e|0)^e)^t)+o[11]+0x6d9d6122,t+=(n^(i=(i<<16|i>>>16)+r|0))+o[14]-0x21ac7f4,e+=((s=(t=(t<<23|t>>>9)+i|0)^i)^r)+o[1]-0x5b4115bc,r+=(s^(e=(e<<4|e>>>28)+t|0))+o[4]+0x4bdecfa9,i+=((n=(r=(r<<11|r>>>21)+e|0)^e)^t)+o[7]-0x944b4a0,t+=(n^(i=(i<<16|i>>>16)+r|0))+o[10]-0x41404390,e+=((s=(t=(t<<23|t>>>9)+i|0)^i)^r)+o[13]+0x289b7ec6,r+=(s^(e=(e<<4|e>>>28)+t|0))+o[0]-0x155ed806,i+=((n=(r=(r<<11|r>>>21)+e|0)^e)^t)+o[3]-0x2b10cf7b,t+=(n^(i=(i<<16|i>>>16)+r|0))+o[6]+0x4881d05,e+=((s=(t=(t<<23|t>>>9)+i|0)^i)^r)+o[9]-0x262b2fc7,r+=(s^(e=(e<<4|e>>>28)+t|0))+o[12]-0x1924661b,i+=((n=(r=(r<<11|r>>>21)+e|0)^e)^t)+o[15]+0x1fa27cf8,t+=(n^(i=(i<<16|i>>>16)+r|0))+o[2]-0x3b53a99b,t=(t<<23|t>>>9)+i|0,e+=(i^(t|~r))+o[0]-0xbd6ddbc,e=(e<<6|e>>>26)+t|0,r+=(t^(e|~i))+o[7]+0x432aff97,r=(r<<10|r>>>22)+e|0,i+=(e^(r|~t))+o[14]-0x546bdc59,i=(i<<15|i>>>17)+r|0,t+=(r^(i|~e))+o[5]-0x36c5fc7,t=(t<<21|t>>>11)+i|0,e+=(i^(t|~r))+o[12]+0x655b59c3,e=(e<<6|e>>>26)+t|0,r+=(t^(e|~i))+o[3]-0x70f3336e,r=(r<<10|r>>>22)+e|0,i+=(e^(r|~t))+o[10]-1051523,i=(i<<15|i>>>17)+r|0,t+=(r^(i|~e))+o[1]-0x7a7ba22f,t=(t<<21|t>>>11)+i|0,e+=(i^(t|~r))+o[8]+0x6fa87e4f,e=(e<<6|e>>>26)+t|0,r+=(t^(e|~i))+o[15]-0x1d31920,r=(r<<10|r>>>22)+e|0,i+=(e^(r|~t))+o[6]-0x5cfebcec,i=(i<<15|i>>>17)+r|0,t+=(r^(i|~e))+o[13]+0x4e0811a1,t=(t<<21|t>>>11)+i|0,e+=(i^(t|~r))+o[4]-0x8ac817e,e=(e<<6|e>>>26)+t|0,r+=(t^(e|~i))+o[11]-0x42c50dcb,r=(r<<10|r>>>22)+e|0,i+=(e^(r|~t))+o[2]+0x2ad7d2bb,i=(i<<15|i>>>17)+r|0,t+=(r^(i|~e))+o[9]-0x14792c6f,t=(t<<21|t>>>11)+i|0,this.first?(this.h0=e+0x67452301|0,this.h1=t-0x10325477|0,this.h2=i-0x67452302|0,this.h3=r+0x10325476|0,this.first=!1):(this.h0=this.h0+e|0,this.h1=this.h1+t|0,this.h2=this.h2+i|0,this.h3=this.h3+r|0)},T.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,i=this.h2,r=this.h3;return f[e>>>4&15]+f[15&e]+f[e>>>12&15]+f[e>>>8&15]+f[e>>>20&15]+f[e>>>16&15]+f[e>>>28&15]+f[e>>>24&15]+f[t>>>4&15]+f[15&t]+f[t>>>12&15]+f[t>>>8&15]+f[t>>>20&15]+f[t>>>16&15]+f[t>>>28&15]+f[t>>>24&15]+f[i>>>4&15]+f[15&i]+f[i>>>12&15]+f[i>>>8&15]+f[i>>>20&15]+f[i>>>16&15]+f[i>>>28&15]+f[i>>>24&15]+f[r>>>4&15]+f[15&r]+f[r>>>12&15]+f[r>>>8&15]+f[r>>>20&15]+f[r>>>16&15]+f[r>>>28&15]+f[r>>>24&15]},T.prototype.toString=T.prototype.hex,T.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,i=this.h2,r=this.h3;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255,255&i,i>>>8&255,i>>>16&255,i>>>24&255,255&r,r>>>8&255,r>>>16&255,r>>>24&255]},T.prototype.array=T.prototype.digest,T.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},T.prototype.buffer=T.prototype.arrayBuffer,T.prototype.base64=function(){for(var e,t,i,r="",s=this.array(),n=0;n<15;)e=s[n++],t=s[n++],i=s[n++],r+=_[e>>>2]+_[(e<<4|t>>>4)&63]+_[(t<<2|i>>>6)&63]+_[63&i];return r+(_[(e=s[n])>>>2]+_[e<<4&63]+"==")},O.prototype=new T,O.prototype.finalize=function(){if(T.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();T.call(this,this.sharedMemory),this.update(this.oKeyPad),this.update(e),T.prototype.finalize.call(this)}};var P=function(){var e=S("hex");l&&(e=E(e)),e.create=function(){return new T},e.update=function(t){return e.create().update(t)};for(var t=0;t<v.length;++t){var i=v[t];e[i]=S(i)}return e}();P.md5=P,P.md5.hmac=function(){var e=x("hex");e.create=function(e){return new O(e)},e.update=function(t,i){return e.create(t).update(i)};for(var t=0;t<v.length;++t){var i=v[t];e[i]=x(i)}return e}(),u?e.exports=P:(o.md5=P,h&&(void 0===(r=(function(){return P}).call(P,i,P,e))||(e.exports=r)))}()}},e=>{var t=t=>e(e.s=t);e.O(0,[6593,8792],()=>(t(62299),t(19498))),_N_E=e.O()}]);